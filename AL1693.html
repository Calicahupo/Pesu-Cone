<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta name="viewport" content="width=device-width, initial-scale=1.0"
	http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>‚à®‚àÄ‚à®‚ò¢‚äª‚äïœÄ‚üøùîº‚á†calicahupo‚ò∏Ô∏ègmail.PayPal:1693</title>
<style>@font-face { font-family:'profont'; 			src:url('diodi/profontwindows-webfont.woff2')format('woff2'),
		url('diodi/profontwindows-webfont.woff') 	format('woff');	font-weight:normal; font-style:normal; }
	@font-face { font-family: 'de_valenciaregular'; src: url('de_valencia_beta-webfont.woff2') format('woff2'),
        url('de_valencia_beta-webfont.woff') 		format('woff'); font-weight: normal;font-style: normal;}
    @font-face { font-family: 'strike_fighter';    	src:url('diodi/strikefighter-webfont.woff2')format('woff2'),
    	url('diodi/strikefighter-webfont.woff') 	format('woff'); font-weight: normal; font-style: normal;}
    @font-face { font-family: 'VGA'; 				src: url('diodi/PerfectDOSVGA437.woff2') format('woff2'),
        url('diodi/PerfectDOSVGA437.woff') 			format('woff'); font-weight: normal; font-style: normal;}
        /*, url('diodi/PerfectDOSVGA437.svg#PerfectDOSVGA437') format('svg')*/
	html{height:100%;padding:0px;margin:0px;font-family:profont;font-size:13px;background-color:black;color:white;}
	body{height:100%;padding:0px;margin:0px;background-color:transparent;}
	button,select,input{font-family:profont;font-size:13px;}
	#wrapper{ min-height:100%; background-color:black; }
	#sidebar{position:fixed; min-height:100%; right:0px; background-color:#222222; font-size:15px; width:66px; }
		.sidebar-option{border-top:3px outset #444;padding-top:10px;padding-bottom:10px;border-bottom:3px outset #080808;
			padding-left:8px;padding-right:8px;border-left:3px outset #333;border-right:3px outset #111; color:#ccc;}
		.sidebar-option-selected{border-top: 3px inset black;padding-top:10px;padding-bottom:10px;
			border-bottom:3px inset #777; background-color:#111; padding-left:8px; padding-right:8px; color:white;  border-left: 3px inset #080808;  border-right: 3px inset #444;}
	#sidebarFeatures{ position:fixed; right:0px; bottom: 0px; width: 66px; }
	.trinaryFeature{ width: 18px; height:18px; display:inline; text-align:center; background-color: #444;
		font-size: 17px; float:left; margin-bottom:2px; margin-left:2px; margin-right:2px; margin-top:2px;
		-webkit-border-radius: 5px; -moz-border-radius: 5px; border-radius: 5px; padding:0px; }
	.binaryFeature { width: 29px; height:29px; display:inline; text-align:center; background-color: #444; 
		 font-size: 20px; float:left; margin-bottom:2px; margin-left:2px; margin-right:2px; margin-top:2px;
		-webkit-border-radius: 8px; -moz-border-radius: 8px; border-radius: 8px;}
	.unaryFeature  { width: 62px; height:62px; display:inline; text-align:center; background-color:#444; 
	 	 font-size: 42px; float:left; margin-bottom:2px; margin-left:2px; margin-top:2px;
	 	-webkit-border-radius:13px; -moz-border-radius:13px; border-radius:13px;}
	.clearBoth { clear:both; }

	#dharmaHeader { position:fixed; top:0px; right:66px; height: 25px; min-width:100%;border-right:1px solid #555;}
	#dharmaHeaderControls{
		position:fixed;top:0px;left:0px;width:107px;height:25px;background-color:#222;border-right:1px solid #555;}
	#dharmaHeaderBase {
		height:5px;width:100%;background-color:#222;top:19px;position:fixed;left:107px;border-top: 1px solid #555;}
	#dharmaHeaderTabs { height:25px; left:107px; width:100%; position:fixed; }
	.dharmaProfileCurrent { height:11px; margin-top:2px; float:left; position:relative; margin-left: 6px;
		padding-left:6px; padding-right:4px; padding-top: 2px; padding-bottom: 4px;
		background-color: #222; border:1px solid #555555; border-bottom: 0px none;
		-webkit-border-top-left-radius: 6px;-webkit-border-top-right-radius: 6px;-moz-border-radius-topleft: 6px;
		-moz-border-radius-topright: 6px;border-top-left-radius: 6px;border-top-right-radius: 6px; }
	.dharmaProfile { height:11px; margin-top:2px; float:left; position:relative; margin-left: 6px; color:#888;
		padding-left:6px; padding-right:4px; padding-top: 2px; padding-bottom: 3px;
		background-color: #000; border:1px solid #555555; border-bottom: 0px none;
		-webkit-border-top-left-radius: 6px;-webkit-border-top-right-radius: 6px;-moz-border-radius-topleft: 6px;
		-moz-border-radius-topright: 6px;border-top-left-radius: 6px;border-top-right-radius: 6px; }

	#dharmaSidebar  { width:173px; min-height:100%; position:fixed; left:  0px; top:25px;  background-color:#222; }
	select#dharmaTypeSelector { width:173px; }
	select#dharmaSubtypeSelector { width:173px; background-color:#ccc; height:78px; }
	.dharmaSidebarHood { width:173px; padding-top:2px; height:13px; background-color: #555; color:#222; overflow:hidden; }
	#dharmaEngine 				{ width:173px; padding-top:2px; height:13px; background-color:black; }
	#dharmaEngineOntology 		{ background-color:#111; }
	#dharmaEngineEpistemology 	{ background-color:#444; }
	#dharmaEngineMorality 		{ background-color:#111; }
	#dharmaEngineEthics 		{ background-color:#444; }
	#dharmaSidebarHoodPaint{position:absolute;width:186px;color:rgba(0,0,0,0.2);
		font-size:22px;margin-top:-3px;margin-left:-13px;overflow:hidden;}
	.dharmaConstantTooltip { text-shadow: 0 0 2px #FFFFFF; width: 60px; float:left; text-align:center; }
	.dharmaRelationTooltip { text-shadow: 0 0 2px #FFFFFF; float:left; text-align:center;  }
	#dharmaFooterCover{ width:173px; height:100%; position:absolute; left:0px; top:200px; background-color:#ccc; }
	select#dharmaSource { width: 60px; background-color:#ccc;top:112px; position:absolute; left:0px;}
	select#dharmaTarget { width: 60px; background-color:#ccc; top:112px; position:absolute;left:113px;}
	select#dharmaRelation {  background-color:#fff; width:53px; top:112px; position:absolute;left:60px; }
	#dharmaFrom{width: 59px;height:15px;position:fixed;left:0px;bottom:119px;
				text-align:center;border-right:1px solid #999;}
	#dharmaVia{ width: 53px; height:15px;position:fixed; left:60px;bottom:119px;
				text-align:center;}
	#dharmaTo { width: 59px;height:15px;position:fixed;left:113px;bottom:119px;
				text-align:center;border-left:1px solid #999}
	input#dharmaFrom,input#dharmaVia,input#dharmaTo{ display:inline;}
	#dharmaControls {width:173px; height:18px; position:fixed; left:0px; bottom:97px;}
	#allConstsToUp 	{width:28px;height:18px;padding:0px;}
	#selConstsToUp  {width:28px;height:18px;padding:0px;margin-right:2px;}
	#relsToLeft 	{width:28px;height:18px;padding:0px;}
	#relsToRight 	{width:28px;height:18px;padding:0px;}
	#selRelsToDown 	{width:28px;height:18px;padding:0px;margin-left:2px;}
	#allRelsToDown 	{width:28px;height:18px;padding:0px;}
	.dharmaControlButtonLabel { position:relative; top:-3px;}
	select#dharmaRelSelector { width:173px; position:fixed; bottom:0px; background-color:#ccc;}
	select#dharmaSubrelSelector { width:173px; position:fixed; bottom:19px; height:78px; }

	#dharmaParser { height:78px; background-color:#222; position:fixed; left:173px; bottom:19px; min-width:100%; }
	#devBar{ height: 19px; position:fixed; right:66px; bottom:0px; background-color:black; width:100%;
		text-align:right; padding-right: 9px; color:red; font-size:15px; padding-bottom:1px;} /*h+1, pb+1*/

	#systemGrid_dharmaMono { background-color: #888844; }
	.systemGrid_dharmaMono { background-color: #448844; }
	.systemGridPixel { border: 1px solid #ffffff; }


	#dharmaColumnWrapper{width:100%;min-height:100%;background-color:#181818; position:absolute;top:25px;
		margin-left:173px; padding:66px; }
	.dharmaColumn{ margin-right:25px; border:1px solid black; float:left;  width:25%; padding: 66px;}
	#leftDharmaColumn{}
	#rightDharmaColumn{}

	#dharmaColumns { width:100%; left:346px; top:25px; margin-top:25px; position:absolute; }
	.dharmaColumn  { width:25px; background-color:white; border: 1px solid black; padding:66px; float:left; }
	#leftDharmaColumn { min-height: 100%; width:50%; background-color:#111; }
	#rightDharmaColumn{ min-height: 100%; width:50%; background-color:#111; }



	#display3DuR { position:fixed; left: 88px; top:88px; }

	#uL{float:left;}		#uR{float:left;}
	#content { background-color:black; color:white; }
	#monolithicBoilerPlate{
		font-family:VGA; text-align:center; background-color:#0000ff; border-bottom: 1px solid white; padding-bottom:25px;}
	#monolithicBoilerPlate a:link{ background-color:white; }
	#monolithicBoilerPlate a:visited{ background-color:white; }
	h1{ margin: 0px; padding-top: 25px; padding-left:25px; font-size: 16px; }
</style>
<script src="diodi/di0015.js"></script><!--aldiod-->
<script src="diodi/dB0000.js"></script><!--devBar-->
<script src="diodi/jquery-2.js"></script><script> 
// "tis macho to be viil !123 u think tis macho to be evil ?23=3=3=3"
// panda glass hit
// Weak judges, strong. sensors etc AB A B OMEGA common names
var sV =document.createElementNS( "http://www.w3.org/2000/svg","svg"); var nS =sV.namespaceURI;
$(document).ready( function(){ postinit()})
//window.onload = function(){ draw()}
function postinit(){ console.log("postinit")}
function predraw( al){
	function mkL( x,y,w,h,c) 	{ var r=document.createElementNS( nS,'rect'); r.setAttribute( 'x',x); r.setAttribute( 'y',y);r.setAttribute( 'width',w); r.setAttribute( 'height',h); r.setAttribute( 'fill',c);
	if(typeof cl!='undefined'){ r.setAttribute( 'class',cl) }return r}
	sV.setAttribute( 'height',window.innerHeight);
	sV.setAttribute( 'width',window.innerWidth);

    var g =mkL(266,25,25,66,'#00ff00');
    var h =mkK(366,25,25,66,'h','#00ff00');
    //var f =mkS( '#00ff00');
    console.log( al);

    console.log( g);
    console.log( h);
    //console.log( f);

	sV.appendChild( g);
	sV.appendChild( h);

	for(var j=0; j < al.fesLen; j++){
		if( AL.ui.features[j].handle ==al.fe){
			console.log( al.ui.features[j]); console.log("j");
			sV.appendChild( al.ui.features[j].dev.sB.sV);
			if( al.ui.features[j].act.pT){ sV.appendChild( al.ui.features[j].dev.pT.sV)};
			if( al.ui.features[j].act.eX){ sV.appendChild( al.ui.features[j].dev.eX.sV)};
			if( al.ui.features[j].act.sQ){ sV.appendChild( al.ui.features[j].dev.sQ.sV)};
			if( al.ui.features[j].act.gR){ sV.appendChild( al.ui.features[j].dev.gR.sV)};
			if( al.ui.features[j].act.dB){ sV.appendChild( al.ui.features[j].dev.dB.sV)};

			if( al.ui.features[j].act.aM){ sV.appendChild( al.ui.features[j].dev.aM.sV)};
			if( al.ui.features[j].act.sH){ sV.appendChild( al.ui.features[j].dev.sH.sV)};
			if( al.ui.features[j].act.cA){ sV.appendChild( al.ui.features[j].dev.cA.sV)};
			//if( al.ui.features[j].act.mE){ sV.appendChild( al.ui.features[j].dev.mE.sV)};

			if( al.ui.features[j].act.sG){ sV.appendChild( al.ui.features[j].dev.sG.sV)};	
			if( al.ui.features[j].act.pN){ sV.appendChild( al.ui.features[j].dev.pN.sV)};
			//if( al.ui.features[j].act.qU){ sV.appendChild( al.ui.features[j].dev.qU.sV)};
			if( al.ui.features[j].act.mC){ sV.appendChild( al.ui.features[j].dev.mC.sV)};
			if( al.ui.features[j].act.kK){ sV.appendChild( al.ui.features[j].dev.kK.sV)};

			if( al.ui.features[j].act.pM){ sV.appendChild( al.ui.features[j].dev.pM.sV)};
			if( al.ui.features[j].act.yO){ sV.appendChild( al.ui.features[j].dev.yO.sV)};
			if( al.ui.features[j].act.tT){ sV.appendChild( al.ui.features[j].dev.tT.sV)};
			//var pT =AL.ui.features[j].dev.pT.sV;
			//console.log( pT);
				}}
/*r =	{  DOM:false,sV:true, sB:true, tT:true, gL:true,
							sQ:true, aM:false,sH:false,cA:false,mE:true,
							pT:true, eX:true, gR:true, dB:true, dG:false,pM:false,
							sG:false,qU:true, pN:false,mC:false,kK:true, yO:false};return r;*/
	

	document.body.appendChild( sV);
}

// Gram -> Plot?
// divert/convert in logic quadrant to forget/learn? divert/teach?

var AL={
	dev: 	true,
	fe: 	"mosaic",
	fes: 	["dharma","money","mosaic","yozen","sygnal"],
	sG: [{fe:"dharma",pTs:["hello"],
			dis: 	 { mono:"", u:"sGN", d:"sGS", l:"sGW", r:"sGE", uL:"sGNW",	uR:"sGNE", 	dL:"sGSW", 	dR:"sGSE"}}],
	pN: [{fe:"mosaic",pTs:["hello","world"], 
			dis: 	 { mono:"", u:"mCAHo",d:"mCAHe",l:"mCCHo",r:"mCCHe",uL:"qRuLS",uR:"qRuRS",dL:"qRdLS",dR:"qRdRS"},
			override:{ mono:false,u:false,d:false,l:false,r:false}}],
	qU: [{fe:"sygnal",pTs:["hello"],
		 	dis: 	 { mono:"",	u:"", d:"", l:"prompt",r:"",	uL:"", 		uR:"mCSelf",dL:"", 		dR:"mCOther"},
			override:{ mono:false,u:false,d:false,l:true, r:false}}],
	qD: [{hnd:"prompt"  }],
	mC: [{hnd:"mCSelf"  },
		 {hnd:"mCOther" },
		 {hnd:"mCAHo" 	},
		 {hnd:"mCAHe" 	},
		 {hnd:"mCCHo" 	},
		 {hnd:"mCCHe" 	}],
	qR: [{hnd:"qRuLS" 	},
		 {hnd:"qRuRS" 	},
		 {hnd:"qRdLS" 	},
		 {hnd:"qRdRS" 	}],
	kK: [{hnd:"Pelaaja" }],

	reso: 	4,	
/*USER */
			tree: { mas:null, fem:null, ess:null},
			fesLen: 0,
			pTs: [],
/*UI*/		ui:null, 					coGrid: "#222222",
/*YOZEN   */posDim: 256,
/*ENGINE  */initDone: false, 			T:0, 						time:0,				 		defaultTime: 6516,
/*XY      */resolution:	 4,				mosaic:		"XY",			mosaics: 	["XY","XZ","YZ"],
/*TAXONOMY*/ontology: 	null, 				
			epistemology: 	["vertexPlane","circuitScript"], 			
			morality: 		["scalarQuanta","romanticQuanta"], 				
			ethics: 	null,
/*UI      */tab:		"mosaic", 
 			tabs:		["legend","dharma","mosaic","kakara"], 		//yozen //kraana(TA)
			fontSize: 	15, 			headerHeight:50, 			sysGridRungHeight: 25,
			sidebar: 	true,			sidebarSVG:true, 			
			sidebarTabHei: 41,			sidebarTabPadL: 11,			sidebarTabPadT: 6,	
/*CONTROLS*/lArr: false, 				uArr: false, 				rArr: false, 				dArr: false,
/*3D*/ 		unitDistD3d: 10,/*to-be:16*/defaultVelD3d: 10, 			defaultRotD3d: 0.1,
/*DHARMA  */dharmaProfile:null, 		dharmaProfiles: [], 		dharmaProfileIndex: 1, 		dharmaLogy: null,
/*MISC    */uri:		location,		trackingMosaic: false, 		help:true }

function initCulture(dharma) { var rt = null; var rt = initTheism(initSpirituality(dharma)) }
//function initSpirituality(dharma) {}
function initTruth(dharma) { var e={
	angels:null,
	giants:null,
	ghosts:null,
	living:null};
 	e.angels = initAngels(dharma); return e }
function initAngels(dharma) { var a; var b=[];
	a = new Angel("Adam", 			dharma.mas.others.adult); b.push(a);
	a = new Angel("Eve",  			dharma.fem.others.adult); b.push(a);
	a = new Angel("Cain",  			dharma.mas.others.child); b.push(a);
	a = new Angel("Fatima",  		dharma.fem.others.child); b.push(a); return dharma }
function Angel(name,essence) { this.name=name; this.essence=essence; var loc={X:0,Y:0,Z:0}; this.loc=loc }
/*
                                                                                                               T√øE
                                                                                                              O√ø√ø√øNOB     >
                                                                                                               √ø√ø√ø
                                                                                                                T√ø√ø
                                                                                                                 H√ø√ø
                                                                                                                  E√ø√ø
                                                                                                                   √ø√ø√ø
                                                                                              √ø      √ø√ø√ø√ø√ø¬¢        W√ø√ø
                                                                                               √ø√ø√ø √ø√ø√ø√ø√ø√ø√ø√ø√ø√ø$     H√ø√ø
                                                                                                √ø√ø√ø√ø√ø√ø√ø√ø√ø√ø√ø√ø√ø√ø√ø‚Ç¨ TI√ø√ø√ø
                                                                                             √ø√ø√ø√ø√ø√ø√øcamel√øcase√øsE√ø√ø√ø√ø
                                                                                              √ø√ø√ø√ø√ø√ølast√øseason√ø√ø√ø√ø
                                                                                                 √ø√ø√ø√ø√ø√ø√ø√ø√ø√ø√ø√ø√ø√ø√ø√ø
                                                                                                   √ø√ø¬•√ø√ø√ø√ø√ø√ø
                                                                                                    √ø   √ø√ø 
                                                                                                    √ø√ø_   √ø√ø√ø_  
                                                                               ..:::::''"""""""""""""''"''""¬®¬®¬®¬®¬®¬®¬®*/
function precalc() {
	precalcInterface(AL);
}
function precalcInterface(al){  

								var ui 					= precalcUserInterfaceTemplates( false,		al.reso,
																						 0, 		0,
																						 al.sG,
																						 al.qU,	 	al.qD,
																						 al.pN, 	al.mC,
																						 al.qR,	 	al.kK);
								ui 						= precalcWindowDimensions( ui);
								ui.templates 			= precalcUserInterfaceTemplates( ui,		al.reso,
																						 ui.winWid, ui.winHei);
								ui.templates.features 	= precalcFeatureTemplates( ui.templates, al.fes);
								ui						= precalcFeatures( ui, ui.templates.features, al.fesLen);
								al.ui =ui;
								
					//if(al.dev){ predraw( ui)}
								//ui.templates.features 	= precalcToolsForFeatures( ui.templates.features,al.fes,al.fesLen);
								//ui.designs 				= precalcUserInterfaceTemplates( al.reso, ui.winWid, ui.winHei);
								//ui.designs.features 	= precalcFeatures( ui.designs, al.fes);
								//ui.templates.devices 	= precalcDevices( ui);
								//confUI( ui, pT);
								//calcUI( ui, pT);
								/*makeUI( ui, pT);*/ }


/*function initStateForDevice(){ var devices={ sB:null, gL:null,sQ:null,pT:null,eX:null,gR:null,dB:null,dG:null,gR:null,
	sG:null,mO:null,pN:null,kK:null,yO:null, DOM:null, SVG:null }; return devices }*/
//function drawDev( fe){ cC(fe)}
//function predraw2(al){ for(var i=0; i<al.ui.)}
/*function predraw( ui){ cC(236,ui);
	cC(237,ui.features[0].dev.SVG);
	//document.body =document.createElementNS( nS,"body");
	var rt = mkK( 10,10,10,10,"jou_maan","#ffff00","jou-taivaan" );
	sV.appendChild( ui.features[0].dev.SVG);
	document.body.appendChild( sV);*/
	/*function pre( fe){cC( 234,fe);

		cC( 236,"moro");
		
		document.body.appendChild( ui.dev.sB.SVG);}
	for(var i=0; i<al.fesLen; i++){ if( ui.features[i].handle ==al.fe){ pre( ui.features[i])}}*/ //}
function mkFeature( ui,t){ 
	if(t.act.sV){ t.dev.sV =mkFeatureSVG( ui,t)}
	if(t.act.DOM){ t.dev.DOM =mkFeatureDOM( ui,t); if(t.act.sV){ t.dev.DOM.appendChild( t.dev.sV)}} return t}
function mkFeatureDOM( ui,t){ var f =mkD( 0,0,ui.winWid,ui.winHei,t.handle,'transparent',t.handle ); return f}
function mkFeatureSVG( ui,t){ var f =mkK( 0,0,ui.winWid,ui.winHei,t.handle,ui.sty.b,t.handle ); return f}

function precalcFeature( ui,template){ var fe =mkFeature( ui,template); ui.features.push( fe); }
function precalcFeatures( ui,templates,fesLen) {
	for(var i=0; i < fesLen; i++) { precalcFeature( ui,templates[i])} return ui}
function precalcUserInterfaceTemplates( src, reso, winWid, winHei, sG,qU,qD,pN,mC,qR,kK) {
	if(src){var sGs =src.sGs; 	var qUs =src.qUs; 	var qDs =src.qDs;
			var pNs =src.pNs; 	var mCs =src.mCs; 	var qRs =src.qRs; 	var kKs =src.kKs}
	else{ 	var sGs =sG.length; var qUs =qU.length; var qDs =qD.length;
			var pNs =pN.length; var mCs =src.mCs; 	var qRs =qR.length; var kKs =kK.length}
	var ui = { 	sty : { b:"#000000",d:"#222222",ledSVG:"#dddd00",ledDOM:"ff0000",ledGlo:"#00ff00",ledGloRad:6 },
				 sV:null,DOM:null,state:null, 	winWid:0, 	winHei:0, features:[], overflow:false,
		devices:{DOM:null,
/*SIDEBAR */sB:{ sV:null,DOM:null,state:null,	disWid:66, 	disHei:0, 	disHrz:0, 	disVrt:0,rowHei:39 },
/*SEQUENCr*/sQ:{ sV:null,DOM:null,state:null, 	disWid:0, 	disHei:0, 	disHrz:0, 	disVrt:0,rowHei:0,rowNum:5,rowOff:0 },
/*PROTABS */pT:{ sV:null,DOM:null,state:null, 	disWid:0, 	disHei:0, 	disHrz:0, 	disVrt:0,tabHei:0,tabWid:0},
/*SHOTGUN*/ sH:{ sV:null,DOM:null,state:null, 	disWid:0, 	disHei:0, 	disHrz:0, 	disVrt:0},
/*CANNON*/ 	cA:{ sV:null,DOM:null,state:null, 	disWid:0, 	disHei:0, 	disHrz:0, 	disVrt:0,disCal:0},
/*AMMO*/ 	aM:{ sV:null,DOM:null,state:null, 	disWid:0, 	disHei:0, 	disHrz:0, 	disVrt:0},
/*EXPLORER*/eX:{ sV:null,DOM:null,state:null, 	disWid:0, 	disHei:0, 	disHrz:0, 	disVrt:0},
/*GRAM    */gR:{ sV:null,DOM:null,state:null, 	disWid:0, 	disHei:0, 	disHrz:0, 	disVrt:0},
/*DEVBAR  */dB:{ sV:null,DOM:null,state:null, 	disWid:0, 	disHei:0,	disHrz:0, 	disVrt:0},
/*DIALOG  */dG:{ sV:null,DOM:null,state:null, 	disWid:0, 	disHei:0,	disHrz:0, 	disVrt:0},
/*SYSGRID */sGs:sGs,
			sG:{ sV:null,DOM:null,state:null, 	disWid:0, 	disHei:0,  	disHrz:0, 	disVrt:0,
												fldWid:0,	fldHei:0,	furHei:0,
												qdrWid:0,	qdrHei:0,	fraThi:15,
				dis:{  		mono:null, uL:null, uR:null, dL:null, dR:null, 	u:null,  d:null,  l:null,  r:null}},
/*QUAD    */qUs:qUs, qDs:qDs,
			qU:{ sV:null,DOM:null,state:null,	disWid:0, 	disHei:0, 	disHrz:0, 	disVrt:0,
												cntHrz:0, 	cntVrt:0,	halWid:0, 	halHei:0,
dis:{
	mono:{scr:null, scrWid:0, scrHei:0, scrHrz:0, scrVrt:0},
	uR: { scr:null, scrWid:0, scrHei:0, scrHrz:0, scrVrt:0},	uL:{ scr:null, scrWid:0, scrHei:0, scrHrz:0, scrVrt:0},
	dL: { scr:null, scrWid:0, scrHei:0, scrHrz:0, scrVrt:0},	dR:{ scr:null, scrWid:0, scrHei:0, scrHrz:0, scrVrt:0},
	u : { scr:null, scrWid:0, scrHei:0, scrHrz:0, scrVrt:0},	l :{ scr:null, scrWid:0, scrHei:0, scrHrz:0, scrVrt:0},
	d : { scr:null, scrWid:0, scrHei:0, scrHrz:0, scrVrt:0},	r :{ scr:null, scrWid:0, scrHei:0, scrHrz:0, scrVrt:0}},
override:{mono:false, u:false, d:false, l:false, r:false}},
/*PANDA   */pNs:pNs,
			pN:{ sV:null,DOM:null,state:null, 	disWid:0, 	disHei:0, 	disHrz:0, 	disVrt:0, cntHrz:0, cntVrt:0,
												prjSca:5, 	prjLen:3, 	prjHAp:2, 			  edgHrz:0, edgVrt:0,
												laReso:reso,loReso:reso,elReso:reso,
dis: { fro:null, rea:null, sta:null, por:null, asc:null, des:null, uL:null, uR:null, dL:null, dR:null}},
/*MOSAIC  */mCs:mCs,
			mC:{ sV:null, 		   state:null, 	disWid:0, 	disHei:0, 	disHrz:0, 	disVrt:0, cntHrz:0, cntVrt:0,
												froWid:0, 	froHei:0, 	froTiW:0, 	froTiH:0, froHrz:0, froVrt:0,
												latWid:0, 	latHei:0, 	latTiW:0, 	latTiH:0, porHrz:0, porVrt:0,
																							  staHrz:0, staVrt:0,
												eleWid:0, 	eleHei:0, 	eleTiW:0, 	eleTiH:0, ascHrz:0, ascVrt:0,
																							  desHrz:0, desVrt:0,
												reaWid:0, 	reaHei:0, 	reaTiW:0, 	reaTiH:0, reaHrz:0, reaVrt:0,
												xReso:reso, yReso:reso, zReso:reso,
												prjSca:5, prjLen:2, prjApe:3,
												modHrz:0, 	modVrt:0},
/*TOWER   */qRs:qRs,
			qR:{ sV:null, 		   state:null, 	disWid:0, 	disHei:0, 	disHrz:0, 	disVrt:0, tilWid:0, tilHei:0},
/*KAKARA  */kKs:kKs,
			kK:{ sV:null, 		   state:null, 	disWid:0, 	disHei:0, 	disHrz:0, 	disVrt:0 },
/*GRIDLOCK*/gL:{ 								disWid:0, 	disHei:0, 	disHrz:0, 	disVrt:0,
												scrWid:0, 	scrHei:0, 	scrHrz:0, 	scrVrt:0,
												lVX:40,	mVX:173, tHY:40, THY:25, mHY:106, bHY:75, dBH:19 },
/*YOZEN   */yO:{ sV:null, 		   state:null, disWid:0, disHei:0, disHrz:0, disVrt:0, lVX:0, mVX:0, tHY:0, mHY:0 }}};
	if( winWid > 0){ ui.winWid =winWid; ui.winHei =winHei} return ui}
function precalcDevicesForFeature( ui,feHnd,act,qU){
	var dev={ 	DOM:null,sB:null, tT:null, gL:null,
				sQ:null, aM:null, sH:null, cA:null, mE:null,
				pT:null, eX:null, gR:null, dB:null, dG:null, pM:null,
				sG:null, qU:null, pN:null, mC:null, kK:null, yO:null };
	if(act.sB){ dev.sB = mkSidebar( 	ui, feHnd,				act.sV);
				dev.tT = mkToolTips( 	ui, feHnd, 				act.sV)}
	if(act.gL){ dev.gL = mkGridlock( 	ui, feHnd)}
	if(act.sQ){ dev.sQ = mkSequencer( 	ui, feHnd,	act.DOM,	act.sV)}
	if(act.pT){ dev.pT = mkProTabs( 	ui, feHnd,	act.DOM,	act.sV)}

	if(act.aM){ dev.aM = mkAmmo( 		ui, feHnd, 	act.DOM, 	act.sV, 	dev.gL)}
	if(act.sH){ dev.sH = mkShotgun( 	ui, feHnd, 	act.DOM, 	act.sV, 	dev.aM)}
	if(act.cA){ dev.cA = mkCannon( 		ui, feHnd, 	act.DOM, 	act.sV, 	dev.aM)}
	if(act.eX){ dev.eX = mkExplorer( 	ui, feHnd,	act.DOM,	act.sV)}
	if(act.gR){ dev.gR = mkGram( 		ui, feHnd,	act.DOM,	act.sV)}
	if(act.dB){ dev.dB = mkDevBar( 		ui, feHnd,	act.DOM,	act.sV)}
	if(act.dG){ dev.dG = mkDialog( 		ui, feHnd,	act.DOM,	act.sV, 	dev.gL)}

	if(act.sG){ dev.sG = mkSystemGrid( 	ui, feHnd, 	act.DOM)}
	if(act.qU){ dev.qU = mkQuad( 		ui, feHnd, 				act.sV, 				qU); 
				dev = mkQuad2( 			ui,	feHnd, 							dev, 		qU)}
	if(act.pN){ dev.pN = mkPanda( 		ui, feHnd, 				act.sV, 	dev.gL)}
	if(act.mC){ dev.mC = mkMosaic( 		ui, feHnd, 				act.sV, 	dev.gL)}
	if(act.kK){ dev.kK = mkKakara( 		ui, feHnd, 				act.sV, 	dev.gL)}
	if(act.yO){ dev.yO = mkYozen( 		ui, feHnd, 				act.sV, 	dev.gL)}
	return dev; }
function qDFind( qU,id){ /*cC( "*** qDFind ***");cC(qU);cC(id);*/ if( qU.mono==id){ return "mono"}
		 if( qU.uR==id){ return "uR"}else if( qU.uL==id){ return "uL"}
	else if( qU.dL==id){ return "dL"}else if( qU.dR==id){ return "dR"}
	else if( qU.d ==id){ return "d" }else if( qU.r ==id){ return "r" }
	else if( qU.u ==id){ return "u" }else if( qU.l ==id){ return "l" }else{ return ""}}
function qdFind2( qD,qU){ switch( qD){ case "mono": return qU.disDim.mono;
	case "uR": return qU.disDim.uR; 	case "uL": return qU.disDim.uL;
	case "dR": return qU.disDim.dR; 	case "dL": return qU.disDim.dL;
	case "u" : return qU.disDim.u; 		case "d" : return qU.disDim.d;
	case "r" : return qU.disDim.r; 		case "l" : return qU.disDim.l;}}
function mkQuad5( ui,dev,feHnd,parent,dim){ switch( hnd){ 					 case 'mCSelf':
	ui.act.mC =true; parent = mkMosaic( ui, id, true, 	parent); return dev; case 'mCOther':
	ui.act.mC =true; parent = mkMosaic( ui, id, true, 	parent); return dev; case 'kakara':
	ui.act.kK =true; parent = mkKakara( ui, id, true, 	parent); return dev; case 'prompt':
	ui.act.pM =true; parent = mkPrompt( ui, id, true, 	parent); return dev}}
function mkQuad4( ui,dev,id,qU,dim) { if( qU.mono!=""){ dev =mkQuad5( ui,dev,id,dev.qU.dis.mono,dim)}
									if( qU.uR != ""){ dev =mkQuad5( ui,dev,id,dev.qU.dis.uR, 	dim)}
									if( qU.uL != ""){ dev =mkQuad5( ui,dev,id,dev.qU.dis.uL, 	dim)}
									if( qU.dR != ""){ dev =mkQuad5( ui,dev,id,dev.qU.dis.dR, 	dim)}
									if( qU.dL != ""){ dev =mkQuad5( ui,dev,id,dev.qU.dis.dL, 	dim)}
									if( qU.u != "") { dev =mkQuad5( ui,dev,id,dev.qU.dis.u, 	dim)}
									if( qU.d != "") { dev =mkQuad5( ui,dev,id,dev.qU.dis.d, 	dim)}
									if( qU.r != "") { dev =mkQuad5( ui,dev,id,dev.qU.dis.r, 	dim)}
									if( qU.l != "") { dev =mkQuad5( ui,dev,id,dev.qU.dis.l, 	dim)}}
function cC(n,v){ console.log(n);console.log(v)}
function mkQuad3( ui,feHnd,dev,qU,id){ /*cC( "*** mkQuad3 ***"); cC(ui);cC(feHnd);cC(dev);cC(qU);cC(id);*/
	var qD =qDFind( qU,id); if( qD==""){ return dev} else{
	qD = qdFind2( qD,dev.qU); dev =mkQuad4( ui,dev,id,qU,qD)} return dev}
function mkQuad2( ui,feHnd,dev,qU){ /*cC("*** mkQuad2 ***");cC.log( ui);cC.log( feHnd);cC.log( dev);cC.log( qU);*/
	dev = mkQuad3( ui,feHnd,dev,qU,'mCSelf');
	dev = mkQuad3( ui,feHnd,dev,qU,'mCOther');
	dev = mkQuad3( ui,feHnd,dev,qU,'kakara');
	dev = mkQuad3( ui,feHnd,dev,qU,'prompt'); /*cC(dev);*/ return dev}
function mkSidebar( ui,feHnd,sV){ 		var re=new Sidebar( ui,feHnd,sV); 			re =mkSidebarElements( re);return re}
function mkToolTips( ui,fe,sV) { 		var re=new ToolTips( ui,fe,sV); 			re =mkToolTipsElements( re);return re}
function mkGridlock( ui,feHnd) 		{ 	var re=new Gridlock( ui,feHnd);return re}
function mkProTabs( ui,feHnd,DOM,sV){ 	var re=new ProTabs( ui,feHnd,DOM,sV); 		re =mkProTabsElements( re);return re}
function mkSequencer( ui,feHnd,DOM,sV){var re=new Sequencer( ui,feHnd,DOM,sV); 		re =mkSequencerElements( re);return re}
function mkAmmo(ui,fe,sV,DOM,parent) { var re=new Ammo( ui,fe,DOM,sV,parent); 		re =mkAmmoElements(re);return re}
function mkShotgun( ui,fe,DOM,sV,par){ var re=new Shotgun( ui,fe,DOM,sV,par); 		re =mkShotgunElements( re);return re}
function mkCannon( ui,fe,DOM,sV,par){ 	var re=new Cannon( ui,fe,DOM,sV,par); 		re =mkCannonElements( re);return re}
function mkExplorer( ui,feHnd,DOM,sV){	var re=new Explorer( ui,feHnd,DOM,sV); 		re =mkExplorerElements( re);return re}
function mkGram( ui,feHnd,DOM,sV){ 		var re=new Gram( ui,feHnd,DOM,sV);	 		re =mkGramElements( re);return re}
function mkDevBar( ui,feHnd,DOM,sV){ 	var re=new DevBar( ui,feHnd,DOM,sV); 		re =mkDevBarElements( re);return re}
function mkSystemGrid( ui,feHnd,DOM){ 	var re=new SystemGrid( ui,feHnd,DOM); 		re =mkSystemGridElements(re);return re}
function mkQuad( ui,hnd,sV,qU){ 		var re=new Quad( ui,hnd,sV,qU); 			re =caQuad( re,qU);return re}
function mkPanda( ui,hnd,sV,par){ 		var re=new Panda( ui,hnd,sV,par);return re}
function mkTower( ui,hnd,sV,par){ 		var re=new Tower( ui,hnd,sV,par); 			re =mkTowerElements( re);return re}
function mkDialog( ui,feHnd,DOM,sV,p){ var re=new Dialog( ui,feHnd,DOM,sV,p); 		re =mkDialogElements( re);return re}
function mkMosaic( ui,feHnd,sV,parent){var re=new Mosaic( ui,feHnd,sV,parent); 		re =mkMosaicElements( re); return re}
function mkMeter( ui,feHnd,sV,parent){ var re=new Meter( ui,feHnd,sV,parent); 		re =mkMeterElements( re); return re}
function mkKakara( ui,feHnd,sV,parent){var re=new Kakara( ui,feHnd,sV,parent); 		re =mkKakaraElements( re);return re}
function mkYozen( ui,feHnd,sV,parent){ var re=new Yozen( ui,feHnd,sV,parent); 		re =mkYozenElements( re);return re}
function Sidebar( ui,feHnd,SVG){ this.ui =ui;  this.actSVG =SVG; this.sV =null;
	this.feHnd=feHnd; this.disWid =ui.devices.sB.disWid; this.disHei =ui.winWid;
	this.disHrz =ui.winWid -ui.devices.sB.disWid; this.disVrt=ui.devices.sB.disVrt; this.rowHei=ui.devices.sB.rowHei;
	var sty={ fnt:15, brd:3, d:AL.coGrid,
		btnTxt:"#cccccc",	btnU:"#444444",		btnR:"#111111",		btnD:"#080808",		btnL:"#333333", 	sel:"#111111",
		selTxt:"#ffffff",	selU:"#000000",		selR:"#444444",		selD:"#777777",		selL:"#080808", 	bG:"#222222"};
	this.sty =sty; }
function ToolTips( ui,feHnd,SVG){ this.ui=ui; this.feHnd=feHnd; this.disWid=ui.devices.sB.disWid; 
	this.actSVG =SVG; this.sV =null; this.disVrt =ui.winWid -ui.devices.sB.disWid; this.toolArr =[];
	var sty={ bG:"#888888"};
	this.sty =sty; }
function Gridlock( ui,feHnd){ this.ui =ui; this.feHnd=feHnd; this.disWid =ui.winWid -ui.devices.sB.disWid;
	this.disHei =ui.winHei; this.disHrz =ui.devices.gL.disHrz; this.disVrt =ui.devices.gL.disVrt;
	this.lVX =ui.devices.gL.lVX; this.mVX =ui.devices.gL.mVX; this.tHY =ui.devices.gL.tHY; this.THY =ui.devices.gL.THY;
	this.mHY =ui.devices.gL.mHY; this.bHY =ui.devices.gL.bHY; this.scrHrz =ui.devices.gL.mVX +ui.devices.gL.lVX;
	this.scrVrt =ui.devices.gL.tHY;	this.scrWid =ui.winWid -ui.devices.sB.disWid -ui.devices.gL.mVX -ui.devices.gL.lVX;
	this.scrHei =ui.winHei -ui.devices.gL.bHY -ui.devices.gL.tHY;
	/*switch( feHnd){ case "dharma" : this.scrHei =ui.winHei -ui.devices.gL.bHY -ui.devices.gL.tHY; break;
					case "mosaic" : this.scrHei =ui.winHei -ui.devices.gL.bHY -ui.devices.gL.tHY; break}*/}
function Sequencer( ui,feHnd,DOM,SVG){ this.ui =ui; this.actDOM =DOM; this.DOM =null; this.actSVG =SVG; this.sV =null;
	this.feHnd=feHnd; this.disWid =ui.devices.gL.lVX; this.disHei =ui.winWid;
	this.disHrz =ui.devices.sQ.disHrz; this.disVrt =ui.devices.sQ.disVrt;
	this.rowHei =Math.floor((ui.devices.gL.bHY / ui.devices.sQ.rowNum) - (ui.devices.sQ.rowOff / ui.devices.sQ.rowNum));
	var sty = {
		bG:"#000000",		btnTxt:"#888888",	sel:"#555555",		selTxt:"#cccccc"};
	this.sty =sty; }
function ProTabs( ui,feHnd,DOM,SVG){ this.ui =ui; this.actDOM =DOM; this.DOM =null; this.actSVG =SVG; this.sV =null;
	this.feHnd=feHnd; this.disWid =ui.winWid -ui.devices.sB.disWid -ui.devices.gL.lVX; this.disHei =ui.devices.gL.tHY;
	this.disHrz =ui.devices.gL.lVX; this.disVrt =ui.devices.pT.disVrt;
	this.tabHei =ui.devices.gL.THY; this.tabWid =ui.devices.gL.mVX;
	var sty = { rad:6,
		bG:"#000000",		d:AL.coGrid, 		brd:"#555555", 		txt:"#888888", 		sel:"#ffffff"};
	this.sty =sty;}
function Ammo( ui,feHnd,DOM,SVG,parent){ this.ui =ui;this.actDOM=DOM;this.DOM=null;this.actSVG=SVG;this.sV=null;
	this.feHnd=feHnd; 	
						this.disWid =parent.scrWid; this.disHei =parent.scrHei;
						this.scrWid =parent.scrWid; this.scrHei =parent.scrHei;
						this.disVrt =parent.scrVrt; this.disHrz =parent.scrHrz;
						this.scrVrt =parent.scrVrt; this.scrHrz =parent.scrHrz;
	var sty = {
		bG:"#000000", 	bel:"#cccc88",
		ori:"#ffffff", 	oriTxt:"#000000", dup:"#cccccc", dupTxt:"#888888", tra:"#220000", traTxt:"#cc0000"};
	this.sty = sty; }
function Shotgun( ui,feHnd,DOM,SVG,ammo){ this.ui =ui; this.actDOM =DOM; this.DOM =null; this.actSVG =SVG; this.sV =null;
	this.ammo =ammo; this.feHnd=feHnd; this.disWid =ui.winWid -ui.devices.sB.disWid -ui.devices.gL.lVX;
	this.disHei =ui.devices.gL.bHY +ui.devices.gL.mHY;
	this.disHrz =ui.devices.gL.lVX; this.disVrt =ui.devices.gL.tHY +ui.devices.gL.bHY +ui.devices.gL.mHY;
	var sty = {
		bG:"#cccc88", 	brd:"#ffffff", txt:"#ffffff", dup:"#cccccc", not:"#8888cc"};
	this.sty =sty;}
function Cannon( ui,feHnd,DOM,SVG,ammo){ this.ui =ui; this.actDOM =DOM; this.DOM =null; this.actSVG =SVG; this.sV =null;
	this.ammo =ammo; this.feHnd=feHnd; this.disWid =ammo.disWid;
	this.disHei =ui.winHei -ui.devices.gL.tHY -ui.devices.gL.mHY -ui.devices.gL.bHY -ui.devices.gL.dBH;
	this.disHrz =ui.devices.gL.lVX;	this.disVrt =ui.devices.gL.tHY; this.disCal =ui.devices.cA.disCal;
	var sty = {
		bG:"#cccc88", 	brd:"#ffffff", txt:"#ffffff", dup:"#cccccc", not:"#8888cc"};
	this.sty =sty; }
function Explorer( ui,feHnd,DOM,SVG){ this.ui =ui; this.actDOM =DOM; this.DOM =null; this.actSVG =SVG; this.sV =null;
	this.feHnd=feHnd; this.disWid =ui.devices.gL.mVX; this.disHei =ui.winHei -ui.devices.gL.tHY;
	this.disHrz =ui.devices.gL.lVX; this.disVrt =ui.devices.gL.tHY;
	var sty = { 
		bG:AL.coGrid, 		disL:"#ffffff", 	disD:"#cccccc", 	brd:"#999999", 		disCvr:"#555555"};
	this.sty =sty;}
function Gram( ui,feHnd,DOM,SVG){ this.ui =ui; this.actDOM =DOM; this.DOM =null; this.actSVG =SVG; this.sV =null;
	this.feHnd=feHnd; this.disWid =ui.winWid -ui.devices.sB.disWid -ui.devices.gL.lVX; this.disHei =ui.devices.gL.bHY;
	this.disHrz =ui.devices.gL.mVX +ui.devices.gL.lVX; this.disVrt =ui.winHei -ui.devices.gL.bHY -ui.devices.gL.dBH;
	var sty = { brdWid:3,
		bG:AL.coGrid,	d:"#000000"};
	this.sty =sty;}
function DevBar( ui,feHnd,DOM,SVG){ this.ui =ui; this.actDOM =DOM; this.DOM =null; this.actSVG =SVG; this.sV =null;
	this.feHnd=feHnd; this.disWid =ui.winWid -ui.devices.sB.disWid -ui.devices.gL.mVX -ui.devices.gL.lVX;
	this.disHei =ui.devices.gL.dBH;
	this.disHrz =ui.devices.gL.mVX +ui.devices.gL.lVX; this.disVrt =ui.winHei -ui.devices.gL.dBH;
	var sty = { pad:3, //txt color dom svg cond
		bG:"#000000",  txt:"#00ff00"};
	this.sty =sty;}
function Dialog( ui,feHnd,DOM,SVG){ this.ui =ui; this.actDOM =DOM; this.DOM =null; this.actSVG =SVG; this.sV =null;
	this.feHnd=feHnd; this.disWid =ui.winWid -ui.devices.sB.disWid -ui.devices.gL.mVX -ui.devices.gL.lVX;
	this.disHei =ui.devices.gL.mHY; this.disHrz =ui.devices.gL.mVX +ui.devices.gL.lVX;
	this.disVrt =ui.winHei -ui.devices.gL.mHY -ui.devices.gL.tHY;
	var sty = { pad:5,
		bG:AL.coGrid, 	d:"#ffffff", 		brd:"#cccccc"};
	this.sty =sty;}
function Quad( ui,feHnd,SVG,templates){
	this.ui =ui; this.actSVG =SVG; this.sV =null; this.feHnd=feHnd; this.qDs =ui.devices.qU.qDs;
	this.disWid =ui.winWid -ui.devices.sB.disWid -ui.devices.gL.mVX -ui.devices.gL.lVX;
	this.disHei =ui.winHei -ui.devices.gL.tHY -ui.devices.gL.mHY -ui.devices.gL.bHY;
	this.disHrz =ui.devices.gL.mVX +ui.devices.gL.lVX; this.disVrt =ui.devices.gL.tHY;
	this.cntHrz =(ui.winWid -ui.devices.sB.disWid -ui.devices.gL.mVX -ui.devices.gL.lVX)/2;
	this.cntVrt =(ui.winHei -ui.devices.gL.tHY -ui.devices.gL.mHY -ui.devices.gL.bHY)/2;
	this.halWid =Math.floor((ui.winWid -ui.devices.sB.disWid -ui.devices.gL.mVX -ui.devices.gL.lVX)/2);
	this.halHei =Math.floor((ui.winHei -ui.devices.gL.tHY -ui.devices.gL.mHY -ui.devices.gL.bHY)/2);
	this.dis =ui.devices.qU.dis;
	var sty={
		bG:"#220033"};
	this.sty =sty}
function caQuad( qU,qD){
	qU.dis.uR.scrWid=qU.halWid;
	qU.dis.uR.scrHei=qU.halHei; qU.dis.uL.scrWid=qU.halWid; qU.dis.uL.scrHei=qU.halHei;
	qU.dis.dL.scrWid=qU.halWid; qU.dis.dR.scrHei=qU.halHei; qU.dis.dR.scrWid=qU.halWid; qU.dis.dR.scrHei=qU.halHei;
	qU.dis.u.scrWid =qU.disWid; qU.dis.u.scrHei =qU.halHei; qU.dis.l.scrWid =qU.halWid; qU.dis.l.scrHei =qU.disHei;
	qU.dis.d.scrWid =qU.disWid; qU.dis.u.scrHei =qU.halHei; qU.dis.r.scrWid =qU.halWid; qU.dis.r.scrHei =qU.disHei;
	qU.dis.uR.scrHrz=Math.ceil(qU.cntHrz); 	qU.dis.uR.scrVrt=qU.disVrt;
	qU.dis.uL.scrHrz=qU.disHrz; 			qU.dis.uL.scrVrt=qU.disVrt;
	qU.dis.dR.scrHrz=Math.ceil(qU.cntHrz); 	qU.dis.dR.scrVrt=Math.ceil(qU.cntVrt);
	qU.dis.dL.scrHrz=qU.disHrz; 			qU.dis.dL.scrVrt=Math.ceil(qU.cntVrt);
	qU.dis.u.scrHrz =qU.disHrz; 			qU.dis.u.scrVrt =qU.disVrt;
	qU.dis.l.scrHrz =qU.disHrz; 			qU.dis.l.scrVrt =qU.disVrt;
	qU.dis.d.scrHrz =qU.disHrz; 			qU.dis.d.scrVrt =Math.ceil(qU.cntVrt);
	qU.dis.r.scrHrz =Math.ceil(qU.cntHrz); 	qU.dis.r.scrVrt =Math.ceil(qU.cntVrt);
	qU.dis.mono.scrHrz =qU.disHrz; 			qU.dis.mono.scrVrt =qU.disVrt;
	qU.dis.mono.scrWid =qU.disWid; 			qU.dis.mono.scrHei =qU.disHei;return qU}
function SystemGrid( ui,feHnd,DOM){ this.ui =ui; this.actDOM =DOM; this.DOM =null; this.feHnd=feHnd;
	this.disWid =ui.winWid -ui.devices.sB.disWid -ui.devices.gL.mVX -ui.devices.gL.lVX;
	this.disHei =ui.winHei -ui.devices.gL.tHY -ui.devices.gL.mHY -ui.devices.gL.bHY;
	this.disHrz =ui.devices.gL.mVX +ui.devices.gL.lVX; this.disVrt =ui.devices.gL.tHY;
	var sty={
		bG:"#448844",	arm:"#888844",		brd:"#ffff88",		leg:"#222244"};
	this.sty =sty;}
function Panda( ui,fe,SVG,parent){ this.ui =ui; this.actSVG =SVG; this.sV =null; this.feHnd=fe; this.parent=parent;
	this.disWid =parent.scrWid; this.disHei =parent.scrHei; this.disHrz =parent.scrHrz; this.disVrt =parent.scrVrt;
	this.cntHrz =parent.scrWid / 2; 	this.cntVrt =parent.scrHei / 2;
	this.prjSca =ui.devices.pN.prjSca; 	this.prjLen =ui.devices.pN.prjLen; 	this.prjHAp =ui.devices.pN.prjHAp;
	this.edgHrz =(parent.scrWid / 2) * (ui.devices.pN.prjLen / ui.devices.pN.prjSca);
	this.edgVrt =(parent.scrHei / 2) * (ui.devices.pN.prjLen / ui.devices.pN.prjSca);
	this.laReso =ui.devices.pN.laReso; 	this.loReso =ui.devices.pN.loReso; 	this.elReso =ui.devices.pN.elReso;
	this.dis = ui.devices.pN.dis;
	var sty ={
		bG:"#220000"}
	this.sty =sty}
function Mosaic( ui,feHnd,SVG,parent){ this.ui =ui; this.actSVG =SVG; this.sV =null; this.feHnd=feHnd; this.parent=parent;
	this.disWid =parent.scrWid; this.disHei =parent.scrHei; this.disHrz =parent.scrHrz; this.disVrt =parent.scrVrt;
	this.cntHrz =Math.floor( parent.scrWid / 2); 	//laterthis.modHrz =(parent.disWid/2) -Math.floor(parent.disWid/2);
	this.cntVrt =Math.floor( parent.scrHei / 2); 	//this.modVrt =(parent.disWid/2) -Math.floor(parent.disWid/2);
	this.froTiW =Math.floor((parent.scrWid * (ui.devices.mC.prjApe / ui.devices.mC.prjSca)) / ui.devices.mC.xReso);
	this.froTiH =Math.floor((parent.scrHei * (ui.devices.mC.prjApe / ui.devices.mC.prjSca)) / ui.devices.mC.yReso);
	this.latTiW =Math.floor((parent.scrWid * (ui.devices.mC.prjLen / ui.devices.mC.prjSca)) / ui.devices.mC.zReso);
	this.latTiH =Math.floor((parent.scrHei - (parent.scrHei * (ui.devices.mC.prjLen / ui.devices.mC.prjSca)))
		/ ui.devices.mC.yReso);
	this.eleTiW =Math.floor((parent.scrWid - (parent.scrWid * (ui.devices.mC.prjLen / ui.devices.mC.prjSca)))
		/ ui.devices.mC.xReso);
	this.eleTiH =Math.floor((parent.scrHei - (parent.scrHei * (ui.devices.mC.prjLen / ui.devices.mC.prjSca)))
		/ ui.devices.mC.zReso);
	this.reaTiW =Math.floor( parent.scrWid / ui.devices.mC.xReso);
	this.reaTiH =Math.floor( parent.scrHei / ui.devices.mC.yReso);
	var sty={
		bG:"#000022"};
	this.sty=sty; }
function Tower( ui,feHnd,SVG,parent){ this.ui=ui; this.actSVG=SVG; this.sV=null; this.feHnd=feHnd; this.parent=parent;
	this.disWid =parent.disWid; this.disHei =parent.disHei; this.disHrz =parent.disHrz; this.disVrt =parent.disVrt;
	var sty={
		bG:"#000022"}
	this.sty=sty}
function Kakara( ui,feHnd,SVG,parent){ this.ui=ui; this.actSVG =SVG; this.sV =null; this.feHnd=feHnd; this.parent=parent;
	this.disWid =parent.disWid; this.disHei =parent.disHei; this.disHrz =parent.disHrz; this.disVrt =parent.disVrt;
	var sty={
		bG:"#ee00aa"};
	this.sty=sty; }
function Yozen( ui,feHnd,SVG,parent){ this.ui=ui; this.actSVG =SVG; this.sV=null; this.feHnd=feHnd; this.parent=parent;
	this.disWid =parent.disWid; this.disHei =parent.disHei; this.disHrz =parent.disHrz; this.disVrt =parent.disVrt;
	var sty={
		bG:"#eeeeaa"};
	this.sty=sty; }

function mkD(x,y,w,h,id,co,cl) 	{ var r=document.createElement('div'); r.setAttribute( 'position','fixed'); r.setAttribute( 'width',w); r.setAttribute( 'height',h); r.setAttribute( 'left',x); r.setAttribute( 'top',y); r.setAttribute( 'id',id); r.setAttribute( 'background-color',co); if(typeof cl!='undefined'){ r.setAttribute( 'class',cl) }return r}
function mkS(c) { var p=document.createElementNS( nS,'polygon');
	p.setAttribute("points", "100,125  360,125  166,166  335,166"); p.setAttribute( 'fill',c); return p}
function mkK(x,y,w,h,id,co,cl) 	{ var r=document.createElementNS( nS,'rect'); r.setAttribute( 'x',x); r.setAttribute( 'y',y);r.setAttribute( 'width',w); r.setAttribute( 'height',h); r.setAttribute( 'id',id); r.setAttribute( 'fill',co);
	if(typeof cl!='undefined'){ r.setAttribute( 'class',cl) }return r}
function mkSidebarElements( sB){  	sB.sV =mkSidebarSVG( sB); cC(551,sB); return sB}
function mkSidebarSVG( sB){ 		var re =mkK( sB.disHrz,sB.disVrt,sB.disWid,sB.disHei,"sB",sB.sty.bG,"sB"); return re}
function mkToolTipsElements( tT){  	tT.sV =mkToolTipsSVG( tT); return tT}
function mkToolTipsSVG( tT){ 		var re =mkK( tT.disHrz,tT.disVrt,tT.disWid,tT.disHei,"tT",tT.sty.bG,"tT"); return re}
function mkSequencerElements( sQ){  sQ.sV =mkSequencerSVG( sQ); return sQ}
									//if( sQ.actDOM){ sQ.DOM =mkSequencerDOM( sQ);
									//				if( sQ.actSVG){ sQ.DOM.appendChild(sQ.sV)}} return sQ}
function mkSequencerDOM( sQ){		var re =mkD( sQ.disHrz,sQ.disVrt,sQ.disWid,sQ.disHei,"sQD",sQ.sty.bG,"sQD"); return re}
function mkSequencerSVG( sQ){		var re =mkK( sQ.disHrz,sQ.disVrt,sQ.disWid,sQ.disHei,"sQ",sQ.sty.bG,"sQ"); return re}
function mkProTabsElements( pT){ 	console.log(pT); pT.sV =mkProTabsSVG( pT); return pT}
									//if( pT.actDOM){ pT.DOM =mkProTabsDOM( pT);
									//				if( pT.actSVG){ pT.DOM.appendChild(pT.sV)}} return pT}
function mkProTabsDOM( pT){			var re =mkD( pT.disHrz,pT.disVrt,pT.disWid,pT.disHei,"pTD",pT.sty.bG,"pTD"); return re}
function mkProTabsSVG( pT){			var re =mkK( pT.disHrz,pT.disVrt,pT.disWid,pT.disHei,"pT",pT.sty.bG,"pT"); return re}

function mkShotgunElements( sH) {	if( sH.actSVG){ sH.sV =mkShotgunSVG( sH)}
									if( sH.actDOM){ sH.DOM =mkShotgunDOM( sH);
													if( sH.actSVG){ sH.DOM.appendChild(sH.sV)}} return sH}
function mkShotgunDOM( dE){			var re =mkD( dE.disHrz,dE.disVrt,dE.disWid,dE.disHei,"sHD",dE.sty.bG,"sHD"); return re}
function mkShotgunSVG( dE){			var re =mkK( dE.disHrz,dE.disVrt,dE.disWid,dE.disHei,"sH",dE.sty.bG,"sH"); return re}
function mkCannonElements( cA) {	if( cA.actSVG){ cA.sV =mkCannonSVG( cA)} 
									if( cA.actDOM){ cA.DOM =mkCannonDOM( cA);
													if( cA.actSVG){ cA.DOM.appendChild(cA.sV)}} return cA}
function mkCannonDOM( dE){			var re =mkD( dE.disHrz,dE.disVrt,dE.disWid,dE.disHei,"cAD",dE.sty.bG,"cAD"); return re}
function mkCannonSVG( dE){			var re =mkK( dE.disHrz,dE.disVrt,dE.disWid,dE.disHei,"cA",dE.sty.bG,"cA"); return re}
function mkAmmoElements( aM){		if( aM.actSVG){ aM.sV =mkAmmunitionSVG( aM)}
									if( aM.actDOM){ aM.DOM =mkAmmunitionDOM( aM);
													if( aM.actSVG){ aM.DOM.appendChild(aM.sV)}} return aM}
function mkAmmunitionDOM( dE){		var re =mkD( dE.disHrz,dE.disVrt,dE.disWid,dE.disHei,"aMD",dE.sty.bG,"aMD"); return re}
function mkAmmunitionSVG( dE){		var re =mkK( dE.disHrz,dE.disVrt,dE.disWid,dE.disHei,"aM",dE.sty.bG,"aM"); return re}

function mkExplorerElements( eX){ 	if( eX.actSVG){ eX.sV =mkExplorerSVG( eX)}
									if( eX.actDOM){ eX.DOM =mkExplorerDOM( eX);
													if( eX.actSVG){ eX.DOM.appendChild(eX.sV)}} return eX}
function mkExplorerDOM( eX){		var re =mkD( eX.disHrz,eX.disVrt,eX.disWid,eX.disHei,"eXD",eX.sty.bG,"eXD"); return re}
function mkExplorerSVG( eX){		var re =mkK( eX.disHrz,eX.disVrt,eX.disWid,eX.disHei,"eX",eX.sty.bG,"eX"); return re}
function mkGramElements( gR){ 		if( gR.actSVG){ gR.sV =mkGramSVG( gR)}
									if( gR.actDOM){ gR.DOM =mkGramDOM( gR);
													if( gR.actSVG){ gR.DOM.appendChild(gR.sV)}} return gR}
function mkGramDOM( gR){			var re =mkD( gR.disHrz,gR.disVrt,gR.disWid,gR.disHei,"gRD",gR.sty.bG,"gRD"); return re}
function mkGramSVG( gR){			var re =mkK( gR.disHrz,gR.disVrt,gR.disWid,gR.disHei,"gR",gR.sty.bG,"gR"); return re}
function mkDevBarElements( dB){ 	if( dB.actSVG){ dB.sV =mkDevBarSVG( dB)}
									if( dB.actDOM){ dB.DOM =mkDevBarDOM( dB);
													if( dB.actSVG){ dB.DOM.appendChild(dB.sV)}} return dB}
function mkDevBarDOM( dB){			var re =mkD( dB.disHrz,dB.disVrt,dB.disWid,dB.disHei,"dBD",dB.sty.bG,"dBD"); return re}
function mkDevBarSVG( dB){			var re =mkK( dB.disHrz,dB.disVrt,dB.disWid,dB.disHei,"dB",dB.sty.bG,"dB"); return re}
function mkDialogElements( dG){ 	if( dG.actSVG){ dG.sV =mkDialogSVG( dG)}
									if( dG.actDOM){ dG.DOM =mkDialogDOM( dG);
													if( dG.actSVG){ dG.DOM.appendChild(dG.sV)}} return dG}
function mkDialogDOM( dG){			var re =mkD( dG.disHrz,dG.disVrt,dG.disWid,dG.disHei,"dGD",dG.sty.bG,"dGD"); return re}
function mkDialogSVG( dG){			var re =mkK( dG.disHrz,dG.disVrt,dG.disWid,dG.disHei,"dG",dG.sty.bG,"dG"); return re}
function mkSystemGridElements( sG){ if( sG.actSVG){ sG.sV =mkSystemGridSVG( sG)} 
									if( sG.actDOM){ sG.DOM =mkSystemGridDOM( sG);
													if( sG.actSVG){ sG.DOM.appendChild(sG.sV)}} return sG}
function mkSystemGridDOM( sG){		var re =mkD( sG.disHrz,sG.disVrt,sG.disWid,sG.disHei,"sGD",sG.sty.bG,"sGD"); return re}
function mkSystemGridSVG( sG){		var re =mkD( sG.disHrz,sG.disVrt,sG.disWid,sG.disHei,"sG",sG.sty.bG,"sG"); return re}
function mkMosaicElements( mC){ 	if( mC.actSVG){ mC.sV =mkMosaicSVG( mC)} return mC}
function mkMosaicSVG( mC){			var re =mkK( mC.disHrz,mC.disVrt,mC.disWid,mC.disHei,"mC",mC.sty.bG,"mC"); return re}

function mkKakaraElements( dE){ 	if( dE.actSVG){ dE.sV =mkKakaraSVG( dE)} return dE}
function mkKakaraSVG( dE){ 			var re =mkK( dE.disHrz,dE.disVrt,dE.disWid,dE.disHei,"kK",dE.sty.bG,"kK"); return re}
function mkYozenElements( dE){ 		if( dE.actSVG){ dE.sV =mkYozenSVG( dE)} return dE}
function mkYozenSVG( dE){ 			var re =mkK( dE.disHrz,dE.disVrt,dE.disWid,dE.disHei,"yO",dE.sty.bG,"yO"); return re}
function mkMoralystElements( dE){ 	if( dE.actSVG){ dE.sV =mkMoralystSVG( dE)} return dE}
function mkMoralystSVG( dE){ 		var re =mkK( dE.disHrz,dE.disVrt,dE.disWid,dE.disHei,"mT",dE.sty.bG,"mT"); return re}

function precalcFeatureTemplates( uiFes,sB) { var ret=[]; AL.fesLen =AL.fes.length; var fe =null;
	for(var i=0; i < AL.fesLen; i++) { fe =precalcFeatureTemplate( AL.fes[i], uiFes); ret.push( fe)} return ret}
function precalcFeatureTemplate( handle,ui){
	var pTs =precalcProTabs( handle);
	var qU = precalcQuad( handle);
	var fe =new Feature( ui,handle,pTs,qU);	return fe}
function Feature( ui,h,pTs,qU){ this.handle=h; this.pTs=pTs; this.pTsLen=pTs.length;
	var txt =getCaptionForFeature( h); 					this.txt =txt;
	var act =getDevicesForFeature( h); 					this.act =act;
	var dev =precalcDevicesForFeature( ui,h,act,qU); 	this.dev =dev;
	this.tools=null; }
function getCaptionForFeature( h){ switch( h){ case "dharma": return "Dharma"; 	case "money": return "Money";
	case "mosaic": return "Mosaic"; case "yozen": return "Yozen"; case "sygnal": return "Sygnal"}}

function precalcQuad( feHnd){ switch( feHnd){ 	case "mosaic": return AL.qU 
												case "sygnal": return AL.qU } return null }
function precalcGridlock( disWid,disHei,gL){ gL.disWid=disWid; gL.disHei=disHei;
	gL.scrWid=disWid-gL.lVX-gL.mVX;					gL.scrHei=disHei-gL.tHY-gL.bHY;
	gL.scrHrz=gL.lVX+gL.mVX; 						gL.scrVrt=gL.mVX; return gL}
function precalcWindowDimensions( ui){ ui.winWid =window.innerWidth; ui.winHei =window.innerHeight; return ui}
function precalcProTabs( feHnd){var pTs=[]; switch( feHnd){
	case "dharma" : pTs=[ "hello","world"]; break;
	case "mosaic" : pTs=[ "world"]; 		break}return pTs}
function getDevicesForFeature( h){ var r=null; switch( h){
	case "dharma": 	r = {  DOM:true, sV:true, sB:true, tT:true, gL:true,
							sQ:true, aM:false,sH:false,cA:false,mE:false,
							pT:true, eX:true, gR:true, dB:true, dG:false,pM:false,
							sG:true, qU:false,pN:false,mC:false,kK:false,yO:false};return r;
	case "money" : 	r = {  DOM:true, sV:true, sB:true, tT:true, gL:true, 
							sQ:true, aM:true, sH:true, cA:true, mE:false,
							pT:true, eX:true, gR:false,dB:true, dG:false,pM:false,
							sG:false,qU:false,pN:false,mC:false,kK:false,yO:false};return r;
	case "mosaic": 	r =	{  DOM:false,sV:true, sB:true, tT:true, gL:true,
							sQ:true, aM:false,sH:false,cA:false,mE:true,
							pT:true, eX:true, gR:true, dB:true, dG:false,pM:false,
							sG:false,qU:true, pN:false,mC:false,kK:false,yO:false};return r;
	case "yozen" : 	r = {  DOM:false,sV:true, sB:true, tT:true, gL:true,
							sQ:true, aM:false,sH:false,cA:false,mE:false,
							pT:false,eX:true, gR:true, dB:true, dG:false,pM:false,
							sG:false,qU:false,pN:false,mC:false,kK:false,yO:true };return r;
	case "sygnal": 	r = {  DOM:false,sV:true, sB:true, tT:true, gL:true,
							sQ:true, aM:false,sH:false,cA:false,mE:false,
							pT:true, eX:true, gR:false,dB:true, dG:false,pM:false,
							sG:false,qU:true, pN:false,mC:false,kK:false,yO:false};return r}}

function precalcToolsForFeatures( ui, fes, fesLen){
	for(var i=0; i < fesLen; i++) { var tools 	=precalcToolsForFeature( fes[i]);
									tools 		=mkTools( ui,i,tools);
									 }}
function precalcToolsForFeature( fe){ switch( fe){
	case 'dharma': var ret={ SVG:null,sB:null,
		tick:0,undo:1,redo:1,stop:2,play:2,rec:2,save:3,load:3,scroll:4, 	siF1:4,bind:4,	min:0,max:4 };return ret;
	case 'money' : var ret={ SVG:null,sB:null,
		tick:0,undo:1,redo:1,stop:2,play:2,rec:2,save:3,load:3,scroll:4,	siF1:4,bind:4,	min:0,max:4 };return ret;
	case 'mosaic': var ret={ SVG:null,sB:null,
		tick:0,undo:1,redo:1,stop:2,play:2,rec:2,save:3,load:3,scroll:false,siF1:4,bind:4, 	min:0,max:4 };return ret;
	case 'yozen' : var ret={ SVG:null,sB:null,
		tick:0,undo:1,redo:1,stop:2,play:2,rec:2,save:3,load:3,scroll:false,siF1:4,bind:4, 	min:0,max:4 };return ret;
	case 'sygnal': var r={ SVG:null,sB:null,
		tick:0,undo:1,redo:1,stop:2,play:2,rec:2,save:3,load:3,scroll:4, 	siF1:4,bind:4, 	min:0,max:4 };return r;}}
function mkTools( ui,i,t){ ui.features[i].tools = mkTools2( ui.devices.sB, t) }
function mkTools2( sB,t){ var tools ={ SVG:[], len:t.len, sB:null,
	tick:null,undo:null,redo:null,stop:null,play:null,rec:null, save:null,load:null }; var buf =null;
	for(var i=t.min; i < t.max; i++){ buf =null; buf =mkToolRow( i,t[i]); if( buf!=null){ tools.SVG.push( buf)}}
	tools =mkTools3( tools); return tools}
function mkToolRow( n,i){ var tools =mkToolRow2( n,i); if(!tools){ return null}else{
	var ret="ret"; return ret; }}
function mkToolRow2( n,i){ var r ={ r:[], ri:0}; 
	if(i.tick==n){ r.r.push("tick");r.ri++} if(i.undo==n){ r.r.push("undo");r.ri++} if(i.redo==n){ r.r.push("redo");r.ri++}
	if(i.stop==n){ r.r.push("stop");r.ri++} if(i.play==n){ r.r.push("play");r.ri++} if( i.rec==n){ r.r.push( "rec");r.ri++}
	if(i.save==n){ r.r.push("save");r.ri++} if(i.load==n){ r.r.push("load");r.ri++}if(i.scroll==n){r.r.push("scro");r.ri++}
	if(i.siF1==n){ r.r.push("s-F1");r.ri++} if(i.bind==n){ r.r.push("bind");r.ri++}
	
	if( r.ri==0){ return false}else{ return r}}
function mkTools3( tools){ for(var i=tools.len[0]; i < tools.len[1]; i++){ }} 

function mkToolsX( id,rowPop){ var r =null; switch( id){
	case "scro": r ={ id:id, rowPop:rowPop, auto:true, on:false, hold:false,
		sty:{ txt:'DOM', font:'strike_fighter', fontSi:3}}; return r}}


//2btn mouse -> 3 distinct signals; disable norm right clikc
//TensorVertex object with movable low, far and high point
// 	Plane Mosaic resolution should vary according to differences in values of objects?
// 	Tile size should scale
// 	Or then use continuum
//  Necessity of "levels" still not established. "Levels" could be just a theoretical artifact, a byproduct of a value
// 		accumulation model that isn't essentially based on levels. "Levels" could be necessary for a heuristic algortihm
// 		but we aren't close to needing any of those soon.




/*	case "MONODO" 	: return "do";
	case "MONOUNDO" : return "undo";
	case "undo" 	: return "<span style='font-size:13px; position:absolute; top:10px; left: 4px;'>undo</span>";
	case "redo" 	: return "<span style='font-size:13px; position:absolute; top:10px; right:3px;'>redo</span>";
	case "STOP" 	: return "<span style='font-size:25px;'>‚¨õ</span>"; //&#9632;
	case "PLAY" 	: return "<span style='font-size:19px;'>‚≠ì</span>";
	case "REC" 		: return "<span style='color:#8b0000; font-size:39px;'>‚¨§</span>";
	case "SAVE" 	: return "<span style='font-size:19px;'>‚¨á</span>";
	case "LOAD" 	: return "<span style='font-size:19px;'>‚¨Ü</span>";
	case "STACK"	: return "Êåâ";
	case "COLLAPSE"	: return "Êòì";
	case "CONSTL" 	: return "ÊêÅ";
	case "MONOCOL" 	: return "‚îÇ";
	case "MONOROW"	: return "‚îÄ";
	case "HIGHERR"	: return "‚´ß";
	case "SYMMETRY"	: return "<span style='font-size:12px;'>‚îº</span>";
	case "HIGHROW"	: return "‚´ü";
	case "HIGHCOL"	: return "<span style='font-size:27px;'>‚´®</span>";
	case "HIGHERC"	: return "<span style='font-size:27px;'>‚´†</span>";
	case "METATOOL" : return "‚ñ¢";/*"<span style='font-size:65px;'>‚ñ°</span>";*//*
	case "QUADDISP" : return "‚åò‚ùë<br />‚åò‚åò";
	case "MONOMOS"  : return "‚åò";
	case "MONOD3D"  : return "‚ùë";
	case "ZOOMIN"   : return "+";
	case "ZOOMOUT"  : return "-";
	case "LOOKLEFT" : return "<-";
	case "LOOKRGHT" : return "->";
	case "LOOKUP" 	: return "ÀÜ";
	case "LOOKDN"   : return "v";
	case "DISPUL"   : return "1";
	case "DISPUR"   : return "2";
	case "DISPDL" 	: return "3";
	case "DISPDR" 	: return "4";
	case "PROJBIN" 	: return "FT";
	case "PROJCAR" 	: return "-0+"}}*/


/*var elem = document.getElementById("myvideo");
if (elem.requestFullscreen) {
  elem.requestFullscreen();
} else if (elem.msRequestFullscreen) {
  elem.msRequestFullscreen();
} else if (elem.mozRequestFullScreen) {
  elem.mozRequestFullScreen();
} else if (elem.webkitRequestFullscreen) {
  elem.webkitRequestFullscreen();
}*/









































//function precalcDevicesForFeature( ui,a){ var d =initStateForDevice();
	//console.log(a);

	/*if( a.sB){ d.sB =cloneSidebarShape( ui.template.sB); 	d.sB =precalcSidebar( ui, d.sB)}
	if( a.gL){ d.gL =cloneGridlockShape( ui.template.gL); 	d.gL =precalcGridlock( ui, d.gL)}
	if( a.sQ){ d.sQ =cloneSequencerShape( ui.template.sQ);	d.sQ =precalcSequencer( d.gL, d.sQ)} 
	if( a.pT){ d.pT =cloneProTabsShape( ui.template.pT);	d.pT =precalcProTabsUI( d.gL, d.pT)}
	if( a.eX){ d.eX =cloneExplorerShape( ui.template.eX); 	d.eX =precalcExplorer( d.gL, d.eX)}
	if( a.gR){ d.gR =cloneGramShape( ui.template.gR); 		d.gR =precalcGram( d.gL, d.gR)} 		
	if( a.dB){ d.dB =cloneDevBarShape( ui.template.dB); 	d.dB =precalcDevBar( d.gL, d.dB)}
	if( a.dG){ d.dG =cloneDialogShape( ui.template.dG); 	d.dG =precalcDialog( d.gL, d.dG)} 				
	if( a.qU){ d.qU =cloneQuadShape( ui.template.qU); 		d.qU =precalcQuad( d.gL, d.qU)}
	if( a.sG){ d.sG =cloneSystemGridShape( ui.template.sG); d.sG =precalcSystemGrid( d.gL, d.sG)} 
	if( a.mC){ d.mC =cloneMosaicShape( ui.template.mC); 	d.mC =precalcMosaic( d.gL, d.mC)}*/
	/*pn */ 												
	/*if( a.kK){ d.kK =cloneKakaraShape( ui.template.kK); 	d.kK =precalcKakara( ui, d.kK)}
	if( a.yO){ d.yO =cloneYozenShape( ui.template.yO); 		d.yO =precalcYozen( ui, d.yO)} return d}*/

function initFeatureDevices( a,h,uiAct){ function on( p,v){ if(v){ p=v}}
	function sB(d,v){d.sB=v;on(uiAct.sB,v)} function sQ(d,v){d.sQ=v;on(uiAct.sQ,v)} function pT(d,v){d.pT=v;on(uiAct.pT,v)}
	function eX(d,v){d.eX=v;on(uiAct.eX,v)} function gR(d,v){d.gR=v;on(uiAct.gR,v)} function dB(d,v){d.dB=v;on(uiAct.dB,v)}
	function dG(d,v){d.dG=v;on(uiAct.dG,v)} function qU(d,v){d.qU=v;on(uiAct.qU,v)} function sG(d,v){d.sG=v;on(uiAct.sG,v)}
	function mC(d,v){d.mC=v;on(uiAct.mC,v)} function kK(d,v){d.kK=v;on(uiAct.kK,v)} function gL(d,v){d.gL=v;on(uiAct.gL,v)}
	function yO(d,v){d.yO=v;on(uiAct.yO,v)}	switch( h){
	case "dharma" : a.DOM=true; a.sB=true; a.sQ=true; a.pT=true; a.eX=true; a.gR=true;
								a.dB=true; a.dG=false;a.qU=false;a.sG=true; a.mC=false;
								a.kK=false;a.gL=true; a.yO=false;break;
	case "mosaic" : a.SVG=true; a.sB=true; a.sQ=true; a.pT=true; a.eX=true; a.gR=true,
					a.DOM=false;a.dB=true; a.dG=false;a.qU=true; a.sG=false;a.mC=true,
								a.kK=false;a.gL=true; a.yO=false;break;
	case "yozen"  : a.SVG=true; a.sB=true; a.sQ=true; a.pT=false;a.eX=true;	a.gR=true;
					a.DOM=false;a.dB=true; a.dG=false;a.qU=false;a.sG=false;a.mC=false;
								a.kK=false,a.gL=false;a.yO=true }return a}
function precalcUserInterface() { var ui ={ act:null,templates:null,designs:null}; ui.act =initStateForUI();return ui}
function cloneSidebarShape( sB){ var rt={ SVG:sB.SVG,DOM:sB.DOM,state:sB.state,disWid:sB.disWid,disHei:sB.disHei,
	disHrz:sB.disHrz,disVrt:sB.disVrt,rowHei:sB.rowHei,sty:null};
	rt.sty = { fnt:15, brd:3, d:AL.coGrid,
		btnTxt:"#cccccc",	btnU:"#444444",		btnR:"#111111",		btnD:"#080808",		btnL:"#333333", 	sel:"#111111",
		selTxt:"#ffffff",	selU:"#000000",		selR:"#444444",		selD:"#777777",selL:"#080808"};return rt}
function cloneSequencerShape( sQ){ var rt={ SVG:sQ.SVG,DOM:sQ.DOM,state:sQ.state,disWid:sQ.disWid,sty:null};
	rt.sty = {d:"#000000",		btnTxt:"#888888",	sel:"#555555",		selTxt:"#cccccc"};return rt}
function cloneProTabsShape( pT){ var rt={ SVG:pT.SVG,DOM:pT.DOM,state:pT.state,disWid:pT.disWid,disHei:pT.disHei,
	disHrz:pT.disHrz,sty:null}; rt.sty = { rad:6,
			  b:"#000000",	d:AL.coGrid, 		brd:"#555555", 		txt:"#888888", 		sel:"#ffffff"};return rt}
function cloneExplorerShape( eX){ var rt={ SVG:eX.SVG,DOM:eX.DOM,state:eX.state,disWid:eX.disWid,disHei:eX.disHei,
	disHrz:eX.disHrz,disVrt:eX.disVrt,sty:null}; rt.sty = { 
			  b:AL.coGrid, 	disL:"#ffffff", 	disD:"#cccccc", 	brd:"#999999", 		disCvr:"#555555"};return rt}
function cloneGramShape( gR){ var rt={ SVG:gR.SVG,DOM:gR.DOM,state:gR.state,disWid:gR.disWid,disHei:gR.disHei,
	disHrz:gR.disHrz,disVrt:gR.disVrt,sty:null}; rt.sty = { brdWid:3,
			  b:AL.coGrid,	d:"#000000"}; return rt}
function cloneDevBarShape( dB){ var rt={ SVG:dB.SVG,DOM:dB.DOM,state:dB.state,disWid:dB.disWid,disHei:dB.disHei,
	disHrz:dB.disHrz,disVrt:dB.disVrt,sty:null}; rt.sty = { pad:3,
			  b:"#000000",  txt:"#00ff00"};return rt}
function cloneDialogShape( dG){ var rt={ SVG:dG.SVG,DOM:dG.DOM,state:dG.state,disWid:dG.disWid,disHei:dG.disHei,
	disHrz:dG.disHrz,disVrt:dG.disVrt,sty:null}; rt.sty = { pad:5,
			  b:AL.coGrid, 	d:"#ffffff", 		brd:"#cccccc"};return rt}
function cloneQuadShape( qU){ var rt={ SVG:qU.SVG,DOM:qU.DOM,state:qU.state,disWid:qU.disWid,disHei:qU.disHei,
	disHrz:qU.disHrz,disVrt:qU.disVrt,cntHrz:qU.cntHrz,cntVrt:qU.cntVrt};return rt}
function cloneSystemGridShape( sG){ var rt={ SVG:sG.SVG,DOM:sG.DOM,state:sG.state,disWid:sG.disWid,disHei:sG.disHei,
	disVrt:sG.disVrt,disHrz:sG.disHrz,fldWid:sG.fldWid,fldHei:sG.fldHei,furHei:sG.furHei,qdrWid:sG.qdrWid,
	qdrHei:sG.qdrHei,uL:sG.uL,uR:sG.uR,dL:sG.dL,dR:sG.dR,mono:sG.mono,fraThi:sG.fraThi,sty:null}; rt.sty={
			  b:"#448844",	arm:"#888844",		brd:"#ffff88",		leg:"#222244"}; return rt}
function cloneMosaicShape( mC){ var rt={ SVG:mC.SVG,state:mC.state,disWid:mC.disWid,disHei:mC.disHei,disHrz:mC.disHrz,
disVrt:mC.disVrt,xReso:mC.xReso,yReso:mC.yReso,prjSca:mC.prjSca,prjDep:mC.prjDep,prjLid:mC.prjLid,
	farSpW:mC.farSpW, 	farSpH:mC.farSpH,	farPlW:mC.farPlW, 	farPlH:mC.farPlH, farTiW:mC.farTiW, farTiH:mC.farTiH,
	walSpW:mC.farSpW, 	walSpY:mC.farSpY,	walPlW:mC.walPlW, 	walPlH:mC.walPlH, walTiW:mC.walTiW, walTiY:mC.walTiY,
	neaSpW:mC.neaSpW, 	neaSpH:mC.neaSpH, 	neaPlW:mC.neaPlW, 	neaPlH:mC.newPlH, neaTiW:mC.neaTiW, neaTiH:mC.neaTiH,
						ceiSpX:mC.ceiSpiX, 	ceiPlW:mC.ceiPlW, 	ceiPlH:mC.ceiPlH, ceiTiH:mC.ceiTiH, ceiTiX:mC.ceiTiX,
	farWid:mC.farWid, 	farHei:mC.farHei, cntHrz:mC.cntHrz, cntVrt:mC.cntVrt, sty:null};rt.sty={ b:"#000022"}; return rt}
function cloneKakaraShape( kK){ var rt={ SVG:kK.SVG,state:kK.state,sty:null};rt.sty={ b:"#002200" };return rt}
function cloneYozenShape( yO){ var rt={ SVG:yO.SVG,state:yO.state,disWid:yO.disWid,disHei:yO.disHei,disHrz:yO.disHrz,
	disVrt:yO.disVrt,lVX:yO.lVX,mVX:yO.mVX,tHY:yO.tHY,mHY:yO.mHY,sty:null}; rt.sty={ b:"#220022"};return rt}
function cloneGridlockShape( gL){ var rt={ disWid:gL.disWid,disHei:gL.disHei,disHrz:gL.disHrz,disVrt:gL.disVrt,
	lVX:gL.lVX,mVX:gL.mVX,tHY:gL.tHY,mHY:gL.mHY,scrWid:gL.scrWid,scrHei:gL.scrHei,scrHrz:gL.scrHrz,scrVrt:gL.scrVrt};
	return rt}
function precalcSidebar( ui,sB){ sB.disHei =ui.disHei; 	sB.disHrz =ui.winWid-sB.disWid;return sB}
function precalcGridlock( ui,gL){ gL.disWid =ui.disWid; gL.disHei =ui.disHei;return gL}
function precalcSequencer( gL,sQ){ sQ.disHei =gL.disHei; sQ.disWid =gL.lVX;return sQ}
function precalcProTabsUI( gL,pT){ 
	console.log(gL);
	console.log(pT);
	pT.disWid =gL.disVrt-gL.lVX;
	pT.disHrz =gL.lVX; return pT }
function precalcExplorer( gL,eX){ eX.disWid =gL.mVX; eX.disHei =gL.disHei; eX.disVrt =gL.tHY; eX.disHrz =gL.mVX;return eX}
function precalcGram( gL,gR){
	gR.disWid=gL.scrWid;gR.disHei=gL.bHY;gR.disHrz=gL.lVX+gL.mVX;gR.disVrt =gL.disHei-gR.disHei; return gR}
function precalcDevBar( gL,dB){dB.disWid =gL.scrWid; dB.disHrz =gL.scrHrz; 	dB.disVrt =gL.disHei-dB.disHei;return dB}
function precalcDialog( gL,dG){
	dG.disWid =gL.scrWid; dG.disHei =gL.mHY;	dG.disHrz =gL.scrHrz; dG.disVrt =gL.scrHei;return dG}//note
/*function precalcQuad( gL,qU){qU.disWid =gL.scrWid; qU.disHei =gL.scrHei; qU.disHrz =gL.scrHrz; qU.disVrt =gL.scrVrt;
	qU.cntHrz =qU.disWid/2; qU.cntVrt =qU.disHei/2; return qU}*/
function precalcSystemGrid( gL,sG){ sG.disWid =gL.scrWid; sG.disHei =gL.scrHei; sG.disHrz =gL.scrHrz; sG.disVrt =gL.scrVrt;
	sG.fldWid =(sG.disWid-(2*sG.fraThi))/9; sG.fldHei =(sG.disHei-(2*sG.fraThi))/9;
	sG.furHei =sG.fldHei/4; sG.qdrWid =sG.fldWid*4; sG.qdrHei =sG.fldHei*4; return sG}
function calcMosReso(r){ r = 2 * ((r * 2) + 1);return r}
function precalcMosaic( gL,mC){ /*syntax right with n?*/
	function calcNearSpotX(a){ var n=mC.neaFfX;for(var i=0; i < mO.xReso; i++){ n +=( i * mO.neaSpW); a.push(n)}return a}
	function calcNearSpotY(a){ var n=mO.neaFfY;for(var i=0; i < mO.yReso; i++){ n +=( i * mO.neaSpH); a.push(n)}return a}
	function calcNearTileX(a){ var n=mO.neaFfX+mO.neaPlW; for(var i=0; i < mO.xReso; i++){
		n = mO.neaSpW[i] + mO.neaPlW; a.push(n)}return a}
	function calcNearTileY(a){ var n=mO.neaFfY+mO.neaPlH; for(var i=0; i < mO.yReso; i++){
		n = mO.neaSpH[i] + mO.neaPlY; a.push(n)}return a}
	function calcCeilingTileX(a){ var n=mO.ceiPlH;for(var i=0; i < mO.xReso; i++){ n += mO.ceiTiH; a.push([n])}return a}
	function calcWallTileY(a){ var n=mO.walPlV;for(var i=0; i < mO.yReso; i++){ n += mO.walTiV; a.push([n])}return a}
	mO.disWid =gL.disWid; mO.disHei =gL.disHei; mO.disHrz =gL.disHrz; mO.disVrt =gL.disVrt;
	mO.xReso =calcMosReso( mO.xReso); 	mO.yReso =calcMosReso( mO.yReso); 	mO.zReso =calcMosReso( mO.zReso);
	mO.cntHrz =Math.floor(mO.disWid / 2); 						mO.cntVrt =Math.floor( mO.disHei / 2);
	mO.neaSpW =Math.floor( mO.disWid / mO.xReso); 				mO.neaSpH =Math.floor( mO.disHei / mO.yReso);
	mO.neaFfX =(mO.disWid / 2) - (mO.neaSpW * (mO.xReso / 2));	mO.neaFfY =(mO.disHei / 2) - (mO.neaSpH * (mO.yReso / 2));
	mO.neaTiW =mO.neaSpW - (mO.neaPlW * 2);						mO.neaTiH =mO.neaSpH - (mO.neaPlH * 2);
	mO.walWid =(( mO.prjDep / mO.prjSca) * mO.disWid) / 2; 		mO.ceiHei =(( mO.prjDep / mO.prjSca) * mO.disHei) / 2;
	mO.farWid =mO.disWid - (mO.walWid * 2); 					mO.farHei =mO.disHei - (mO.ceiHei * 2);
	mO.farSpW =mO.farWid / mO.xReso; 							mO.farSpH =mO.farHei / mO.yReso;
	mO.farTiW =mO.farSpW - (mO.farPlW * 2); 					mO.farTiH =mO.farSpH - (mO.farPlH * 2);
	mO.walSpW =mO.walWid / mO.zReso; 							mO.walTiW =mO.walSpW - (mO.walPlW * 2);
	mO.ceiSpH =mO.ceiHei / mO.zReso; 							mO.ceiTiH =mO.ceiSpH - (mO.ceiPlH * 2);
	mO.neaSpX =calcNearSpotX(mO.neaSpX); 						mO.neaSpY =calcNearSpotY(mO.neaSpY);
	mO.neaTiX =calcNearTileX(mO.neaSpX); 						mO.neaTiY =calcNearTileY(mO.neaTiY);
	mO.ceiTiX =calcCeilingTileX(mO.ceiTiX); 					mO.walTiY =calcWallTileY(mO.walTiY); return mO
/* to do: matrices ? */}
function precalcKakara( gL,kK){return kK}
function precalcYozen( gL,yO){return yO}








function stUI(blEx) { var state = { 			int:null, obj:null, ext: null };
	state.int = stQuad(false);					state.obj = stQuad( null);
	if(typeof blEx == 'undefined'){ 			state.ext = stQuad(false)} return state}
function stQuad(v){ var q={ uL:v,uR:v,dL:v,dR:v, mono:v, l:v,u:v,r:v,d:v };return q}
function stQuadUI(){ var state = stUI(); 	state.quadObj = stQuad(null);
											state.quadInt = stQuad(undefined); 	return state}




































function populateSystemGrid(sg) {}
function initSysGrid(handle) { var r=null;
		 if(handle=='dharma'){ r = initDharmaSystemGrid() 	} return r }
function initDharmaSystemGrid() { var sg = configureSystemGrid("dharmaMono",AL.winWid,AL.winHei); return sg }
function initSystemGridSVG(sg) {}
function initSystemGridDOM(sg) { console.log(sg); // syd√§n syggyr√§ll√§ ! <3
	var dis = document.createElement('div'); 		dis.style.position = 'fixed';
	var cla = 'systemGrid_' + sg.code;				dis.setAttribute('id',cla);
	dis.style.width = sg.disWid + 'px'; 			dis.style.height = sg.disHei + 'px';
	dis.style.left = sg.dpOffX + 'px'; 				dis.style.top = sg.dpOffY + 'px';
	for(var y=0; y<11; y++) { for(var x=0; x<11; x++) {
		var top = document.createElement('div'); 			top.setAttribute('class',cla);
		var txt = 'systemGrid_'+x+'-'+y;					top.setAttribute('id',txt);
		top.style.width = sg.fldWid + 'px'; 				top.style.height = sg.fldHei + 'px';
		top.style.position = 'fixed';
		var num = (x * sg.fldWid) + sg.dpOffX;				top.style.left = num + 'px';
		num 	= (y * sg.fldHei) + sg.dpOffY;				top.style.top  = num + 'px';
		for(var z=0; z<4; z++) {
			var pix = document.createElement('div'); 			pix.style.position = 'fixed';
			cla = 'systemGridPixel_'+sg.code+"-"+z; 			pix.setAttribute('class',cla);
			cla = 'systemGridPixel'; 							pix.setAttribute('class',cla);
			txt = 'systemGridPixel_'+x+'-'+y+'-'+z; 			pix.setAttribute('id',txt);
			/*cla = 'systemGridPixel'; 							pix.setAttribute('class',cla);
			txt = 'systemGridPixel_'+sg.code+'-'+x+'-'+y+'-'+z; pix.setAttribute('id',txt);
			pix.style.width = sg.fldWid + 'px';*/
		}
		/*cla = 'systemGridPixel_'+sg.code+"-"+z; 			pix.setAttribute('class',cla);	1289.				cla = 'systemGridPixel'; 							pix.setAttribute('class',cla);
1290.				txt = 'systemGridPixel_'+x+'-'+y+'-'+z; 			pix.setAttribute('id',txt);*/
		dis.appendChild(top); }}
	sg.DOM = dis; return sg }

	/* FURROWS FURR
	var dp = document.createElement('div'); 		dp.setAttribute('class','systemGrid');
	var id = 'systemGrid_' + sg.code; 				dp.setAttribute('id',id);
	dp.style.top = sg.dpOffY; 						dp.style.left = sg.dpOffX;
	//var ULEfld = document.createElement('div'); 	ULEfld.setAttribute('class','systemGridField');
	//ULEfld.setAttribute('id','systemField_ULE'); 	
	sg.DOM = dp; return sg*/ 
function ploughSystemGridFields(sg){ var fields=[[],[],[],[],[],[],[],[],[]]; var field=null; var flOffY=0; var flOffX=0;
	for(var y=0; y<9; y++) { flOffX=0; flOffY = y * sg.fldWid;
		for(var x=0; x<9; x++) { flOffX += sg.fldWid; field={ x: flOffX, y: flOffY }; fields[y].push(field); }}
	sg.fields = fields; return sg }
function irrigateSystemGridFields(sg){
	if(sg.SVG){ sg=initSystemGridSVG(sg) } else if(sg.DOM){ sg=initSystemGridDOM(sg) } return sg }
function configureSystemGrid(code,winWid,winHei) { var rt={ //widdif heidif misnomers
	code:code, disWid:0, disHei:0, dpOffX:0, dpOffY:0, fldHei:0, fldWid:0, widDif:0, heiDif:0, DOM:false, SVG:false};
	if(code=="dharmaMono"){ rt.dpOffX=173; rt.dpOffY=25; rt.DOM=true; 
		rt.disWid=winWid-AL.sidebarWidth-173; 				rt.disHei=winHei-AL.headerHeight-73;
		rt.fldHei=Math.floor(rt.disHei/11);					rt.fldWid=Math.floor((rt.disWid / 11)) }
	rt = irrigateSystemGridFields(ploughSystemGridFields(rt)); return rt }

/*function configureSystemGrid(code,winWid,winHei) {
	var rt = { code:code, disWid:0, disHei:0, dpOffX:0, dpOffY:0, runHei:AL.sysGridRungHeight,fldHei:0, fldWid:0,
		widDif:0, heiDif:0, fldYUp:0, upRngY:0, fldYup:0, fldYdn:0, dnRngY:0, fldYDn:0, DOM:false,
												fldXLE:0, fldXLe:0, fldXle:0, fldXri:0, fldXRi:0, fldXRI:0, SVG:false};
	if(code=="dharmaMono"){ rt.dpOffX=173; rt.dpOffY=98; rt.DOM=true; 
		rt.disWid=winWid-AL.sidebarWidth-173; 				rt.disHei=winHei-AL.headerHeight-98;
		rt.fldHei=Math.floor((rt.disHei-(2*rt.runHei))/4);	rt.fldWid=Math.floor((rt.disWid / 6)) }
	rt = irrigateSystemGridFields(ploughSystemGridFields(rt)); return rt }*/



                                                                            //
                                                             //            {}       .
                                               //   )       (i)      (      }      (    j
                                             //)     )})    ({I})    ()    (.)      )
                                           //)}I})  )}I})  ){}})   ({u})  ({|})  }})   j
                        // üéÇüéÇüéÇ       ip ur i I AI type fight vitality right))}))j j  j    üéÇüéÇüéÇ \\
                        // üéÇüéÇüéÇ zzzzzzZ:::::::::: S.Y.S.T.E.M;.;G.R.I,D‚ÄΩ ::::::::::zzzzzzz üéÇüéÇüéÇ \\
                        // üéÇüéÇüéÇ                                                            üéÇüéÇüéÇ \\
                        //  (  (     greetings from off the grid /\ kreetings to grew |-      )  )   \\
                        //   >  >  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - <  <  \\
                        //  (  (   * H * A * P * P * Y *    B * I * R * T * H * D * A * Y *   )  )   \\
                        //   >  >  =.  =.  =.  =.  =.  =.  =.  =.  =.  =.  =.  =.  =.  =.  =. <  <  \\
                        //  (  (                     all outta skyr ;=                         )  )  \\
                        //   >  > -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  <  <  \\
                        // üéÇüéÇüéÇ                                                            üéÇüéÇüéÇ \\
                        // üéÇüéÇüéÇ zzzzzzz:::::::::: S.Y.S.T.E.M;.;G.R.I,D‚ÄΩ ::::::::::zzzzzzz üéÇüéÇüéÇ  \\
                        // üéÇüéÇüéÇ                                                            üéÇüéÇüéÇ \\\
                   //==============================================================================-----,,,..
                     //¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß
                          //¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß¬ß
                                                    //√Ö√Ö√Ö√Ö√Ö√Ö√Ö√Ö√Ö√Ö√Ö√Ö√Ö√Ö√Ö√Ö√Ö√Ö√Ö√Ö
                                                       //√Ö√Ö√Ö√Ö√Ö√Ö√Ö√Ö√Ö√Ö√Ö√Ö√Ö√Ö
                                                        //√Ñ√Ñ√Ñ√Ñ√Ñ√Ñ√Ñ√Ñ√Ñ√Ñ√Ñ√Ñ
                                                         //√∂√∂√∂√∂√∂√∂√∂√∂√∂√∂
                                                       //√ñ√ñ√ñ√ñ√ñ√ñ√ñ√ñ√ñ√ñ√ñ√ñ√ñ√ñ
                                                        //√•√•√•√•√•√•√•√•√•√•√•√•
                                                       //√ñ√ñ√ñ√ñ√ñ√ñ√ñ√ñ√ñ√ñ√ñ√ñ√ñ√ñ
                                                         //wwwwwwwwww
                                                        //TTTTTTTTTTTT
                                                       //UUUUUUUUUUUUUU
                                                    //////////////////////
                                     //////////////////////////////////////////////////
                                ////////////////////////////////////////////////////////////
// form may be used instead of init for tng objects
// 3D view may as well be tree but we also need tree in dharma explorer
// dharma explorer is to have tree generator option in footer
// send dharma profile to tab feature, so that could import tree from mosaic view to dharma view? nah better have own view
// the end is above you; you cannot get there
function dharmaToMosaic(b,R){ var vp=b.vertexPlane;
	function display(v,r) {if(typeof r=="undefined"){ sketchMosaic(v,"uL",R,(R*2)+1) }
						else if(r==1) {sketchMosaic(v,"uL",1,(R*2)+1)}
						else if(r==3) {sketchMosaic(v,"uL",(R*2)+1,(R*2)+1); }}
	function punctuate(n) {sketchMosaic(mp.uL,"uL",n,n); }
	var mp={uL:null,u:null,uR:null,l:null,o:null,r:null,dL:null,d:null,dR:null,plane:null};
	mp.uL=colorQuadrant(vp.uL,R,b,"uL");	mp.u=colorAxis(vp.u,R);		mp.uR=colorQuadrant(vp.uR,R,b,"uR");
	mp.l =colorAxis(vp.l,R); 				mp.o=vp.origin;				mp.r =colorAxis(vp.r,R);
	mp.dL=colorQuadrant(vp.dL,R,b,"dL");	mp.d=colorAxis(vp.d,R);		mp.dR=colorQuadrant(vp.dR,R,b,"dR");
	var top		= interleaveQuadrants( R, mp.uL, mp.u, mp.uR );	var bottom  = interleaveQuadrants( R, mp.dL, mp.d, mp.dR );
	var middle  = mp.l.concat(mp.o).concat(mp.r);				var plane = colorDomain(R, top, bottom, middle);
	mp.plane=plane; return mp }
function initMosaic(d) { var R = AL.resolution; d.mosaic = new Mosaic(
		d.mas.selves.adult, d.mas.others.adult,	d.fem.selves.adult, d.fem.others.adult, AL.resolution);	return d; }
/*function Mosaic(uL,uR,dL,dR,R){ if(typeof R=="undefined"){R=AL.resolution} var sign=[[uL.sign,uR.sign],[dL.sign,dR.sign]];
	uL.mosaic = dharmaToMosaic(uL,R);	uR.mosaic = dharmaToMosaic(uR,R);
	dL.mosaic = dharmaToMosaic(dL,R);	dR.mosaic = dharmaToMosaic(dR,R);
	var p = createMosaic(uL.mosaic.plane, uR.mosaic.plane, dL.mosaic.plane, dR.mosaic.plane, R);
	this.plane=p; this.uL=uL;this.uR=uR;this.dL=dL;this.dR=dR; this.sign=sign; }*/
function createMosaic(uL,uR,dL,dR,R) { function display() { sketchMosaic(ret,"uL",2*((2*R)+1)) }
	var U = interleaveDomains(R,uL,uR); var D = interleaveDomains(R,dL,dR);	var ret = U.concat(D); return ret }
function interleaveDomains(R,lM,rM) { var r = (2*R)+1; var X = 2*r; var Y = r; var m = makeNullMatrix(X,Y);
	function display() { sketchMosaic(m,"uL",r,X) }
	for(var y=0; y<Y; y++){	for(var x=0; x<X; x++) { if(x<r) { m[y][x] = lM[y][x] }
													 else 	 { m[y][x] = rM[y][x-r] }}} return m }
function paintQuadrant(R,off,g,b) {	function display() { sketchMosaic(q,"uL",R); }
	function combine(x,y) { 
		if(g[y][x]==null) {	if(off) { if(y<R) { q[y][x]=b[y-1][x] }} else { q[y][x]=b[y][x] }} else { q[y][x]=g[y][x] }}
	var q = makeNullMatrix(R,R); for(var y = 0; y < R; y++) { for(var x = 0; x < R; x++) { combine(x,y) }}  return q }
function offsetRight(matrix,n){	for(var i = 0; i < n; i++) { for(var j = n-1; j >= 0; j--) {
			matrix[i][j] = matrix[i][j-1]; } if(j==1) { matrix[i][j-1] = null; }}}
function rotate(matrix,n) {	var r=Math.ceil(n/2); if(n%2==1) { r--; }
    for (var i = 0; i < n/2; i++) { for (var j = 0; j < r; j++) {
            var temp = matrix[i][j]; matrix[i][j] = matrix[n-1-j][i]; matrix[n-1-j][i] = matrix[n-1-i][n-1-j];
            matrix[n-1-i][n-1-j] = matrix[j][n-1-i]; matrix[j][n-1-i] = temp; }} return matrix }
function flipDiagonal(matrix,n) { for (var i = 0; i < n; i++) { for (var j = 0; j < n; j++) {
        	if(j < i) {	var temp = matrix[j][i]; matrix[j][i] = matrix[i][j]; matrix[i][j] = temp; }}} return matrix }
function stroke(c) { var ret={r:c.r, g:c.g, b:c.b, h:c.h }; return ret; }
function paintTriplane(t,m,g,R) {	var X; var Y; var bRes=R; var src=null; var dst=null; var b=null; var yi=Infinity;
	function draw(x,y) { if(x<=y) {	if 		(x==y) 		  	 { m[y][x] = stroke(t.d[y]) }
									else if (x==0&&y<R-1)	 { m[y][x] = stroke(t.v[y]) }
									else if (y==R-1) 	 	 { m[y][x] = stroke(t.h[x]) }	
									else { if(y>yi||b==null) { src=stroke(t.v[y]);dst=stroke(t.d[y]);//if(Res%2==1){bRes--}
										b=blendColors(bRes, src, dst); yi=y; } m[y][x] = stroke(b[x]) }}}
								for(var y=0; y<R; y++) { b=null; yi=Infinity;
									for(var x=0; x<R; x++) { draw(x,y); }} return m }
function colorTriplane(t,R) { var ax=stroke(t.axial); var prox=stroke(t.proximal); var diag=stroke(t.diagonal); 
	var v=blendColors(R+1,prox,ax);	var d=blendColors(R+1,prox,diag); var h=blendColors(R+3,ax,diag);return{ h:h,v:v,d:d }}
function makeNullArray(R) { var r=[]; for(var i=0; i<=R; i++) { r.push(null); } return r; }
function makeNullMatrix(X,Y){var r=[];var b;for(var y=0;y<Y;y++){b=[];for(var x=0;x<X;x++){b.push(null)}r.push(b)}return r}
function colorQuadrant(q,R,b,code) { var offsetDown=false; // dont need b here???
	function situateHrz(tp,s,res) {
							if(code=="uL"||code=="dL") { offsetRight(tp,res) }
							if(code=="dL"||code=="dR") { offsetDown=true }}
	function orient(tp,s,g,res) { 
							if(code=="uL" && !g) { rotate(rotate(tp,res),res) }
							if(code=="uL" &&  g) { flipDiagonal(rotate(rotate(tp,res),res),res) }
							if(code=="uR" &&  g) { flipDiagonal(rotate(flipDiagonal(tp,res),res),res) }
							if(code=="uR" && !g) { rotate(rotate(rotate(flipDiagonal(tp,res),res),res),res) }
							if(code=="dL" &&  g) { flipDiagonal(rotate(tp,res),res) }
							if(code=="dL" && !g) { rotate(rotate(rotate(tp,res),res),res) }
							if(code=="dL") 		 { flipDiagonal(tp,res) }
							if(code=="dR" &&  g) { flipDiagonal(tp,res) }}
	function apply(triplane,matrix,colors,res){ var r=paintTriplane(colors, matrix, triplane.good, res); return r }
	function display() { sketchMosaic(goodTriplane,"uL",R); sketchMosaic(badTriplane,"uR",R); }
	var badMatrix = makeNullMatrix(R,R);					 var goodMatrix = makeNullMatrix(R,R);
	var badColors = colorTriplane(q.bad, R-1); 				 var goodColors = colorTriplane(q.good, R);
	var badTriplane=apply(q.bad, badMatrix, badColors, R-1); var goodTriplane=apply(q.good, goodMatrix, goodColors, R);
	orient(badTriplane, q.sign.vis, false, R-1);			 orient(goodTriplane, q.sign.vis, true, R);
	situateHrz(badTriplane,q.sign.vis, R); var r = paintQuadrant(R, offsetDown, goodTriplane, badTriplane);	 return r }
function colorAxis(a,R) { var ret=[]; if(typeof R=="undefined") { R=AL.resolution }
	if(a.sign.syn=="u"||a.sign.syn=="d") { R++ }
	var colors=blendColors(R,a.crucial,a.peripheral); //colors = colors.slice(1,R);
	if(a.sign.syn=="l"||a.sign.syn=="u"){ colors.reverse()}return colors}
function interleaveQuadrants(R,l,v,r) { var X = (2*R)+1; var Y = R; var m = makeNullMatrix(X,Y);
	for(var y=0; y<Y; y++){	for(var x=0; x<X; x++) { if(x<R)  { m[y][x] = l[y][x] }
												else if(x==R) { m[y][x] = v[y] }
												else 		  { m[y][x] = m[y][x] = r[y][x-R-1] }}} return m }
function colorDomain(R,top,btm,mid) { var r=(R*2)+1; var m=makeNullMatrix(r,r);
	for(var y=0; y<r; y++){ for(var x=0; x<r; x++) { if(y<R)  { m[y][x] = top[y][x] }
												else if(y==R) { m[y][x] = mid[x] }
												else 		  { m[y][x] = btm[y-R-1][x] }}} return m }
function componentToH(n) { var hex = n.toString(16); return hex.length == 1 ? "0" + hex : hex; }
function rgbToH(r,g,b) { if(r != null) { return "#"+componentToH(r)+componentToH(g)+componentToH(b); } else { return "" }}
function hToRgb(hex) { var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex); return result ? {
	r: parseInt(result[1], 16), g: parseInt(result[2], 16), b: parseInt(result[3], 16), h: hex } : null; }	
function blendColors(n,from,to) { var rt = [];
	var r = chunkify(n, from.r, to.r); var g = chunkify(n, from.g, to.g); var b = chunkify(n, from.b, to.b);
	for(var i = 0; i < n; i++) { h = rgbToH(r[i],g[i],b[i]); rt.push({r:r[i],g:g[i],b:b[i],h:h}); } return rt }
function chunkify(n,from,to) { var ret = []; var size = Math.floor((to-from) / (n-1)); if(n % 2 == 0) {
	for(var i = 0; i < n; i++) { ret.push(from + (i * size)); } return ret } else { ret = [from];
	for(var i = 1; i < (n-1); i++) { ret.push(from + (i * size)); }} ret.push(to); return ret }
function initVectorColors() {
	function f(n,G,U,R) { var re = { n:n, G:G, U:U, R:R, r:0, g:0, b:0, h:"" };
		function f2 (c,G,U,R) { G ? U ? R ? c.h="#ff7700" : c.h="#fffe00" : R ? c.h="#ff0000" : c.h="#ff00bf" :
									U ? R ? c.h="#0043ff" : c.h="#8900fe" : R ? c.h="#00ffff" : c.h="#2eff62" ; return c }
		function f1 (c,G,U,R) { G ? U ? R ? c.h="#462300" : c.h="#424100" : R ? c.h="#44323E" : c.h="#543e4d" :
									U ? R ? c.h="#00257F" : c.h="#48007E" : R ? c.h="#1C8080" : c.h="#1C8035" ; return c }
		function f0 (c,G,U,R) { G ? U ? R ? c.h="#FFDDBC" : c.h="#FFFEBC" : R ? c.h="#FFBBBD" : c.h="#FFBEFF" :
									U ? R ? c.h="#B9CDFF" : c.h="#C87CFF" : R ? c.h="#BAFFFF" : c.h="#BAFFCC" ; return c }
		n==0 ? re = f0(re,G,U,R) : n==1 ? re = f1(re,G,U,R) : re = f2(re,G,U,R);
		var rgb=hToRgb(re.h); re.r=rgb.r; re.g=rgb.g; re.b=rgb.b; return re; } var ret=
	{low:{	bUL:f(0,false,true,false),bUR:f(0,false,true,true),bDL:f(0,false,false,false),bDR:f(0,false,false,true),
			gUL:f(0,true,true,false), gUR:f(0,true,true,true), gDL:f(0,true,false,false), gDR:f(0,true,false,true)},
	far: {	bUL:f(1,false,true,false),bUR:f(1,false,true,true),bDL:f(1,false,false,false),bDR:f(1,false,false,true),
			gUL:f(1,true,true,false), gUR:f(1,true,true,true), gDL:f(1,true,false,false), gDR:f(1,true,false,true)},
	high:{	bUL:f(2,false,true,false),bUR:f(2,false,true,true),bDL:f(2,false,false,false),bDR:f(2,false,false,true),
			gUL:f(2,true,true,false), gUR:f(2,true,true,true), gDL:f(2,true,false,false),gDR:f(2,true,false,true)}};
	return ret }

	  /*¬®¬®¬®¬®\ 		  CC   CCC   CCCCC   PPPPP	 
	 /.\   /.\ 		 CC   CC CC  CC  CC  PP 		V3 as super-material missile
	/.  \ /  .\ 	CC   CC   CC CCCCC   PPPPP 		HIGHLY UNANTICIPATED
	\.  / \  ./ 	CC   CC   CC CC  CC  PP 		'Kolmas kerta toden sanoo!'
	 \./   \./ 		 CC   CC CC  CC  CC  PPPPP 		VOIMAKAS PSYKOLOGINEN EFEKTI
	  \_____/ 		  CC   CCC   CC  CC  PPPP*/ 

function initSelves(c) {
	var M = initMasculinity(c);
	var m = manToBoy(M.vertexPlane);
	var f = manToGirl(M.vertexPlane);
	var F = manToWoman(M.vertexPlane);
	return { M:M, m:m, F:F, f:f }}
function createOther(being) { var vertexPlane = swapRatAbs(being.vertexPlane, being.male, being.other);
	var ret = new Being(being.adult, being.male, vertexPlane, true, being.sign+"'");
	ret.moods=initMoods(ret.adult, ret.male, ret.vertexPlane, true, ret.sign); return ret }
function initOthers(selves) { var others={
		M:createOther(selves.M),
		m:createOther(selves.m),
		f:createOther(selves.f),
		F:createOther(selves.F)};
	return { mas: { selves: { adult: selves.M, child: selves.m }, others: { adult:others.M, child:others.m }},
			 fem: { selves: { adult: selves.F, child: selves.f }, others: { adult:others.F, child:others.f}}}}
function createMoods(plane) { var src=copyVertexPlane(plane); var ret = {
	peaceful:src, enemy:src, playful:src, hostile:src, escorting:src, runaway:src }; return ret }
function initMoods(adult,G,plane,O,sign) { var ret=createMoods(plane);
	ret.peaceful =									ret.peaceful = new Being( adult, G, ret.peaceful, O, sign+"-pace");
	ret.escorting= synFlip(ret.escorting,1,0,G,O);	ret.escorting= new Being( adult, G, ret.escorting,O, sign+"-esco");
	ret.playful  = synFlip(ret.playful,  2,0,G,O);	ret.playful  = new Being( adult, G, ret.playful,  O, sign+"-play");
	ret.hostile  = synFlip(ret.hostile,  0,2,G,O); 	ret.hostile  = new Being( adult, G, ret.hostile,  O, sign+"-hstl");
	ret.runaway  = synFlip(ret.runaway,  1,2,G,O);	ret.runaway  = new Being( adult, G, ret.runaway,  O, sign+"-runa");
	ret.enemy    = synFlip(ret.enemy,	 2,2,G,O);  ret.enemy 	 = new Being( adult, G, ret.enemy, 	  O, sign+"-enmy");
	return ret }
function initPrimalMoods(beings) {
	beings.M.moods = initMoods(beings.M.adult, beings.M.male, beings.M.vertexPlane, false, beings.M.sign);
	beings.m.moods = initMoods(beings.m.adult, beings.m.male, beings.m.vertexPlane, false, beings.m.sign);
	beings.f.moods = initMoods(beings.f.adult, beings.f.male, beings.f.vertexPlane, false, beings.f.sign);
	beings.F.moods = initMoods(beings.F.adult, beings.F.male, beings.F.vertexPlane, false, beings.F.sign); return beings }
function manToWoman(plane){var r=swapSubLog(flipLowHigh(plane,true),true);r=new Being(true,false, r,false,"F");return r}
function manToGirl(plane) {var r=swapSubLog(flipLowFar(plane,true),true); r=new Being(false,false,r,false,"f");return r}
function manToBoy(plane)  {var r=flipLowFar(plane,false);			 	  r=new Being(false,true, r,false,"m");return r}
function BiblAde(crucial,peripheral,amplifying,sign) { this.crucial=crucial; this.peripheral=peripheral; this.sign=sign;
	if(amplifying) { this.little=crucial; this.much=peripheral; } else { this.little=peripheral; this.much=crucial; }}
function createAxis(crucial,peripheral,amplifying,semSign,synSign){ var sign={sem:semSign, syn:synSign};
	var ret = {crucial:hToRgb(crucial), peripheral:hToRgb(peripheral)};
	var ret = new BiblAde(ret.crucial, ret.peripheral, amplifying, sign); return ret }
function initMasculinity(c) {
	var bUL=new Triplane(c.low.bUL,c.far.bUL,c.high.bUL,false); var gUL=new Triplane(c.low.gUL,c.far.gUL,c.high.gUL,true);
	var bUR=new Triplane(c.low.bUR,c.far.bUR,c.high.bUR,false); var gUR=new Triplane(c.low.gUR,c.far.gUR,c.high.gUR,true);
	var bDL=new Triplane(c.low.bDL,c.far.bDL,c.high.bDL,false); var gDL=new Triplane(c.low.gDL,c.far.gDL,c.high.gDL,true);
	var bDR=new Triplane(c.low.bDR,c.far.bDR,c.high.bDR,false); var gDR=new Triplane(c.low.gDR,c.far.gDR,c.high.gDR,true);
	var uL=new Quadrant(bUL,gUL,false,true ); var uR=new Quadrant(bUR,gUR,true,true );
	var dL=new Quadrant(bDL,gDL,false,false); var dR=new Quadrant(bDR,gDR,true,false);
	var r={uL:uL,uR:uR,dL:dL,dR:dR,u:null,r:null,d:null,l:null,g:[],b:[]}; r=new Being(true,true,r,false,"M"); return r }
function copyVertexPlane(p){var ret={ g:p.g,b:p.b,uL:p.uL,uR:p.uR,dL:p.dL,dR:p.dR,
										u:p.u,r:p.r,d:p.d,l:p.l,origin:p.origin }; return ret;} // next 3 only for M self
function flipLowFar(plane,good) {var ret=null; good ? ret=synFlip(plane,0,1,true,false):ret=synFlip(plane,1,0);return ret }
function flipFarHigh(plane,good){var ret=null; good ? ret=synFlip(plane,0,2,true,false):ret=synFlip(plane,2,0);return ret }
function flipLowHigh(plane,good){var ret=null; good ? ret=synFlip(plane,0,3,true,false):ret=synFlip(plane,3,0);return ret }
function synFlip(plane,bad,good,G,O) { var ret = copyVertexPlane(plane); syntacticFlip(ret, bad, good, G, O); return ret; }
function syntacticFlip(plane,bad,good,G,O) { if(bad!=0){plane.b.push(bad)} if(good!=0){plane.g.push(good)}
	function f(q) { var r = { bad: q.bad, good: q.good }; switch(good) { //sievenn√§?
		case 1: r.good= new TripLane(r.good.axial, 	  r.good.proximal,r.good.diagonal,true);break;
		case 2: r.good= new TripLane(r.good.proximal, r.good.diagonal,r.good.axial,   true);break;
		case 3: r.good= new TripLane(r.good.diagonal, r.good.axial,   r.good.proximal,true);break} switch(bad) {
		case 1: r.bad = new TripLane(r.bad.axial, 	  r.bad.proximal, r.bad.diagonal,false);break;
		case 2: r.bad = new TripLane(r.bad.proximal,  r.bad.diagonal, r.bad.axial, 	 false);break;
		case 3: r.bad = new TripLane(r.bad.diagonal,  r.bad.axial, 	  r.bad.proximal,false);break}
		r = new QuadrAnt(r.bad, r.good, q.sign); return r }
	plane.uL=f(plane.uL); plane.uR=f(plane.uR); plane.dL=f(plane.dL); plane.dR=f(plane.dR); }
function TripLane(proximal,axial,diagonal,good) { var low; var far; var high;
	typeof proximal == "undefined" ? this.proximal="...." : this.proximal=proximal;
	typeof axial 	== "undefined" ? this.axial="...." 	  : this.axial=axial;
	typeof diagonal == "undefined" ? this.diagonal="...." : this.diagonal=diagonal; if(good){
		this.low=proximal;this.far=axial;this.high=diagonal; } else { this.low=proximal;this.far=diagonal;this.high=axial; }this.good=good; var sign = proximal.sign+axial.sign+diagonal.sign; this.sign=sign; }
function Triplane(low,far,high,good) { low.sign="Œ±"; far.sign="Œ≤"; high.sign="Œ≥"; var proximal; var axial; var diagonal;
	typeof low == "undefined" ? this.low="...." : this.low=low;  // Triplane object hardcoded for M
	typeof far == "undefined" ? this.far="...." : this.far=far;
	typeof high== "undefined" ? this.high="....": this.high=high;
	if(good){ proximal=low; axial=far; diagonal=high; } else { proximal=low; axial=high; diagonal=far; }
	this.proximal=proximal;this.axial=axial;this.diagonal=diagonal; this.good=good; this.sign=low.sign+far.sign+high.sign;}
function Being(adult,male,plane,other,sign){ plane=scaleAxes(adult,male,plane);
	this.adult=adult; this.male=male; this.other=other; this.sign=sign;	this.vertexPlane=plane;
	male ? this.vertexPlane.origin=hToRgb("#000000") : this.vertexPlane.origin=hToRgb("#ffffff"); }
function cloneSign(s) { var r = { sem:s.sem, syn:{ X:s.syn.X, Y:s.syn.Y }, vis: { X:s.vis.X, Y:s.vis.Y }}; return r; }
function QuadrAnt(b,g,sign){ this.bad=b; this.good=g; this.sign=sign; }
function Quadrant(b,g,X,Y,G,O){ this.bad=b; this.good=g; var sem = null;
	if(typeof G=="undefined") { sem = signQuadrantSemantics(X,Y) } else { sem = signQuadrantSemantics(X,Y,G,O) }
	var sign = { sem:sem, syn:{ X:X, Y:Y }, vis:{ X:X, Y:Y }}; this.sign=sign; }
function swapSubLog(p,G,O) { var r=copyVertexPlane(p); var g = !G;
	r.uR = p.dL; var uR = signQuadrant(r.uR.sign.syn, r.uR.sign.sem, true, true, g, O); r.uR.sign = uR;
	r.dL = p.uR; var dL = signQuadrant(r.dL.sign.syn, r.dL.sign.sem, false,false,g, O); r.dL.sign = dL; return r }
function swapRatAbs(p,G,O) { var r=copyVertexPlane(p); var o = !O;
	r.uL = p.dR; var uL = signQuadrant(r.uL.sign.syn, r.uL.sign.sem, false,true, G, o); r.uL.sign = uL;
	r.uR = p.dL; var uR = signQuadrant(r.uR.sign.syn, r.uR.sign.sem, true, true, G, o); r.uR.sign = uR;
	r.dL = p.uR; var dL = signQuadrant(r.dL.sign.syn, r.dL.sign.sem, false,false,G, o); r.dL.sign = dL;
	r.dR = p.uL; var dR = signQuadrant(r.dR.sign.syn, r.dR.sign.sem, true, false,G, o); r.dR.sign = dR; return r }
function scaleAxes(adult,male,p,other) {
	var l = signAxisSemantics(p.uL.sign.sem, p.dL.sign.sem); var r = signAxisSemantics(p.uR.sign.sem, p.dR.sign.sem);
	var u = signAxisSemantics(p.uL.sign.sem, p.uR.sign.sem); var d = signAxisSemantics(p.dR.sign.sem, p.dL.sign.sem);
	var crucU = blendColors(3,p.uL.bad.proximal, p.uR.bad.proximal)[1];
	var periU = blendColors(3,p.uL.bad.axial,    p.uR.bad.axial)[1];
	var crucD = blendColors(3,p.dL.bad.proximal, p.dR.bad.proximal)[1];
	var periD = blendColors(3,p.dL.bad.axial,    p.dR.bad.axial)[1];
	if(male) {		p.l=createAxis("#222222","#888888", true, l, "l"); p.r=createAxis("#222222","#888888", true, r, "r");
					p.u=createAxis(crucU.h,  periU.h,   true, u, "u"); p.d=createAxis(crucD.h,  periD.h,   true, d, "d")}
	else if(!adult){p.l=createAxis("#dddddd","#aaaaaa", true, l, "l"); p.r=createAxis("#dddddd","#aaaaaa", true, r, "r");
					p.u=createAxis(crucU.h,  periU.h,   true, u, "u"); p.d=createAxis(crucD.h,  periD.h,   true, d, "d")}
	else {			p.l=createAxis("#dddddd","#aaaaaa",false, l, "l"); p.r=createAxis("#dddddd","#aaaaaa",false, r, "r");
					p.u=createAxis(crucU.h,  periU.h,   true, u, "u"); p.d=createAxis(crucD.h,periD.h,true,d,"d")}return p}
function signAxisSemantics(q1,q2){ var r=""; var L=false; var C=false; var O=false; var S=false;
	if( q1=="L" || q2=="L" ) { L=true } if( q1=="C" || q2=="C" ) { C=true }
	if( q1=="O" || q2=="O" ) { O=true } if( q1=="S" || q2=="S" ) { S=true }
	if( L&&C ) { r="N" } else if( L&&O ) { r="T" } else if( O&&S ) { r="R" } else if( S&&C ) { r="F" } return r }
function signQuadrant(syn,sem,visX,visY,G,O) {
	var r = { syn:{ X:syn.X, Y:syn.Y }, vis:{ X:visX, Y:visY }, sem: sem }; return r }
function signQuadrantSemantics(X,Y,G,O){ var r=""; if((typeof G=="undefined")||
			(G && !O)) { if(X && Y){r="L"}else if(X && !Y){r="O"}else if(!X && Y){r="C"}else if(!X && !Y){r="S"}}
	else if(!G && !O)  { if(X && Y){r="S"}else if(X && !Y){r="O"}else if(!X && Y){r="C"}else if(!X && !Y){r="L"}}
	else if(!G &&  O)  { if(X && Y){r="L"}else if(X && !Y){r="C"}else if(!X && Y){r="O"}else if(!X && !Y){r="S"}}
	else if (G &&  O)  { if(X && Y){r="S"}else if(X && !Y){r="C"}else if(!X && Y){r="O"}else if(!X && !Y){r="L"}}return r }

function ensimmaeinenSana() { AL.tree = initExistence(); console.log(AL.tree); initUI(); virginTab()}

/*5{[1}\+!&8pS49h5&J                   X XXX
EE5^~*^!!!_XX46L35ur   XYX XI  XXX ‚òÜ?‚òΩ X H
EBEVrr^\/\-JS4h&vovr    X   XI  X   !  XDQNX
EEQ}r>+*\;^4493ontjj    X   X I X   ‚úù   /T\X
QQHKj;^+;|x&5oTujjj}    X   X  NX   V  XXX|X
J5u53r^^\+/\cjj>>"\;    X   X   E   X   |‚äû|
j52xLJl}|\"}}{".` !^   XXX XXX XXE XWX  XXX
JT5555nr[r?1>[?{+;*/
function initDharma (  ) { var rt =	initOntology(
										initMosaic(
											initOthers(
												initPrimalMoods(
													initSelves(
														initVectorColors()))))); return rt }
function initEssence(dharma) { dharma = initDialectics(initTemperament(dharma)); return dharma }
function initReality( ) { var reality = initEssence(initDharma()); return reality }
function initExistence( ) {	var dualism = { absolute: null, conditioned: null };
	dualism.absolute 	= initReality();
	dualism.conditioned = initTruth(dualism.absolute); return dualism }//¬®^~¬®~ ~ ~~ ~ ~~ ~ ~
//~ ~~~ ~~~ ~~~ ~~~ ~~~ ~~~ ~~~ ~~~ ~~~ ~~~ ~~~ ~~~ ~~~ ~~~ ~~~^~ ~^~~^~^¬®^¬®^~^~ ~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~¬®~¬®~¬®~~~¬®~¬®~¬®~~~¬®~~¬®~~¬®~~~~~~~~
//::      ::::::      ::::::      ::::::      ::::::      ::::::      ::::::      ::::::      ::::::      ::::::      :::::
//.. ... .. ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ...
                     /*¬®¬®¬®¬®¬®¬®¬®¬®¬®¬®¬®¬®¬®¬®¬®¬®¬®¬®¬®¬®¬®¬®¬®¬®¬®\:.:. :.:. : :: :. .. :.:. :.:. : :: :. .. :.:. :.:. : :: :. .. :.:. :.:. :
                    / yuu blockheed !!         /| :: :. .. :.:. :.:. : :: :. .. :.:. :.:. : :: :. .. :.:. :.:. : :: :. .. :
                   /.                         /:|.:. :.:. : :: :' ¬∞ ¬∞.: . .: . .::' " . o o.:.: .:.: : :: :. .. .:.: .:.: :
                  /                          /::| :: :. .. :.:. :.:. : :: :¬∞
                 /                          /:::|
                /                          /::::|
                |-------------------------|:;::;|    "Well, I certainly prefer Morgenthau !!"
                |.::''..................‚óâ.|:;::;|
                |.'.......................|;;::;|    "BICYCLE KIIICK !!!"
                |.........................|;:::;|
                |.........................|::::;|
                |....¬©¬Æ‚àÄ‚Ñ¢Œ©................|:::;;|
                |.........................|::;;;/
                |....5.lbs................|::;;/
                |.........................|:;;/
                |....TO:.EAST.BERLN.....,,|.;/
                |....................,::::|;/
                |_________________________*/
function initNET(t) {
	t.temperament = null;
	//console.log(t);
	return t }
/*asymmetric TA implies S or C, j/p analogic with g/b*/
// j/p orientation tikku-ukot asento suora tai poised, symmetrinen ero tyyliin armeica's army m16 ak47 ero
function initTemperament(dharma) {
	dharma = initCircuitFunctions(dharma);
	var ts = getOnt(dharma,"tmprmnt").content.items;
	var t  = initNET(ts.find(function(e) { return e.label == "NET" }));
	return dharma }
function initCircuitFunctions(dharma) {
	var Fi = new InformationElement(	dharma, 	false,	false,	false,	"Fi"	);
	var Fe = new InformationElement(	dharma, 	false,	false,	true, 	"Fe"	);
	var Ni = new InformationElement(	dharma, 	false,	true, 	false,	"Ni"	);
	var Ne = new InformationElement(	dharma, 	false,	true, 	true, 	"Ne"	);
	var Ri = new InformationElement(	dharma, 	true,	false,	false,	"Ri"	);
	var Re = new InformationElement(	dharma, 	true,	false,	true, 	"Re"	);
	var Ti = new InformationElement(	dharma, 	true,	true,	false,	"Ti"	);
	var Te = new InformationElement(	dharma, 	true,	true, 	true, 	"Te"	);
	var tmprmnt = { functions:{ Fi:Fi, Fe:Fe, Ni:Ni, Ne:Ne, Ri:Ri, Re:Re, Ti:Ti, Te:Te }};
	dharma.neutral = { tmprmnt: tmprmnt };
	//console.log(dharma);
	return dharma }
function InformationElement( d, x, y, z, code ){ var X; var Y; var Z;
	if 		( !x && !y && !z ) 	{	X = -1; 	Y =  0; 	Z = -1 	}
	else if ( !x && !y &&  z ) 	{ 	X = -1; 	Y =  0; 	Z =  1 	}
	else if ( !x &&  y && !z ) 	{ 	X =  0; 	Y =  1; 	Z = -1 	}
	else if ( !x &&  y &&  z ) 	{ 	X =  0; 	Y =  1; 	Z =  1 	}
	else if (  x && !y && !z ) 	{ 	X =  0; 	Y = -1; 	Z = -1 	}
	else if (  x && !y &&  z ) 	{ 	X =  0; 	Y = -1; 	Z =  1 	}
	else if (  x &&  y && !z ) 	{ 	X = -1; 	Y =  0; 	Z = -1 	}
	else if (  x &&  y &&  z ) 	{ 	X = -1; 	Y =  0; 	Z =  1 	}
	var sign = {bin: { x: x, y: y, z: z },car: { X: X, Y: Y, Z: Z }};
	var axes = getAxes(d, sign);
	this.axes = axes; this.sign = sign; this.code = code; }
function getAxes(d, sign) { var rt=[];
	var axes = getOnt(d, "beings").content.items;
}






                                     //         .  .'
// UUU                            //    /.  /
/// UUU                          // //. /// /// /. /
//// UUUU                       //.  /. /.  /.  /. /
///// UUUUi vittu tai uppoa !!!//.  ///. //  //  // /
//var dis={cfg:cfg,rnd:null,per:null,ort:null,sce:null,lit:null,cam:null,unitCam:null,unitObj:null};
//super id stores memory imprints and selects them to be stored
function ProTab(act,txt) { this.act=act; this.txt=txt; this.ui=initStateForUI(); this.state=null }
/*function labelTabSVG( cla,id,x,y,fonSiz,co){ 	var rt = document.createElementNS( svgNS,'text');
	rt.setAttributeNS( null,'class',cla); 			rt.setAttributeNS( null,'id',id);
	rt.setAttributeNS( null,'x',x); 				rt.setAttributeNS( null,'y',y);
	rt.setAttributeNS( null,'font-size',fontSize); 	rt.setAttributeNS( null,'fill',co);return rt}
function initSidebarSVG( ui,t){ var rt = document.createElementNS( svgNS,'rect'); 	rt.setAttribute('fill',ui.sB.sty.d);
	rt.setAttribute( 'x',	  ui.sB.disHrz); 	rt.setAttribute( 'y', 	  ui.sB.disVrt);
	rt.setAttribute( 'width', ui.sB.disWid); 	rt.setAttribute( 'height',ui.sB.disHei);
	var cla="sB-tab";	var id =""; var y=0; var txt=null; var nod=null;
	for(var i=0; i < AL.tabsLen; i++){ 	var tab=document.createElementNS( svgNS,'rect'); id=cla+"_"+i;
		tab.setAttribute( 'class',cla); 	tab.setAttribute( 'id',id);
		y = i * ui.sB.btnHei; 				tab.setAttribute( 'y',y); 	tab.setAttribute( 'x',ui.sB.disVrt);
		tab.setAttribute( 'width',ui.sB.disWid); 						tab.setAttribute( 'height',ui.sB.btnHei);
		if( t.handle==AL.tabs[i] || t.handle==AL.tabs[i].handle){ tab.setAttribute('fill',ui.sty.sel);
			txt=labelTabSVG( cla,id,ui.sB.disHrz,y,ui.sb.sty.fnt,ui.sty.sel);
			node=document.createTextNode( t.txt); 	node.appendChild( txt); rt.appendChild( node)}
		else 													{ tab.setAttribute('fill',ui.sty.d);
			txt=labelTabSVG( cla,id,ui.sB.disHrz,y,ui.sb.sty.fnt,ui.sty.sel);
			node=document.createTextNode( t.txt); 	node.appendChild( txt); rt.appendChild( node)}} ui.sB.SVG = rt}*/


function calcUI(ui,pT,tab){ ui.winWid=window.innerWidth; ui.winHei=window.innerHeight;
	ui=calcFrame( ui ); ui=calcScreens( ui, tab, pT ); return ui}
function calcFrame(ui){		ui.disWid = ui.winWid - ui.sB.disWid - ui.gL.lVX - ui.gL.mVX;
							ui.disHei = ui.winHei - ui.gL.tHY - ui.gL.mHY - ui.gL.bHY;
							ui.disVrt = ui.gL.lVX + ui.gL + mVX; 	ui.disHrz = ui.gL.tHY;
	calcContentOfFrame( ui.act, ui.sB, ui.gL, ui.pT, ui.eX, ui.fT, ui.dB, ui.dG, ui.qU, ui.winWid, ui.winHei ); return ui}
function calcContentOfFrame(act,sB,gL,pT,eX,fT,dB,dG,qU,winWid,winHei) { 
	pT.disWid = gL.scrWid - sB.disWid - (gL.lVX + gL.mVX);	pT.disHei = gL.tHY;	pT.disHrz = gL.lVX;
	eX.disWid = gL.mVX; 	eX.disHei = winWid - gL.tHY; 	eX.disHrz = gL.lVX; eX.disVrt = gL.tHY;
	fT.disWid = winWid - sB.disWid - (gL.lVX + gL.mVX); 	act.dB ? fT.disHei = gL.bHY - dB.disHei : fT.disHei = gL.bHY;
	dB.disWid = winWid - sB.disWid - (gL.lVX + gL.mVX); 	dB.disHrz = gL.lVX; 	dB.disVrt = winWid - dB.disHei;
	dG.disWid = winWid - sB.disWid - (gL.lVX + gL.mVX + gL.mVX); dG.disHrz = gL.lVX + gL.mVX; dG.disVrt = gL.tHY; }
function calcScreens( ui, tab, pT){	ui = calcScreen( "Quad", 	ui.qU, ui, tab, pT);
									ui = calcScreen( "Mosaic", 	ui.mO, ui, tab, pT);
									ui = calcScreen( "Panda", 	ui.pN, ui, tab, pT);
									ui = calcScreen( "Kakara", 	ui.kK, ui, tab, pT);
									ui = calcScreen( "Yozen", 	ui.yO, ui, tab, pT);}
function calcScreen( txt,sC,ui,tab,pT) { sC.txt=txt;
	if(typeof sC.state.ext=='undefined'){ sC.disWid=ui.disWid;sC.disHei=ui.disHei;sC.disHrz=ui.disHrz;sC.disVrt=ui.disVrt}
	else if( sC.state.ext.qU && txt=='Quad')  { tab.state.int.qU=true; 	tab.state.obj.qU=formQuadScreen( sC,ui,tab,pT);
											 	ui.state.ext.qU =true; 	ui.state.obj.qU =tab.state.obj}
	else if( sC.state.ext.mO && txt=='Mosaic'){ tab.state.int.mO=true; 	tab.state.obj.mO=formMosaicScreen( sC,ui,tab,pT);
											 	ui.state.ext.mO =true; 	ui.state.obj.mO =tab.state.obj}
	else if( sC.state.ext.pN && txt=='Panda') { tab.state.int.pN=true; 	tab.state.obj.pN=formPandaScreen( sC,ui,tab,pT);
											 	ui.state.ext.pN =true; 	ui.state.obj.pN =tab.state.obj}
	else if( sC.state.ext.kK && txt=='Kakara'){ tab.state.int.kK=true; 	tab.state.obj.kK=formKakaraScreen( sC,ui,tab,pT);
											 	ui.state.ext.kK =true; 	ui.state.obj.kK =tab.state.obj}
	else if( sC.state.ext.yO && txt=='Yozen') { tab.state.int.yO=true; 	tab.state.obj.yO=formYozenScreen( sC,ui,tab,pT);
											 	ui.state.ext.yO =true; 	ui.state.obj.yO =tab.state.obj}}
function initQuadScreen(){ // eliminate duplicates is on to-do
	var qU={ SVG:null, 		   state:null,	disWid:0, 	disHei:0, 	disHrz:0, 	disVrt:0, cntHrz:0, cntVrt:0,
			 qUqW:0, qUqH:0 };return qU} //math round until end?
function confQuadScreen( qU,ui){ qU.cntHrz =Math.round( qU.disWid / 2); qU.cntVrt =Math.round( qU.disHei / 2);return qU}
function formQuadScreen( qU,ui,tab,pT){ 	var rt =initQuadScreen( qU);  	rt 		=confQuadScreen( rt,ui);  return rt}
//MOSAIC    mO:{ SVG:null,         state:null, 	disWid:0, 	disHei:0, 	disHrz:0, 	disVrt:0, cntHrz:0, cntVrt:0,
//				 xR:0,yR:0,prjSca:5,prjDep:3, 	prjLid:2, 	sty:{ b:"#000022"}, 
//          	idea: { lTW:0, lTH:0, pTW:0, 		 disWid:0, disHei:0, offHrz:0, offVrt:0  }, 
//            result: { lTX:[],lTY:[],pTX:[],pTY:[], disHrz:0, disVrt:0, prjWid:0, lidWid:0, lidHei:0 }},
function confMosaicScreen( mO,ui,xR,yR){ mO.box = { lid:null, floor:null, base:null, ceiling:null, left:null, right:null }
	return mO}
function makeMosaicScreen( rt,ui){ return rt }
function formMosaicScreen( sC,ui,tab,pT) {
	var rt  =formQuadScreen( ui.qU);
	rt 		=confMosaicScreen( rt,ui,AL.resolution,AL.resolution);
	rt 		=makeMosaicScreen( rt,ui);return rt}
/*
function makeMC() {var rt={ disWid:0, 	disHei:0, 	disHrz:0, disVrt:0, cntHrz:0, cntVrt:0, xFrame:0, yFrame:0, XFrame:0, YFrame:0, norWid:0, facWid:0, norHei:0, norWid:0, facHrz:[], norHrz:[], facVrt:[], facHrz:[]}}
*/





//in stUI: int(bool)=tabCfg, obj(null)=scrCfg, ext(null)=dis

function formTab( ui,t){ t.pT = initProTabs(t.handle); 	t.tools = initTabTools( ui,t);	t.state = confTab( ui,t); return t}
function confTab( ui,t){	t = initScrInt( ui,t);		t = initScrObj( ui,t);			t = initScrExt( ui,t)}
function initScr( sB,gL,sQ,pT,eX,fT,dB,dG,qU,sG,mO,pN,kK,yO,DOM,SVG){ var act={
	sB:sB,gL:gL,sQ:sQ,pT:pT,eX:eX, fT:fT,dB:dB,dG:dG,qU:qU,sG:sG, mO:mO,pN:pN,kK:kK,yO:yO, DOM:DOM,SVG:SVG};return act}
function initScrInt( ui,t){ switch(t.handle){
	case "dharma" : t.txt 		= "Dharma";
					t.state.int = initScr( 	true, true, true, true, true,
											false,true, false,true, true,
											false,false,false,false,true, false);break;
	case "mosaic" : t.txt 		= "Mosaic";
					t.state.int = initScr( 	true, true, true, true, true,
											false,true, false,true, false,
											true, true, true, false,false,true );break;
	case "yozen"  : t.txt 		= "Yozen";
					t.state.int = initScr( 	true, true, true, true, true,
											true, true, false,false,false,
											false,false,false,true, false,true );break} return t}
function initScrExt( ui,t){	if( t.state.int.SVG){ t.state.ext.SVG =initScrSVG( ui,t.state.obj.SVG)}
							if( t.state.int.DOM){ t.state.ext.DOM =initScrDOM( ui.t.state.obj.DOM)} return t}
function initScrObj( ui,t){
	t.state.obj = initScr( null,null,null,null,null, null,null,null,null,null, null,null,null,null, null,null);
	if( t.state.int.sB){ t.state.obj.sB=initSidebar( ui,t)} 	if( t.state.int.gL){ t.state.obj.gL=initGridlock( ui,t)}
	if( t.state.int.sQ){ t.state.obj.sQ=initSequencer( ui,t)} 	if( t.state.int.pT){ t.state.obj.pT=initProTabs( ui,t)}
	if( t.state.int.eX){ t.state.obj.eX=initExplorer( ui,t)} 	if( t.state.int.fT){ t.state.obj.fT=initFooter( ui,t)}
	if( t.state.int.dB){ t.state.obj.dB=initDevBar( ui,t)} 		if( t.state.int.dG){ t.state.obj.dG=initDialog( ui,t)}
	if( t.state.int.qU){ t.state.obj.qU=initQuadDisp( ui,t)} 	if( t.state.int.sG){ t.state.obj.sG=initSysGrid( ui,t)}
	if( t.state.int.mO){ t.state.obj.mO=initMosaicDisp( ui,t)} 	if( t.state.int.pN){ t.state.obj.pN=initPandaDisp( ui,t)}
	if( t.state.int.kK){ t.state.obj.kK=initKakaraDisp( ui,t)} 	if( t.state.int.yO){ t.state.obj.yO=initYozenDisp( ui,t)}}
//to do yozen: sequencer hood
function initSidebar( ui,t){ 	if( t.state.int.DOM){ t.state.obj.sB =initSidebarDOM( ui,t)}
								if( t.state.int.SVG){ t.state.obj.sB =initSidebarSVG( ui,t)}}
function initGridlock( ui,t){ 						t.state.obj.gL =copyGridlock( ui.gL)}
function initSequencer( ui,t){ 	if( t.state.int.DOM){ t.state.obj.sQ =initSequencerDOM( ui,t)}
								if( t.state.int.SVG){ t.state.obj.sQ =initSequencerSVG( ui,t)}}
function initExplorer( ui,t){ 	if( t.state.int.DOM){ t.state.obj.eX =initExplorerDOM( ui,t)}
								if( t.state.int.SVG){ t.state.obj.eX =initExplorerSVG( ui,t)}}
function initDevBar( ui,t){ 	if( t.state.int.DOM){ t.state.obj.dB =initDevBarDOM( ui,t)}
								if( t.state.int.SVG){ t.state.obj.dB =initDevBarSVG( ui,t)}}
function initDialog( ui,t){ 	if( t.state.int.DOM){ t.state.obj.dG =initDialogDOM( ui,t)}
								if( t.state.int.SVG){ t.state.obj.dG =initDialogSVG( ui,t)}}
function initQuadDisp( ui,t){ 	if( t.state.int.DOM){ t.state.obj.qU =initQuadDispDOM( ui,t)}
								if( t.state.int.SVG){ t.state.obj.qU =initQuadDispSVG( ui,t)}}
function initSysGrid( ui,t){ 	if( t.state.int.DOM){ t.state.obj.sG =initSysGridDOM( ui,t)}
								if( t.state.int.SVG){ t.state.obj.sG =initSysGridSVG( ui,t)}}
function initMosaicDisp(ui,t){//if( t.state.int.DOM){ t.state.obj.mC =initMosaicDispDOM( ui,t)}
								if( t.state.int.SVG){ t.state.obj.mC =initMosaicDispSVG( ui,t)}}
function initPandaDisp( ui,t){  if( t.state.int.DOM){ t.state.obj.pN =initPandaDispDOM( ui,t)}
								if( t.state.int.SVG){ t.state.obj.pN =initPandaDispSVG( ui,t)}}
function initKakaraDisp(ui,t){  if( t.state.int.DOM){ t.state.obj.kK =initKakaraDispDOM( ui,t)}
								if( t.state.int.SVG){ t.state.obj.kK =initKakaraDispSVG( ui,t)}}
function initYozenDisp( ui,t){//if( t.state.int.DOM){ t.state.obj.yO =initYozenDispDOM( ui,t)}
								if( t.state.int.SVG){ t.state.obj.yO =initYozenDispSVG( ui,t)}}
function sendCloneDOM( DOM,to){ var l=DOM.length; var L=0;
	for(var i=0; i < l; i++){ var d=document.createElement('div');
		d.setAttribute('class','clearBoth'); L=DOM[i].length; if( l==4){ DOM[i].shift()}
		for(var j=0; j < L; j++){ var b=DOM[i][j].cloneNode(true); d.appendChild(b)} to.appendChild(d)}}
function initSidebarDOM( ui,t){ 
	function makeBtn(says,n) {	var rt = document.createElement( "div");			var txt = "barTab_"+n;
								rt.setAttribute( 'class','sB-tab');					rt.setAttribute( 'id',txt);
								if( says==t.txt){ rt.setAttribute( 'class','sB-tab-sel')}
								txt = document.createTextNode( says); 				rt.appendChild( txt);return rt}
	function makeToolsDisp(){ 	var l=t.tools.length; for(var i=0; i < l; i++){ sendCloneDOM( t.tools[i],sB)}}
	var sB =document.createElement( 'div'); 		sB.setAttribute( 'id','sB'); 	var obj=null;
	for(var i=0; i<AL.tabsLen; i++) { obj=makeBtn( AL.tabs[i].txt,i); 				sB.appendChild(obj)}
	makeToolsDisp(); ui.sB.DOM = rt}
function labelTabSVG( cla,id,x,y,fonSiz,co){ 	var rt = document.createElementNS( svgNS,'text');
	rt.setAttributeNS( null,'class',cla); 			rt.setAttributeNS( null,'id',id);
	rt.setAttributeNS( null,'x',x); 				rt.setAttributeNS( null,'y',y);
	rt.setAttributeNS( null,'font-size',fontSize); 	rt.setAttributeNS( null,'fill',co);return rt}
function initSidebarSVG( ui,t){ var rt = document.createElementNS( svgNS,'rect'); 	rt.setAttribute('fill',ui.sB.sty.d);
	rt.setAttribute( 'x',	  ui.sB.disHrz); 	rt.setAttribute( 'y', 	  ui.sB.disVrt);
	rt.setAttribute( 'width', ui.sB.disWid); 	rt.setAttribute( 'height',ui.sB.disHei);
	var cla="sB-tab";	var id =""; var y=0; var txt=null; var nod=null;
	for(var i=0; i < AL.tabsLen; i++){ 	var tab=document.createElementNS( svgNS,'rect'); id=cla+"_"+i;
		tab.setAttribute( 'class',cla); 	tab.setAttribute( 'id',id);
		y = i * ui.sB.btnHei; 				tab.setAttribute( 'y',y); 	tab.setAttribute( 'x',ui.sB.disVrt);
		tab.setAttribute( 'width',ui.sB.disWid); 						tab.setAttribute( 'height',ui.sB.btnHei);
		if( t.handle==AL.tabs[i] || t.handle==AL.tabs[i].handle){ tab.setAttribute('fill',ui.sty.sel);
			txt=labelTabSVG( cla,id,ui.sB.disHrz,y,ui.sb.sty.fnt,ui.sty.sel);
			node=document.createTextNode( t.txt); 	node.appendChild( txt); rt.appendChild( node)}
		else 													{ tab.setAttribute('fill',ui.sty.d);
			txt=labelTabSVG( cla,id,ui.sB.disHrz,y,ui.sb.sty.fnt,ui.sty.sel);
			node=document.createTextNode( t.txt); 	node.appendChild( txt); rt.appendChild( node)}} ui.sB.SVG = rt}
function initSequencerDOM( ui,t){ return null} 	function initSequencerSVG( ui,t){ return null}
function initExplorerDOM( ui,t){ return null} 	function initExplorerSVG( ui,t){ return null}
function initDevBarDOM( ui,t){ return null} 	function initDevBarSVG( ui,t){ return null}
function initDialogDOM( ui,t){ return null} 	function initDialogSVG( ui,t){ return null}
function initQuadDispDOM( ui,t){ return null} 	function initQuadDispSVG( ui,t){ return null}
function initSysGridDOM( ui,t){ return null} 	function initMosaicDispSVG( ui,t){ return null}
function initPandaDispDOM( ui,t){ return null} 	function initPandaDispSVG( ui,t){ return null}
function initKakaraDispDOM( ui,t){ return null} function initKakaraDispSVG( ui,t){ return null}
function initYozenDispSVG( ui,t){ return null}



/*window.onload is the built-in JavaScript event, but as its implementation had subtle quirks across browsers (Firefox, Internet Explorer 6, Internet Explorer 8, and Opera), jQuery provides document.ready, which abstracts those away, and fires as soon as the page's DOM is ready (doesn't wait for images, etc.).

$(document).ready (note that it's not document.ready, which is undefined) is a jQuery function, wrapping and providing consistency to the following events:

document.ondomcontentready / document.ondomcontentloaded - a newish event which fires when the document's DOM is loaded (which may be some time before the images, etc. are loaded); again, slightly different in Internet Explorer and in rest of the world
and window.onload (which is implemented even in old browsers), which fires when the entire page loads (images, styles, etc.)*/
/*
function getScreenState( ui, tab, pT) {}
function calcScreenQuad( ui, tab, pT){

	ui.qU.disWid = ui.disWid; 	ui.qU.disHei = ui.disHei; 	
}
function calcContentOfDisp(dP,winWid,winHei,sB,gL) {
	dP.disWid


	dP.disHrz = gL.lVX + gL.mVX; 		dP.disVrt = gL.tHY;
	dP.disWid = winWid - sB.disWid - (gL.lVX + gL.mVX);  	dP.disHei = winHei - gL.tHY - gL.mHY - gL.bHY;
	dP.uL = }
function calcScreen(ui,pT,tab) { ui = confScreen( ui, pT, tab );
calcContentOfScreen( ui.gL.scrHei,ui.gL.scrWid,ui.gL.scrHrz,ui.gL.scrVrt, ui.qU, ui.sG, ui.mC, ui.pN, ui.kK ); return ui}
function confScreen(ui,pT,tab){ if( tab.ui.act.qU ){ ui = calcQuadDisp( ui, pT, tab )}
								if( tab.ui.act.sG ){ ui = calcSysGrid ( ui, pT, tab )} return ui}
function calcQuadDisp(ui,pT,tab) { ui.qU = confQuadDisp( ui.qU, pT, tab );
	calcContentOfQuadDisp( ui.qU, pT, tab ); return ui}
function confQuadDisp( qU, pT, tab){
	qU.disWid = }

function confSysGrid( sG, pY, tab) { sG.state=initQuadDisp(); sG.state=confQuadDisp()


function calcContentOfScreen(scrWid,scrHei,scrHrz,scrVrt,qU,sQ,mC,pN,kK) {
	qU.disWid = scrWid; 	qU.disHei = scrHei; 	qU.disHrz = scrHrz; 	qU.disVrt = scrVrt;	
	sG.disWid


}
function makeUI( ui ) { }

*/
            /* lopussa on unaarinen munakello, naurava nunja, */
		// GRIDLOCK G R I D L O C K GRIDLOCK G R I D L O C K GRIDLOCK G R I D L O C K GRIDLOCK
	//G R I D L O C K GRIDLOCK G R I D L O C K GRIDLOCK G R I D L O C K GRIDLOCK G R I D L O C K
//GRIDLOCK G R I D L O C K GRIDLOCK G R I D L O C K GRIDLOCK G R I D L OCC K GRIDLOCK G R I D L O C K
function makeGridLock(gL,SVG,DOM) { if(SVG){ gL.SVG=makeGridLockSVG(gL) } if(DOM){ gL.DOM=makeGridLockDOM(gL) }}
function makeGridLockSVG(gL){ gL.SVG=document.createElementNS(svgNS,'rect');var t='gL'; gL.SVG.setAttribute('id',t);
var n = AL.winWid - AL.sidebarWidth;	gL.SVG.setAttribute( 'width', n ); 	gL.SVG.setAttribute( 'height', AL.winHei );
gL.SVG.setAttribute( 'x', 0 ); 			gL.SVG.setAttribute( 'y', 0 );		gL.SVG.setAttribute( 'fill', '#222222' );
var seq = makeSeqSVG(gL); gL.SVG.appendChild(seq); var lsb = makeLsbSVG(gL); gL.SVG.appendChild(lsb);
var btm = makeBtmSVG(gL); gL.SVG.appendChild(btm); var top = makeTopSVG(gL); gL.SVG.appendChild(top)}
/*GRIDLOCK  gL:{ active:undefined, SVG:null, DOM:null, idea:{ lVX:undefined,	mVX:173,tHY:50,	mHY:73,	bHY:73 }, 
 			result:{disWid:0,disHei:0,gapWid:0,gapHei:0,gapHrz:0,gapVrt:0,lVX:0,mVX:0,	tHY:0,	mHY:0,	bHY:0 }},*/
function makeGridLockDOM(gL) { gL.DOM = document.createElement('div'); var t='gL'; gL.DOM.setAttribute( 'id', t );
var n = AL.winWid - AL.sidebarWidth;	gL.DOM.setAttribute( 'width', n ); 	gL.DOM.setAttribute( 'height', AL.winHei );
gL.DOM.setAttribute( 'x', 0 ); 			gL.DOM.setAttribute( 'y', 0 );gL.DOM.setAttribute('background-color','#222222');
var seq = makeSeqDOM(gL); gL.DOM.appendChild(seq); var lsb = makeLsbDOM(gL); gL.DOM.appendChild(lsb);
var btm = makeBtmDOM(gL); gL.DOM.appendChild(btm); var top = makeTopDOM(gL); gL.DOM.appendChild(top)}

 			// vix or didn't have hen ! ESDZII
function calcSysGrid(gL,sG) { measureWindow(); measureSequencer();
sG.idea.disHrz 	= gL.result.mVX;						sG.idea.disVrt 	= gL.result.tHY;
sG.idea.disWid 	= gL.result.disWid - gL.result.mVX;		sG.idea.disHei  = gL.result.disHei - gL.result.tHY;
	sG.idea.fldWid 	= Math.floor(( disWid - (2 * AL.sG.idea.dFrame)) / 9 );
	sG.idea.fldHei 	= Math.floor(( disHei - (2 * AL.sG.idea.dFrame)) / 9 );
	sG.idea.furHei 	= Math.floor ( sG.idea.fldHei / 4 );
sG.result.fldWid= sG.idea.fldWid * 4;	sG.result.fldHei= sG.idea.fldHei * 4;
	sG.result.qdrWid= sG.idea.fldWid - Math.floor((sG.idea.disWid / 2) - (sG.idea.fldWid / 2));
	sG.result.qdrHei= sG.idea.fldHei - Math.floor((sG.idea.disHei / 2) - (sG.idea.fldHei / 2));
	sG.result.ditchH= sG.result.qdrWid + sG.result.fldWid;
	sG.result.ditchV= sG.result.qdrHei + sG.result.fldHei; return sG }
function makeSysGrid(gL,sG,SVG,DOM) { if(SVG){ gL.SVG=makeSysGridSVG(gL,sG) } if(DOM){ gL.DOM=makeGridLockDOM(gL,sG) }}
function cartId(t,R,x,y) { 					(x < (R/2) && y < (R/2)) ? t+="_uL": 	(x ==(R/2) && y < (R/2)) ? t+="_u" :
	(x > (R/2) && y < (R/2)) ? t+="_uR": 	(x < (R/2) && y ==(R/2)) ? t+="_l" : 	(x ==(R/2) && y ==(R/2)) ? t+="_c" :
	(x > (R/2) && y ==(R/2)) ? t+="_r" : 	(x < (R/2) && y > (R/2)) ? t+="_dL": 	(x ==(R/2) && y > (R/2)) ? t+="_d" :
	(x > (R/2) && y > (R/2)) ? t+="_dR": 	t+="_NaId"; return t }


function sysGridFieldSVG(e,n,t,L,x,y, disHrz, disVrt, dFrame, fldHei, fldWid) {
	(x < L && y < L) ? uL(): (x ==L && y < L) ? u() : (x > L && y < L) ? uR():
	(x < L && y ==L) ? l() : (x ==L && y ==L) ? c() : (x > L && y ==L) ? r() :
	(x < L && y > L) ? dL(): (x ==L && y > L) ? d() : (x > L && y > L) ? dR(): console.log("?");

	t="sG-Fld"; e.setAttribute( 'class',t );  				t=cartId(t,9,x,y); t=t+"_"+x+"-"+y; e.setAttribute( 'id',t );
	n = disHrz+dFrame+(x*fldWid); e.setAttribute('x',n); 	n = disVrt+dFrame+(x*fldHei); e.setAttribute('y',n);
	e.setAttribute( 'stroke-width', 2 ); 					e.setAttribute( 'stroke', '#FFFFFF' );

e.setAttribute( 'id',id );}
function makeSysGridSVG(gL,sG){ sG.SVG=document.createElementNS(svgNS,'rect');var t='sG'; sG.SVG.setAttribute('id',t);
sG.SVG.setAttribute( 'width', sG.idea.disWid ); 			sG.SVG.setAttribute( 'height', sG.idea.disHei );
sG.SVG.setAttribute('x', sG.idea.disHrz); 					sG.SVG.setAttribute('y',sG.idea.disVer);
	sG.SVG.setAttribute( 'fill', "#234567" );
var e=document.createElementNS(svgNS,'rect'); t='sG-Cont'; e.setAttribute('id',t);  e.setAttribute( 'fill', "#987654" );
var n = sG.idea.disWid - ( 2 * sG.idea.dFrame ); 			e.setAttribute( 'width',  n );
	n = sG.idea.disHei - ( 2 * sG.idea.dFrame ); 			e.setAttribute( 'height', n );
	n = sG.idea.disVrt + sG.idea.dFrame; 					e.setAttribute( 'x', n );
	n = sG.idea.disHrz + sG.idea.dFrame; 					e.setAttribute( 'y', n );
	e.setAttribute( 'stroke-width', 2 ); 					e.setAttribute( 'stroke', '#FFFFFF' ); sG.SVG.appendChild(e);
for(var y=0;y<9;y++){ for(var x=0;x<9;x++){ e=document.createElementNS(svgNS,'rect');
	sysGridFldSVG(e,n,t,9/2,x,y, sG.idea.disHrz, sG.idea.disVrt, sG.idea.dFrame, sG.idea.fldHei, sG.idea.fldWid );

	e=document.createElementNS(svgNS,'rect');
	t="sGField"; e.setAttribute( 'class', t); 			t=t+"-"+"x"+"y"; e.setAttribute( 'id', t);
	if(y<5)
	n=(y * sG.fldWid) + sG.idea.dFrame + sG.idea.disHrz; 	e.setAttribute( 'x', n );
	n=(x * sG.fldHei) + sG.idea.dFrame + sG.idea.disVrt; 	e.setAttribute( 'y', n );
	e.setAttribute('width',sG.fldWid); 						e.setAttribute('height',sG.fldHei);
	e.setAttribute( 'stroke-width', 2 ); 					e.setAttribute( 'stroke', '#FFFFFF' );

	 }}

	//stroke-width:3;stroke:rgb(0,0,0)" />


}
/*SYSGRID   sG:{idea:{disWid:0,disHei:0,fldWid:0,fldHei:0,furHei:0,disHrz:0,disVrt:0,dFrame:15},active:undefined,
			  result:{qdrWid:0,qdrHei:0,fldWid:0,fldHei:0,furHei:0,ditchH:0,ditchV:0}, 			SVG:null,DOM:null },*/

/*QUADIS qA:{disWid:0,disHei:0,disHrz:0,disVrt:0,uL:null,uR:null,dL:null,dR:null,uLA:false,uRA:false,dLA:false,dRA:false}*/

//function calcQuadDisp(gL,qD) { qD.disWid = Math.floor(gL.result.mVX / 2); qD.disHei = Math.floor(gL.result.)}

// Muistipeli: Separate Ni and Ne. Muistipeli randomises narrative and asks to place in MosDom.
/*MOSAIC    mC:{idea:{disWid:0,disHei:0,disHrz:0,disVrt:0,hrzRes:9,vrtRes:9},					active:undefined,
			  result:{cenHrz:0,cenVrt:0,tilWid:0,tilHei:0}, 									SVG:null },*/
function calcMosaic(mC,disWid,disHei,disHrz,disVrt) { measureWindow(); measureSequencer();
mC.idea.disWid 	= disWid; 	mC.idea.disHei 	= disHei; 	mC.idea.disHrz 	= disHrz; 	mC.idea.disVrt 	= disVrt;
	mC.result.tilWid= Math.floor(( disWid / 2 ) / mC.idea.hrzRes );
	mC.result.tilHei= Math.floor(( disHei / 2 ) / mC.idea.vrtRes );
	mC.result.cenHrz= Math.floor ( disWid / 4 );
	mC.result.cenVrt= Math.floor ( disHei / 4 ); return mC }

                                                                                                          /*√•
                                                                                  .                         √Ö√•      ‚ú∞
                                                                                                        .   √Ö√•       \
                                                                                                         \‚ô´√Ö√•
                                                                                                     
                                                                             MM   MM MMMMMM MMMMMM  MMMM  MM MMMMMM
                                                       ~    ~     ~    ~    ~MMM MMM MM  MM MM     MM  MM MM MM 
                      ~   ~    ~~    ~~    ~~    ~~  ~~  ~~  ~~  ~~  ~~  ~~  MM M MM MM  MM MMMMMM MMMMMM MM MM 
                    ~  ~  ~      ~ ~ ~   ~~~   ~~~   ~~~   ~~~   ~~~  ~~~  ~ MM   MM MM  MM     MM MM  MM MM MM 
   ~ ~  ~ ~  ~ ~     ~~  ~~  ~~     ~~  ~~  ~~    ~~ ~~ ~~   ~~ ~~ ~~   ~~   MM   MM MMMMMM MMMMMM MM  MM MM MMMMM*/
function drawMosaic(code,depth,m,res, disWid,disHei, disOffX,disOffY, widDif,heiDif, tilWid,tilHei, winWid,winHei) { 
	var mosaicClass = 'mosaic';				var mosaicId 	= mosaicClass+"-"+code;
	var scr=document.createElementNS(svgNS,'rect'); 
	scr.setAttribute('fill','#222222'); 	//scr.setAttribute('fill','#3583A7');
	scr.setAttribute('class',mosaicClass); 	scr.setAttribute('id',mosaicId);
	scr.setAttribute('x',disOffX); 			scr.setAttribute('y',disOffY);
	scr.setAttribute('width',disWid); 		scr.setAttribute('height',disHei);
	svg.appendChild(scr);
	var tileClass = mosaicId+"-tile";
	for(var y=0; y<res; y++) { for(var x=0; x<res; x++) { var tileId = tileClass+"_"+x+"-"+y;
		var tilOffX = disOffX + (x * tilWid);	var tilOffY = disOffY + (y * tilHei);
		if((code=='dL'||code=='dR')) { tilOffY += heiDif }
		if((code=='dR')) 			 { tilOffX += widDif }
		var tile=document.createElementNS(svgNS,"rect"); tile.setAttribute('id',tileId);
		tile.setAttribute('class',tileClass);		
		tile.setAttribute('x',tilOffX); 		tile.setAttribute('y',tilOffY);
		tile.setAttribute('width',tilWid); 		tile.setAttribute('height',tilHei);
		tile.setAttribute('fill',m[y][x].h); 	svg.appendChild(tile); }}
	document.body.appendChild(svg); }
function showMosaic(code,depth,dp,winWid,winHei) { 
	console.log(AL);
	drawMosaic(code, depth, AL.tree.ab.mosaic.plane, dp.dim.resX, dp.dim.disWid, dp.dim.disHei, dp.dim.dpOffX, dp.dim.dpOffY, dp.dim.widDif, dp.dim.heiDif, dp.dim.tilWid, dp.dim.tilHei, winWid, winHei ) }
function showMosaicDisplays(winWid,winHei,tab){
	if(tab.features.mono) { showMosaic("mono",false,tab.display.mono,winWid,winHei) }
	else 				  { showMosaic("uL",false,tab.display.uL,winWid,winHei);
							showMosaic("dL",true, tab.display.dL,winWid,winHei);
							showMosaic("dR",true, tab.display.dR,winWid,winHei); }
							showMosaicHUD(tab) }
function showMosaicHUD(tab) { 	var loc = getCamLocationHUD(tab);
								var textNode = document.createTextNode(loc);
								var hud = document.createElementNS(svgNS,'rect');
								hud.setAttribute('fill',tab.display.hud.hudCol);
								hud.setAttribute('x',tab.display.hud.xOff);
								hud.setAttribute('y',tab.display.hud.yOff);
								hud.setAttribute('width',tab.display.hud.hudWid);
								hud.setAttribute('height',tab.display.hud.hudHei);
								var txt = document.createElementNS(svgNS,"text");
								txt.setAttributeNS(null,'x',tab.display.hud.xOff);
								txt.setAttributeNS(null,'y',(tab.display.hud.yOff * (2*AL.sidebarTabPadT)));
								txt.setAttributeNS(null,'font-size',AL.fontSize);
								txt.setAttributeNS(null,'fill',tab.display.hud.txtCol);
								txt.appendChild(textNode);
								svg.appendChild(hud);
								svg.appendChild(txt); }

								/*var xOff = winWid - AL.sidebarWidth;				var yOff = (AL.tabs.length * AL.sidebarTabHei) + AL.sidebarTabPadT;
	var hudWid = AL.sidebarWidth;						var hudHei = AL.fontSize;
	var hud = document.createElementNS(svgNS,'rect'); 	hud.setAttribute('fill','#3583A7');
	hud.setAttribute('x',xOff); 						hud.setAttribute('y',yOff);
	hud.setAttribute('width',hudWid); 					hud.setAttribute('height',hudHei);
	var locCam = document.createElementNS(svgNS,"text");
	locCam.setAttributeNS(null,"x",xOff);				locCam.setAttributeNS(null,"y",yOff + (2*AL.sidebarTabPadT));
	locCam.setAttributeNS(null,"font-size",AL.fontSize);locCam.setAttributeNS(null,"fill","white");
	var rt = { back: hud, front: locCam }; return rt }*/
function situateDisplay(mosDim, mosPos, code) { 
	if(code=="dL"||code=="dR") { mosDim.dpOffY += mosDim.disHei; 	mosPos.y.off += mosDim.heiDif; }
	if(code=="uR"||code=="dR") { mosDim.dpOffX += mosDim.disWid; 	mosPos.x.off += mosDim.widDif; }
	else if(code=="mono") { mosPos.x.off = Math.floor(mosDim.widDif / 2); mosPos.y.off = Math.floor(mosDim.heiDif / 2); }
	var rt = { code:code, dim: mosDim, pos: mosPos }; return rt; }
function measureMosaic(code, winWid, winHei, x, y) { 
	var rt = { disWid:0, disHei:0, tilWid:0, tilHei:0, widDif:0, heiDif:0, dpOffX:0, dpOffY:0, resX:x, resY:y };
	if(code!="mono"){ rt.disWid = Math.floor( winWid / 2 ); 	rt.disHei = Math.floor( winHei / 2 ); }
	else 			{ rt.disWid = winWid; 						rt.disHei = winHei; }
	rt.tilWid = Math.floor( rt.disWid / x); 	rt.tilHei = Math.floor( rt.disHei / y);
	rt.widDif = rt.disWid - (rt.tilWid * x); 	rt.heiDif = rt.disHei - (rt.tilHei * y); return rt }
function configureMosaic(code, winWid, winHei, x, y) {
	var x = 2*((x*2)+1); if(typeof y=="undefined"){ var y=x }
	var winWid = winWid-AL.sidebarWidth;
	var mosPos = { x:{ res:x, crd:0, off:0, zoo:1}, y:{ res:y, crd:0, off:0, zoo:1}};
	var mosDim = measureMosaic(code, winWid, winHei, x, y);
	var disPos = situateDisplay(mosDim, mosPos, code); return disPos }
function MosaicDisplay(code, winWid, winHei, x, y){ 
	if(typeof y != "undefined") { var disPos = configureMosaic(code, winWid, winHei, x, y) }
	else 						{ var disPos = configureMosaic(code, winWid, winHei, x) }
	this.pos=disPos.pos; this.dim=disPos.dim; this.code=code; }
function initMosaicDisplays(winWid,winHei,R,unitDist) {
	var rt={ mono:null,uL:null,uR:null,dL:null,dR:null,d3d:null,hud:null }
	var mono= new MosaicDisplay("mono", winWid, winHei, R);	var uL = new MosaicDisplay("uL", winWid, winHei, R); 
	var dL 	= new MosaicDisplay("dL", winWid, winHei, R); 	var dR = new MosaicDisplay("dR", winWid, winHei, R);
	var d3d = initDisplays3D("uR", winWid, winHei); 		var uR = d3d;
	var hud = initHUD3D(winWid, winHei, unitDist);
	rt.mono=mono; rt.uL=uL; rt.uR=uR; rt.dL=dL; rt.dR=dR; rt.d3d=d3d; rt.hud=hud; return rt }
function resizeMosaicDisplays(winWid,winHei,R) {
	resizeMosaicDisplay(AL.mosaicDisplays.mono, winWid, winHei, R) }
function resizeMosaicDisplay(mosaic, winWid, winHei, R) { var cfg=configureMosaic(mosaic.code, winWid, winHei, R);
	mosaic.pos = cfg.pos; mosaic.dim = cfg.dim; }
function sketchMosaic(q,dest,Y,X) {
	function mosaicTileLabel(x,y) {	var xCrd = "" + x; var yCrd = "" + y;
		if(xCrd.length==1) { xCrd = "&nbsp;"+xCrd } if(yCrd.length==1) { yCrd = yCrd+"&nbsp;" } var r=xCrd+yCrd; return r }
	if(typeof X=="undefined") { var X = Y; } var c; var doc = document.getElementById(dest); var r=""; var t=""; var tmp;
	for(var y=0;y<Y;y++) { t="<div>"; r+=t;
		for(var x=0;x<X;x++) {
			if(Y==1) { tmp=mosaicTileLabel(x,y);
				r+="<span style='background-color:"+q[y].h+";'>"+tmp+"</span>"; }
			else if(q[y][x]==null){r+="<span>::::</span>"}
			else if(typeof q[y][x]=="string"){r+="<span>"+q[y][x]+"</span>"}
			else { tmp=mosaicTileLabel(x,y);
				r+="<span style='background-color:"+q[y][x].h+";'>"+tmp+"</span>";}}}
	r+="</div>"; doc.innerHTML +=r; }

//
// YOZEN STUFF
//
/*function showSVGSidebar(winWid, winHei, tab) {
	var tabs = AL.tabs.length;
	var barWid = AL.sidebarWidth;
	var offset = winWid - barWid;
	var tabHei = AL.sidebarTabHei;
	var tabOff = offset + AL.sidebarTabPadL;
	var barTabClass = "barTab";
	var fontSize = AL.fontSize;
	svg.setAttribute('height',winHei); 	svg.setAttribute('width',winWid);
	var bar=document.createElementNS(svgNS,'rect');
	bar.setAttribute('x',offset); 		bar.setAttribute('y',0);
	bar.setAttribute('width',barWid); 	bar.setAttribute('height',winHei);
	bar.setAttribute('fill','#95B3D7');	svg.appendChild(bar);
	for(var i=0; i<tabs; i++) { 
    	var barTabId=barTabClass+"_"+i;	
    	var barTab=document.createElementNS(svgNS,'rect');  
    	barTab.setAttribute('class', barTabClass);	barTab.setAttribute('id', barTabId);
    	barTab.setAttribute('x',offset); 			barTab.setAttribute('y',i*tabHei);
    	barTab.setAttribute('width',barWid);		barTab.setAttribute('height',tabHei);
    	AL.tab.handle==AL.tabs[i].handle?barTab.setAttribute('fill','#DDB300'):barTab.setAttribute('fill','#95B300');
    	var label = document.createElementNS(svgNS,"text");
    	label.setAttributeNS(null,'class',barTabClass); label.setAttributeNS(null,'id',barTabId);
		label.setAttributeNS(null,"x",tabOff);			label.setAttributeNS(null,"y",(i*tabHei)+fontSize+9); 
		label.setAttributeNS(null,"font-size",fontSize);label.setAttributeNS(null,"fill","white");
		var textNode = document.createTextNode(AL.tabs[i].label);
		label.appendChild(textNode);
		svg.appendChild(barTab); svg.appendChild(label);  }}*/
		
function Message(from,to,content,context) { this.from=from; this.to=to; this.content=content; this.context=context }
function initYozen() {
	function makeTestMessage() { var r = new Message(null,null,"Yozen",null); return r }
	function pageMessage(msg) {
		var e=document.createElementNS(svgNS,'rect'); e.setAttribute('width',AL.posDim);e.setAttribute('height',AL.posDim);
		var t=document.createElementNS(svgNS,'text'); var T=document.createTextNode(msg.content);
		t.appendChild(T); e.appendChild(t); return e }
	var cnt = pageMessage(makeTestMessage());
	var page = { content:cnt, index:[] };
	return page }
function showYozen() { }

/*GG GGGG G    G   G GGGG GGG  GGGG GGGG        #####################                               #
G    G  G G    GG GG G    G  G G    G           #                    #                              #
G GG G  G G    G G G GGG  G  G GGG  GGG         #                    #  ###########   # #####   #####  ###
G  G G  G G    G   G G    G  G G    G           #####################              #  ##     # #    # #  #
GGGG GGGG GGGG G   G GGGG GGG  GGGG GGGG        #                       ############  #      # #   ## #  #
 											    #                      #           #  #      # #  # # # ##
GGGG G   G G G   G  GG  G  GGG G  G G  G  GGG   #                       ########### # #      #  ##  #  # #
G  G GG GG G GG  G G  G G G    G  G G  G G
G  G G G G G G G G GGGG G  GG  G  G G  G  GG    * kielitoimiston pit√§isi suositella
G  G G   G G G  GG G  G G    G G  G G  G    G 	vrt. "dhalikko" -> "talikko" l√§nnest√§ 1500-luvulla tullut perversio,
GGGG G   G G G   G G  G G GGG   GG   GG  G*/ 	// T. DUKE NUMEK

function gearUp3D(cfg){var dis={cfg:cfg,as:0,rn:null,pr:null,rt:null,sc:null,lt:null,cm:null,unitCam:null,unitObj:null};
	dis.as = cfg.disWid / cfg.disHei;
	dis.rn = new THREE.WebGLRenderer();
	dis.pr = new THREE.PerspectiveCamera( 45, dis.as);
	dis.rt = new THREE.OrthographicCamera();
	dis.sc = new THREE.Scene();
	dis.sc.add( dis.pr );
	dis.sc.add( dis.rt );
	dis.lt = new THREE.AmbientLight( 0xffffff );
	dis.sc.add( dis.lt );
	//positionCameras( cfg, dis.per, dis.ort, dis.sce );
	dis.rn.setSize( cfg.disWid, cfg.disHei );
	dis.rn.setClearColor( 0xff0000, 1 );
	dis.rn.domElement.style.position = "fixed";
	dis.rn.domElement.style.top  = cfg.dpOffY + "px";
	dis.rn.domElement.style.left = cfg.dpOffX + "px";
	dis.rn.domElement.setAttribute('id','d3d');
	dis.cm = dis.pr;
	return dis }
/*function positionCameras(cfg,per,ort,sce) {
	per.rotation._x = cfg.pos._x; 	per.rotation._y = cfg.pos._y; 	per.rotation._z = cfg.pos._z;
	ort.rotation._x = cfg.pos._x; 	ort.rotation._y = cfg.pos._y; 	ort.rotation._z = cfg.pos._z;
	per.position.x = cfg.pos.x; 	per.position.y = cfg.pos.y;		per.position.z = cfg.pos.z;
	ort.position.x = cfg.pos.x; 	ort.position.y = cfg.pos.y;		ort.position.z = cfg.pos.z}*/
// renderer.setPixelRatio( window.devicePixelRatio ); ???
function measureDisplay3D(code, winWid, winHei, unitDist) { 
	var rt = { code:code, disWid:0, disHei:0, dpOffX:0, dpOffY:0, unitDist:unitDist };
	if(code!="mono"){ rt.disWid = Math.floor( winWid / 2 ); 	rt.disHei = Math.floor( winHei / 2 ); }
	else 			{ rt.disWid = winWid; 						rt.disHei = winHei; } return rt }
function situateDisplay3D(d) {  if(d.code=="dL"||d.code=="dR") { d.dpOffY += d.disHei }
								if(d.code=="uR"||d.code=="dR") { d.dpOffX += d.disWid } return d }
function configureDisplay3D(code, winWid, winHei, unitDist) { var winWid = winWid-AL.sidebarWidth;
	var d3d = situateDisplay3D(measureDisplay3D( code, winWid, winHei, unitDist )); return d3d }
function Display3D(code, winWid, winHei) { 	var d3d = gearUp3D(configureDisplay3D(code, winWid, winHei, AL.unitDistD3d ));
	this.cfg=d3d.cfg; this.rnd=d3d.rnd; this.per=d3d.per; this.ort=d3d.ort; this.sce=d3d.sce; this.lit=d3d.lit
	this.cam=d3d.cam; }
function initDisplays3D(code,winWid,winHei) {	var rt = new Display3D( code, winWid, winHei );
												mosaicToWires( rt, AL.ab.mosaic.plane );
												return rt }
function initHUD3D(winWid, winHei, unitDist) {
	var xOff = winWid - AL.sidebarWidth;				var yOff = (AL.tabs.length * AL.sidebarTabHei) + AL.sidebarTabPadT;
	var hudWid = AL.sidebarWidth;						var hudHei = AL.fontSize;
	var hudCol = "#3583A7";								var txtCol = "white";
	var yOffTxt = yOff + (2*AL.sidebarTabPadT);
	var rt={ xOff:xOff, yOff:yOff, hudWid:hudWid, hudHei:hudHei, hudCol:hudCol, txtCol:txtCol, yOffTxt:yOffTxt };return rt}
function mosaicToWires( display, mosaic ) { var buf;
	for(var y = 0; y < AL.resolution; y++) {
		for(var x = 0; x < AL.resolution; x++) {
			buf = tileToWire( mosaic[y][x] ); mosaic[y][x].wire = buf }}}
function tileToWire(tile) {
	var wire = { mat: null, geo: null };
	var mat = new THREE.LineBasicMaterial( { color: tile.h } );
	wire.mat = mat;
	return wire }
function generateTest3D(d3d) {
	var material = new THREE.MeshLambertMaterial({
    	color: 0x0033cc, transparent: true, opacity: 0.236, side: THREE.DoubleSide, depthWrite: false, depthTest: false });
	var box = new THREE.Mesh( new THREE.BoxBufferGeometry( 10, 10, 10 ), material);  
	box.position.x = 0; box.position.y = 0; box.position.z = -50;
	return box }
function show3D(d3d) {
	var tmp = generateTest3D(d3d);
	d3d.sce.add( tmp );
	render3D(d3d);
	document.body.appendChild(d3d.rnd.domElement) }
function getControlDir() { 
	var rt = { hor: 0, ver: 0 };
	if(AL.uArr) { rt.ver =  1 } else if(AL.dArr) { rt.ver = -1 }
	if(AL.lArr) { rt.hor = -1 } else if(AL.rArr) { rt.hor =  1 } return rt }
function navigate3D(shift, alt, ctrl, dp) { var cmd = getControlDir();
	alt ? rotateCam3D(shift,ctrl,dp,dp.cam,cmd,AL.defaultRotD3d) : moveCam3D(shift,ctrl,dp,dp.cam,cmd,AL.defaultVelD3d) }
function rotateCam3D(opt, ctrl, d3d, cam, cmd, r) { if(ctrl) { r = degreesToRadians(90) }
	function rotateCamHrz3D(hor) { var axis = new THREE.Vector3( 0, 1, 0);
		if(hor < 0) { cam.rotateOnAxis(axis, r) } else { cam.rotateOnAxis(axis, -r)}}
	function rotateCamVrt3D(ver) {
		if(!opt) { 	var axis = new THREE.Vector3( 1, 0, 0 );
			if(ver < 0) { cam.rotateOnAxis( axis,-r )} else { cam.rotateOnAxis( axis,r )}}}
	var camDir = new THREE.Vector3( 0, 0,-1 );
	camDir.applyQuaternion( cam.quaternion );
	if(cmd.hor != 0) { rotateCamHrz3D(cmd.hor) } 
	if(cmd.ver != 0) { rotateCamVrt3D(cmd.ver) }
	render3D(d3d) }
function moveCam3D(opt, ctrl, d3d, cam, cmd, vel) { var r = degreesToRadians(90); //if control vel*=res
	function moveCamHrz3D(hor){ var axis = new THREE.Vector3( 0, 1, 0 );
		if(hor < 0) { camDir.applyAxisAngle( axis,r )} else { camDir.applyAxisAngle( axis, -r) }}
	function moveCamVrt3D(ver){
		if(!opt){ if(ver < 0) { vel = -vel }}
		else 	{ /*if(ver > 0) { vel = -vel }
			var axis = new THREE.Vector3( 1, 0, -1 );
			axis.applyQuaternion( cam.quaternion );
			camDir.cross(axis); }*/}}
	var camDir = new THREE.Vector3( 0, 0,-1 );
	camDir.applyQuaternion( cam.quaternion );
	if(cmd.hor != 0) { moveCamHrz3D(cmd.hor) } 
	if(cmd.ver != 0) { moveCamVrt3D(cmd.ver) }
	camDir.multiplyScalar(vel);
	cam.position.add(camDir);
	render3D(d3d) }
function getCamLocationHUD(tab) {
	function adjustCrd(str){if(str.length>3){ x="O/F" }
							else 			{switch(str.length){ case 1: str = "_"+str+"_"; break;
 																 case 2: str = "_"+str;		break}} return str }
	var x = tab.display.d3d.cam.position.x; x = Math.floor(x / AL.unitDistD3d); x = x.toString(); x = adjustCrd(x);
	var y = tab.display.d3d.cam.position.y; y = Math.floor(y / AL.unitDistD3d); y = y.toString(); y = adjustCrd(y);
	var z = tab.display.d3d.cam.position.z; z = Math.floor(z / AL.unitDistD3d); z = z.toString(); z = adjustCrd(z);
	var rt = x+y+z; return rt }




function moveCam3D3(opt,d3d,obj,cmd,vel){
	function moveCamHrz3D() { }
	function moveCamVrt3D() {}
	

	var quaternion = new THREE.Quaternion();
	if(cmd.hor < 0) 	{ quaternion.setFromAxisAngle( new THREE.Vector3(-1, 0, 0), Math.PI / 2 )}
	else if(cmd.hor > 0){ quaternion.setFromAxisAngle( new THREE.Vector3( 1, 0, 0), Math.PI / 2 )}

	quaternion.setFromAxisAngle( new THREE.Vector3( 0, 1, 0 ), Math.PI / 2 );

var vector = new THREE.Vector3( 1, 0, 0 );
vector.applyQuaternion( quaternion );


	
	var dir = new THREE.Vector3( obj.rotation._x, obj.rotation._y, obj.rotation._z );
	//console.log(dir);
	//console.log(obj);
	if 		(cmd.hor < 0) { 			dir.x -= r }else if(cmd.hor > 0){ dir.x += r }
	if 		(cmd.ver < 0) { if(!opt){ 	dir.z += r }else 				{ dir.y -= r }}
	else if (cmd.ver > 0) { if(!opt){ 	dir.z -= r }else 				{ dir.y += r }}
	dir.multiplyScalar(vel);
	obj.position.x += dir.x;
	obj.position.y += dir.y;
	obj.position.z += dir.z;
	render3D(d3d) }
function move3D2(opt, d3d, obj, cmd, vel) {
	var r = degreesToRadians(90);
	var dir = new THREE.Vector3( obj.rotation.x, obj.rotation.y, obj.rotation.z );
	if 		(cmd.hor < 0) { dir.applyAxisAngle(d3d.z, -r) } else if(cmd.hor > 0) { dir.applyAxisAngle(d3d.z, r) }
	if 		(cmd.ver < 0) { if(!opt) { dir.applyAxisAngle(d3d.x, -r) }else{ dir.applyAxisAngle(d3d.y, -r) }}
	else if (cmd.ver > 0) { if(!opt) { dir.applyAxisAngle(d3d.x,  r) }else{ dir.applyAxisAngle(d3d.y,  r) }}
	dir.multiplyScalar(vel);
	obj.position.x += dir.x;
	obj.position.y += dir.y;
	obj.position.z += dir.z}
function render3D(d3d) { 	d3d.rnd.clear();
							d3d.rnd.render( d3d.sce, d3d.cam );
							showMosaicHUD(AL.tab) }
function degreesToRadians(degrees) { var pi = Math.PI; return degrees * (pi/180); }
/*
	console.log(dir);
	if(cmd.hor < 0) 	{ obj.position.add -= vel } else if(cmd.hor > 0) { obj.position.x += vel }
	if(cmd.ver < 0) 	{ if(opt) { obj.position.y -= vel } else { obj.position.z += vel }}
	else if(cmd.ver > 0){ if(opt) { obj.position.y += vel } else { obj.position.z -= vel }}
	d3d.rnd.clear();
	d3d.rnd.render( d3d.sce, d3d.cam ); }*/

       /*
DDDDDD ' OOOOO  OO     OO           (                         Œ©
DD  DDD OO¬∞ ¬∞OO OOO   OOO    +‚Üí    (   m mm mm        x.xx.    Œ©
DD   DD OO   OO OOOO OOOO  +++++‚Üí  (    m  m  m   M√ó   x. x.   Œ©
DD   DD OOo oOO OO O O OO  +++++‚Üí  (    m  m  m   M√ó   x. x.   Œ©
DD  DDD OOOOOOO OO OOO OO    +‚Üí    (    m  m  m        x. x.   Œ©
DDDDDD   OOOOO  OO  O  OO           (  mm  m  mm      xx. xx. œâ

*/function devBar(text) { var d = document.getElementById('devBar');
	if(typeof text == 'undefined') { d.innerHTML = "Press F1 For No Help ‚Üß‚Ü•" } else { d.innerHTML = text }}
function populateDharmaTypeSelector(s) { var j = AL.ab.ontology.length; for(var i = 0; i < j; i++) {
	var option=document.createElement('option'); option.text=AL.ab.ontology[i].label; s.add(option) }}
function populateDharmaSubtypeSelector(s) {	var j = AL.ontology.content.categories.length; for(var i = 0; i < j; i++) {
	var option=document.createElement('option'); option.text=AL.ontology.content.categories[i].handle; s.add(option) }}
function populateDharmaSidebarSource(s) { var dhArr = AL.ontology.content.items; for(var i = 0; i < dhArr.length; i++) {
	var option = document.createElement('option');
	dhArr[i].hypot ? option.class="dharmaSourceSelected" : option.class="dharmaSource";
	option.id = "dharmaSource_"+i;		option.text = "."+dhArr[i].sign;		s.add(option); } }
function populateDharmaSidebarRelations(s) {}
function populateDharmaSidebarTarget(s) { var dhArr = AL.ontology.content.items; for(var i = 0; i < dhArr.length; i++) {
	var option = document.createElement('option');
	dhArr[i].lemma ? option.class="dharmaTargetSelected" : option.class="dharmaTarget";
	option.class = "dharmaTarget";		option.id = "dharmaTarget_"+i;
	option.text = "."+dhArr[i].sign;
	s.add(option); } }
function populateDharmaSubrelSelector(s) { /*console.log(AL.epistemology);
	var j = AL.epistemology.content.categories.length; for(var i = 0; i < j; i++) {
	var option=document.createElement('option');option.text=AL.epistemology.content.categories[i].handle; s.add(option) }*/}
function populateDharmaRelSelector(s) {	/*var j = AL.dharma.epistemology.length; for(var i = 0; i < j; i++) {
		var option=document.createElement('option'); option.text=AL.dharma.epistemology[i].label; s.add(option) }*/}
function initDharmaDisplay(hnd){ 	 var content = document.createElement('div');
		var header   = initDharmaHeaderControls(hnd); 	content.appendChild(header);
		var sidebar  = initDharmaSidebar(hnd); 			content.appendChild(sidebar);
		var sysGrid  = initSysGrid(hnd);				content.appendChild(sysGrid.DOM); return content }
function initDharmaHeaderControls(hnd) { if((hnd=='dharma')||(hnd=='kakara')) {
	var d = document.createElement('div');	 d.setAttribute('id','dharmaHeaderControls');
	var e = document.createElement('div'); 	 e.setAttribute('id','dharmaHeaderBase');  					  d.appendChild(e);
	var e = document.createElement('div'); 	 e.setAttribute('id','dharmaHeaderTabs');  					  d.appendChild(e);
	var e=document.createElement('button');	 e.setAttribute('id','removeDharmaProfile');
	e.innerHTML="-"; d.appendChild(e);
	var e = document.createElement('input'); e.setAttribute('id','nameDharmaProfile');
		e.setAttribute('size',7);			 d.appendChild(e);
	var e=document.createElement('button');  e.setAttribute('id','createDharmaProfile');
	e.innerHTML="+"; d.appendChild(e); }	 return d }
function initDharmaSidebar(hnd) {
var d = document.createElement('div'); 	 				d.setAttribute('id','dharmaSidebar');
if(hnd=='dharma') {
	var typeSelector = document.createElement('select');	typeSelector.setAttribute('id','dharmaTypeSelector');
	var subtypeSelector = document.createElement('select');	subtypeSelector.setAttribute('id','dharmaSubtypeSelector');
	subtypeSelector.setAttribute('multiple',true);			

	var tooltips = initDharmaHood('dharmaSidebarHood');

	var relSelector = document.createElement('select'); 	relSelector.setAttribute('id','dharmaRelSelector');
	var subrelSelector = document.createElement('select');  subrelSelector.setAttribute('id','dharmaSubrelSelector');
	subrelSelector.setAttribute('multiple',true);

	var footerCover = document.createElement('div'); 		footerCover.setAttribute('id','dharmaFooterCover');

	var source = document.createElement('select');			var relation = document.createElement('select');
	var target = document.createElement('select'); 
	var selHei=Math.floor((AL.winHei-249)/(AL.fontSize+4));
	source.setAttribute('id','dharmaSource');				source.setAttribute('multiple',true);
	source.setAttribute('size',selHei);
	relation.setAttribute('id','dharmaRelation');			relation.setAttribute('multiple',true);
	relation.setAttribute('size',selHei);
	target.setAttribute('id','dharmaTarget');				target.setAttribute('multiple',true);
	target.setAttribute('size',selHei);

	var frm = document.createElement('div');				frm.setAttribute('id','dharmaFrom');
	var lockFrm = document.createElement('input'); 			lockFrm.setAttribute("type", "checkbox");
	var via = document.createElement('div'); 				via.setAttribute('id','dharmaVia');
	var lockVia = document.createElement('input'); 			lockVia.setAttribute("type", "checkbox");
	var to = document.createElement('div'); 				to.setAttribute('id','dharmaTo');
	var lockTo = document.createElement('input'); 			lockTo.setAttribute("type", "checkbox");
	frm.appendChild(lockFrm); 	via.appendChild(lockVia); 	to.appendChild(lockTo);

	var controls = document.createElement('div'); 			controls.setAttribute('id','dharmaControls');
	var btn1 = document.createElement('button'); 			btn1.setAttribute('id','allConstsToUp');
	btn1.innerHTML="<span class='dharmaControlButtonLabel'>‚§í|‚§í</span>"; 
	var btn2 = document.createElement('button'); 			btn2.setAttribute('id','selConstsToUp');
	btn2.innerHTML="<span class='dharmaControlButtonLabel'>‚Ü•|‚Ü•</span>"; 
	var btn3 = document.createElement('button'); 			btn3.setAttribute('id','relsToLeft');
	btn3.innerHTML="<span class='dharmaControlButtonLabel'>‚§ü</span>";
	var btn4 = document.createElement('button'); 			btn4.setAttribute('id','relsToRight');
	btn4.innerHTML="<span class='dharmaControlButtonLabel'>‚§†</span>";
	var btn5 = document.createElement('button'); 			btn5.setAttribute('id','selRelsToDown');
	btn5.innerHTML="<span class='dharmaControlButtonLabel'>‚Üß</span>";
	var btn6 = document.createElement('button'); 			btn6.setAttribute('id','allRelsToDown');
	btn6.innerHTML="<span class='dharmaControlButtonLabel'>‚§ì</span>"; //‚Üß‚Ü• 
	controls.appendChild(btn1); controls.appendChild(btn2); controls.appendChild(btn3);
	controls.appendChild(btn4); controls.appendChild(btn5); controls.appendChild(btn6); }

var parser = document.createElement('div'); 			parser.setAttribute('id','dharmaParser');

var devBar = document.createElement('div'); 			devBar.setAttribute('id','devBar');

var displayLock = document.createElement('div'); 		displayLock.setAttribute('id','dharmaDisplayLock');
var lockUpper = document.createElement('div'); 			lockUpper.setAttribute('id','dharmaUpperLock');
var verTime = document.createElement('div'); 			verTime.setAttribute('id','dharmaVerticalTime');
lockUpper.appendChild(verTime);
var lockLower = document.createElement('div'); 			lockLower.setAttribute('id','dharmaLowerLock');
var horTime = document.createElement('div'); 			horTime.setAttribute('id','dharmaHorizontalTime');
lockLower.appendChild(horTime); // append these to columns, not here like this
displayLock.appendChild(lockUpper); 					displayLock.appendChild(lockLower);

d.appendChild(devBar);
d.appendChild(typeSelector);d.appendChild(subtypeSelector);
d.appendChild(tooltips);
d.appendChild(footerCover);
d.appendChild(source);  	d.appendChild(relation);	d.appendChild(target);
d.appendChild(frm); 		d.appendChild(via); 		d.appendChild(to);
d.appendChild(controls);
d.appendChild(relSelector);d.appendChild(subrelSelector);
d.appendChild(parser);
d.appendChild(displayLock);
return d }
function initDharmaHood(id) {
	var d = document.createElement('div'); 				d.setAttribute('id',id);
	var hoodPaint = document.createElement('div'); 			hoodPaint.setAttribute('id','dharmaSidebarHoodPaint');
		hoodPaint.innerHTML = "HOOD&nbsp;HOOD&nbsp;HOOD&nbsp;HO";
	var tooltips = document.createElement('div');			tooltips.setAttribute('class','dharmaSidebarHood');
	var sourceTooltip = document.createElement('div');		sourceTooltip.setAttribute('class','dharmaConstantTooltip');
		sourceTooltip.innerHTML = "FROM";
	var relationTooltip = document.createElement('div');	relationTooltip.setAttribute('class','dharmaRelationTooltip');
		relationTooltip.innerHTML = "relation";
	var targetTooltip = document.createElement('div');		targetTooltip.setAttribute('class','dharmaConstantTooltip');
		targetTooltip.innerHTML = "TO";
	tooltips.appendChild(sourceTooltip); tooltips.appendChild(relationTooltip);	tooltips.appendChild(targetTooltip);
	d.appendChild(hoodPaint);							d.appendChild(tooltips);
	return d }
function openHood(id,clas) { if	(id=='dharmaSidebarTooltips') { showTaxonomyTools(clas) }
						else if (id=='dharmaEngine') { 			var hood = closeHood('dharmaSidebar', clas);
																baTang('dharmaSidebar',hood) }}
function showTaxonomyTools(id,clas)  {
	var tooltips = document.createElement('div');				tooltips.setAttribute('id','dharmaSidebarTaxonomy');
	var ont = document.createElement('input');					ont.setAttribute('id','dharmaOntologySelector');
		ont.setAttribute("type", "radio"); 						var ontTip = createTextNode('ont');
	var epi = document.createElement('input');					epi.setAttribute('id','dharmaEpistemologySelector');
		epi.setAttribute("type", "radio");						var epiTip = createTextNode('epi');
	var mor = document.createElement('input');					mor.setAttribute('id','dharmaMoralitySelector');
		mor.setAttribute("type", "radio");						var morTip = createTextNode('mor');
	var qua = document.createElement('input');					qua.setAttribute('id','dharmaEthicsSelector');
		qua.setAttribute("type", "radio");						var quaTip = createTextNode('qua');
	tooltips.appendChild(ont); 	tooltips.appendChild(ontTip);	tooltips.appendChild(epi); 	tooltips.appendChild(epiTip);
	tooltips.appendChild(mor); 	tooltips.appendChild(morTip);	tooltips.appendChild(qua); 	tooltips.appendChild(quaTip);
	document.getElementsByClassName(clas)[0].remove();
	tooltips.setAttribute('class',clas); 	
	document.getElementById('dharmaSidebar').appendChild(tooltips); }
function closeHood(id,clas) {
	var sidebarHood = document.createElement('div'); 
	var hoodPaint = document.createElement('div');			hoodPaint.setAttribute('id','dharmaSidebarHoodPaint');
	hoodPaint.innerHTML = "HOOD&nbsp;HOOD&nbsp;HOOD&nbsp;HO";
	var tooltips = document.createElement('div');			tooltips.setAttribute('class','dharmaSidebarHood');
	var sourceTooltip = document.createElement('div');		sourceTooltip.setAttribute('class','dharmaConstantTooltip');
	sourceTooltip.innerHTML = "FROM";
	var relationTooltip = document.createElement('div');	relationTooltip.setAttribute('class','dharmaRelationTooltip');
	relationTooltip.innerHTML = "relation";
	var targetTooltip = document.createElement('div');		targetTooltip.setAttribute('class','dharmaConstantTooltip');
	targetTooltip.innerHTML = "TO";

	tooltips.appendChild(sourceTooltip);
	tooltips.appendChild(relationTooltip);
	tooltips.appendChild(targetTooltip);
	tooltips.appendChild(hoodPaint);
	return tooltips }
function baTang(d,el) { if(typeof d == "string") { var d = document.getElementById(d) }	d.appendChild(el) }


//
// dont remember this
//

/*
function initDharmaColumns() {
	var d = document.createElement('div'); 	 d.setAttribute('id','dharmaColumns');
	var e = document.createElement('div'); 	 e.setAttribute('id','oneDharmaColumn'); 
	e.setAttribute('class','dharmaColumn');  

	var f = document.createElement('div'); 	 f.setAttribute('id','leftDharmaColumn'); 
	f.setAttribute('class','innerDharmaColumn');  e.appendChild(f);
	var f = document.createElement('div'); 	 f.setAttribute('id','rightDharmaColumn'); 
	f.setAttribute('class','innerDharmaColumn');  e.appendChild(f);

	d.appendChild(e);
	return d }*/

// /*window.onload=init();*/ 
/*script>
$(document).ready(function(){
  $("#myInput").on("keyup", function() {
    var value = $(this).val().toLowerCase();
    $("#myTable tr").filter(function() {
      $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
    });
  });
});
/script>*/


// Press F2 For More Help
// onhover: (mystery key: shift) 	// reverses dir in dharmasrcdst ctrls 
// click on da hood !!

// rect.setAttribute('fill','#95B3D7'); 

/*
#dharmaColumnWrapper{width:100%;min-height:100%;background-color:#181818; position:absolute;top:25px;
		margin-left:173px; padding:66px; }
	.dharmaColumn{ margin-right:25px; border:1px solid black; float:left;  width:25%; padding: 66px;}
	#leftDharmaColumn{}
	#rightDharmaColumn{}
	.innerDharmaColumn{background-color:white; } ei toiminu	



var d = document.createElement('div'); 	 d.setAttribute('id','dharmaColumns');
	var e = document.createElement('div'); 	 e.setAttribute('id','oneDharmaColumn'); 
	e.setAttribute('class','dharmaColumn');  

	var f = document.createElement('div'); 	 f.setAttribute('id','leftDharmaColumn'); 
	f.setAttribute('class','innerDharmaColumn');  e.appendChild(f);
	var f = document.createElement('div'); 	 f.setAttribute('id','rightDharmaColumn'); 
	f.setAttribute('class','innerDharmaColumn');  e.appendChild(f);
	
	d.appendChild(e);
	return d }*/
	function parseTriplaneSign(g, s) {
	var rt=parseArithmetic(interpretTriplaneSign(g,s));
	return rt;
		}
function parseArithmetic(s) { }
function interpretTriplaneSign(g, s) { var Q = ""; var R = "";
		 if( g && s=="Œ±Œ≤Œ≥" ) { Q = "X+Y"; R = "X-Y"; }
	else if( g && s=="Œ±Œ≥Œ≤" ) { Q = "X+Y"; R = "X-Y"; }
	else if( g && s=="Œ≤Œ±Œ≥" ) { Q = "X+Y"; R = "X-Y"; }
	else if( g && s=="Œ±Œ≥Œ≤" ) { Q = "X+Y"; R = "X-Y"; }
	else if( g && s=="Œ≤Œ±Œ≥" ) { Q = "X+Y"; R = "X-Y"; }
	else if( g && s=="Œ≤Œ≥Œ±" ) { Q = "X+Y"; R = "X-Y"; }
	else if( g && s=="Œ≥Œ±Œ≤" ) { Q = "X+Y"; R = "X-Y"; }
	else if( g && s=="Œ≥Œ≤Œ±" ) { Q = "X+Y"; R = "X-Y";  console.log("√ºber")}
	else if(!g && s=="Œ±Œ≤Œ≥" ) { Q = "X+Y"; R = "X-Y"; }
	else if(!g && s=="Œ±Œ≥Œ≤" ) { Q = "X+Y"; R = "X-Y"; }
	else if(!g && s=="Œ≤Œ±Œ≥" ) { Q = "X+Y"; R = "X-Y"; }
	else if(!g && s=="Œ±Œ≥Œ≤" ) { Q = "X+Y"; R = "X-Y"; }
	else if(!g && s=="Œ≤Œ±Œ≥" ) { Q = "X+Y"; R = "X-Y"; }
	else if(!g && s=="Œ≤Œ≥Œ±" ) { Q = "X+Y"; R = "X-Y"; }
	else if(!g && s=="Œ≥Œ±Œ≤" ) { Q = "X+Y"; R = "X-Y"; }
	else if(!g && s=="Œ≥Œ≤Œ±" ) { Q = "X+Y"; R = "X-Y"; }
	console.log(s);
	return { Q:Q, R:R }}
function quantifyAs(bng) {
	var g = parseTriplaneSign(true, bng.vertexPlane.uR.good.sign);
	//var b = parseTriplaneSign(false,bng.vertexPlane.uR.bad.sign );
	console.log(g);
	//console.log(b);
}
// PROCESS
//function parseTriplaneSign(t,g) { }
function quantTile(X,Y,R,d,q,t) { var x = Math.abs(Y); var y = Math.abs(Y); return t.sign; }

function quantifyLocationValue(l) { var ret;
	var x = Math.abs(l.X);
	var y = Math.abs(l.Y);
	if(x >= y) { ret = y;
		if(!l.sex) { ret = 5 - x; }}
	else { ret = x - y; }	
	return ret; }

// ENGINEwhile (condition)  statement
function moveToTile(id) { }
function startTime(time) { if(AL.time==0) {	typeof time=="undefined" ? AL.time = AL.defaultTime : AL.time = time;
	/*while(AL.time!=0) { }*/}}
function initQuantification(dharmas) { var q = quantifyAs(beings.fem.others.adult);
	return beings; } //sociotypes also quantify //initSpace(mosaic,AL.resolution,dharmas); 


//
// dont remembert this
//
	//.divrow { width:100%; }	.rowblock { float:left; }


function showLegendDisplay() { 
	measureWindow();
	var wid = AL.winWid - AL.sidebarWidth;
	var v = AL.dharma;
	var r = "<div id='container' style='width:"+wid+"px;'>\
		<div id='monolithicBoilerPlate'><h1>Pesu Cone<br /><br />Press F1 For Help<br />or <br /><a target='_blank' href='http://al.moq.fi/Circuit Script.pdf'>Read Specs<br /><br />Everyone wants to read <a target='_blank' href='http://al.moq.fi/Pesu Cone.pdf'>End User Licence Agreement (EULA)</a></h1></div>";
	var buf;
	buf = testBeing( v.mas.selves.adult ); r += buf;
	buf = testBeing( v.mas.selves.child ); r += buf;
	buf = testBeing( v.fem.selves.child ); r += buf;
	buf = testBeing( v.fem.selves.adult ); r += buf;
	buf = testBeing( v.mas.others.adult ); r += buf;
	buf = testBeing( v.mas.others.child ); r += buf;
	buf = testBeing( v.fem.others.child ); r += buf;
	buf = testBeing( v.fem.others.adult ); r += buf;
	r += "</div>";
	return r }
function testBeing(dhr) {
	var buf;
	var r="<div style='width:100%'>";
	buf=testBeing2( dhr.male, dhr.adult, dhr.other, -3,	dhr.moods.hostile.vertexPlane, 	 ); r += (buf);
	buf=testBeing2( dhr.male, dhr.adult, dhr.other, -1,	dhr.moods.enemy.vertexPlane, 	 ); r += (buf);
	buf=testBeing2( dhr.male, dhr.adult, dhr.other, -2,	dhr.moods.runaway.vertexPlane,   ); r += (buf);
	buf=testBeing2( dhr.male, dhr.adult, dhr.other,  3,	dhr.moods.peaceful.vertexPlane,  ); r += (buf);
	buf=testBeing2( dhr.male, dhr.adult, dhr.other,  1,	dhr.moods.playful.vertexPlane,	 ); r += (buf);
	buf=testBeing2( dhr.male, dhr.adult, dhr.other,  2,	dhr.moods.escorting.vertexPlane, ); r += (buf);
	r += "</div>";
	return r }
function testBeing2(male,adult,other,mood,p,input) {
	var r = "<div style='float:left;'>";
		function makeLabel() { var z="<span style='background-color:black;color:white;'>";
		if(mood==6) { z+=input; }
		else {
			mood== -3?z+="Hostile ":mood== 3?z+="Peaceful ":
			mood== -1?z+="Enemy "  :mood== 1?z+="Playful ":
			mood== -2?z+="Runaway ":mood== 2?z+="Escorting ":z+="Plain ";
			if(other){z+="Other "} adult?male?z+="Man":z+="Woman":male?z+="Boy":z+="Girl"; }
		z+="</span>"; return z;	}
	function d(p) { var label=makeLabel();
		function w(v,zj) { var zi=l(v); var str=""+zj.proximal.sign+zj.axial.sign+zj.diagonal.sign;
			var z = "<span style='background-color:"+v+";color:"+zi+";'><span style='position:absolute;font-size:10px;margin-left:1px;'>"+str+"</span>&nbsp;&nbsp;&nbsp;</span>"; h+=z;}
		function u(v) { var zi=l(v); var adu=n(); var oth=q();
			var z = "<span style='background-color:"+v+";color:"+zi+";'>"+adu+" "+oth+"</span>"; h+=z; }
		function s(v) { var zi=l(v); var zj=Math.abs(mood); var z = "<span style='background-color:"+v+";color:"+zi+";'>";
			mood<0?z+="-":z+="&nbsp;";
			zj<3?z+=zj:z+="<span style='position:absolute;margin-left:-2px;margin-top:-1px;'>&#8734;</span>&nbsp;";
			z+="&nbsp;</span>"; h+=z; }
		function q() { var z; other?z="o":z="s"; return z; }
		function o() { var z="<span style='position:absolute;margin-left:-4px;margin-top:-2px;'>";
			male?z+="&#x2642;":z+="&#x2640;"; z+="</span>&nbsp;"; return z; }
		function n() { var z; adult?z="a":z="c"; return z; }
		function m(v) { var zi=l(v); var gen=o();
			var z = "<span style='background-color:"+v+";color:"+zi+";'>&nbsp;"+gen+"&nbsp;</span>"; h+=z; }
		function l(v) {var z=hToRgb(v);var zi=(255*3)/2;var zj=z.r+z.g+z.b;if(zj<zi){z="#ffffff"}else{z="#000000"}return z;}
		function k(v) { var zi=l(v); var z = "<span style='background-color:"+v+";color:"+zi+";'>B:"+p.b+"</span>"; h+=z; }
		function j(v) { var zi=l(v); var z = "<span style='background-color:"+v+";color:"+zi+";'>G:"+p.g+"</span>"; h+=z; }
		function i(v,a) { if(typeof v=="undefined"){h+="....";}else{if(typeof a=="undefined"){h+=",,,,";}else{ var zi=l(v);
			var z = "<span style='background-color:"+v+";color:"+zi+";'>&nbsp;"+a.sign.sem+"&nbsp;</span>"; h+=z; }}}
		function g(v,q) { if(typeof v=="undefined"){h+="....";}else{ var zi=l(v); var signs="";
			q.sign.syn.X ? signs+="+" : signs+="-"; signs+=q.sign.sem; q.sign.syn.Y ? signs+="+" : signs+="-";
			var z = "<span style='background-color:"+v+";color:"+zi+";'>"+signs+"</span>"; h+=z; }}
		function f(v) { if(typeof v == "undefined") { h+="...."; } else {
			var z = "<span style='background-color:"+v+";'>&nbsp;&nbsp;&nbsp;</span>"; h+=z; }}
		h += "<br />&nbsp;&nbsp;&nbsp;"; h+= label; h+="<br />&nbsp;&nbsp;&nbsp;";
		g(p.uL.good.diagonal.h,p.uL);		w(p.uL.bad.diagonal.h,p.uL.bad);	f(p.uL.bad.axial.h);
		i(p.u.peripheral.h,p.u);
		f(p.uR.bad.axial.h); 				w(p.uR.bad.diagonal.h,p.uR.bad);	g(p.uR.good.diagonal.h,p.uR);
		h+="<br />&nbsp;&nbsp;&nbsp;";
		w(p.uL.good.axial.h,p.uL.good);		f(p.uL.good.proximal.h);			f(p.uL.bad.proximal.h);
		s(p.u.crucial.h);
		f(p.uR.bad.proximal.h);				f(p.uR.good.proximal.h);			w(p.uR.good.axial.h,p.uR.good);
		h+="<br />&nbsp;&nbsp;&nbsp;";
		i(p.l.peripheral.h,p.l);			f(p.l.crucial.h); 					f(p.origin.h);/*j*/
		m(p.origin.h);
		f(p.origin.h);/*k*/					f(p.r.crucial.h); 					i(p.r.peripheral.h,p.r);
		h+="<br />&nbsp;&nbsp;&nbsp;";
		w(p.dL.good.axial.h,p.dL.good);		f(p.dL.good.proximal.h);			f(p.dL.bad.proximal.h);
		u(p.d.crucial.h);
		f(p.dR.bad.proximal.h);				f(p.dR.good.proximal.h);			w(p.dR.good.axial.h,p.dR.good);
		h+="<br />&nbsp;&nbsp;&nbsp;";
		g(p.dL.good.diagonal.h,p.dL);		w(p.dL.bad.diagonal.h,p.dL.bad);	f(p.dL.bad.axial.h);
		i(p.d.peripheral.h,p.d);
		f(p.dR.bad.axial.h); 				w(p.dR.bad.diagonal.h,p.dR.bad);	g(p.dR.good.diagonal.h,p.dR);
		h+="</div>"; }
	d(p);
	h+="</div>";
	r = h;
	return r }
precalc();
</script></head><body onload='predraw( AL)'></body></html>
